import{d as R,a as M,_ as O,D as j}from"./index-DzK2S43K.js";import{_ as z}from"./index.vue_vue_type_script_setup_true_lang-Cvlg2yMl.js";import{_ as B}from"./DictTag.vue_vue_type_script_lang-D8_eTNf5.js";import{d as P}from"./formatTime-BGPGB_ys.js";import{L as h,_ as Q,g as D,d as F}from"./CustomerLimitConfigForm.vue_vue_type_script_setup_true_lang-myPY7EBP.js";import{f as G,ak as Y,_ as q,Z as J}from"./form-designer-DHHJWkD5.js";import{l as Z,r as d,j as H,e as K,ag as V,m as W,q as p,I as X,J as t,C as g,B as n,G as _,A as u,u as l,E as $}from"./form-create-_84fGzaM.js";const ee=Z({name:"CustomerLimitConfigList",__name:"CustomerLimitConfigList",props:{confType:{}},setup(T){const k=R(),{t:v}=M(),y=d(!0),w=d(0),b=d([]),s=H({pageNo:1,pageSize:10,type:T.confType}),m=async()=>{y.value=!0;try{const o=await D(s);b.value=o.list,w.value=o.total}finally{y.value=!1}},I=d(),N=(o,e)=>{I.value.open(o,T.confType,e)},L=()=>{s.pageNo=1,m()};return K(()=>{m()}),(o,e)=>{const S=O,f=G,i=q,x=B,E=J,U=z,C=V("hasPermi"),A=Y;return p(),W(X,null,[t(f,{plain:"",onClick:L},{default:n(()=>[t(S,{icon:"ep:refresh",class:"mr-5px"}),e[3]||(e[3]=_(" \u5237\u65B0 "))]),_:1}),g((p(),u(f,{type:"primary",plain:"",onClick:e[0]||(e[0]=a=>N("create"))},{default:n(()=>[t(S,{icon:"ep:plus",class:"mr-5px"}),e[4]||(e[4]=_(" \u65B0\u589E "))]),_:1})),[[C,["crm:customer-limit-config:create"]]]),g((p(),u(E,{data:l(b),stripe:!0,"show-overflow-tooltip":!0,class:"mt-4"},{default:n(()=>[t(i,{label:"\u7F16\u53F7",align:"center",prop:"id"}),t(i,{label:"\u89C4\u5219\u9002\u7528\u4EBA\u7FA4",align:"center",formatter:a=>{var r;return(r=a.users)==null?void 0:r.map(c=>c.nickname).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:"\u89C4\u5219\u9002\u7528\u90E8\u95E8",align:"center",formatter:a=>{var r;return(r=a.depts)==null?void 0:r.map(c=>c.name).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:o.confType===l(h).CUSTOMER_QUANTITY_LIMIT?"\u62E5\u6709\u5BA2\u6237\u6570\u4E0A\u9650":"\u9501\u5B9A\u5BA2\u6237\u6570\u4E0A\u9650",align:"center",prop:"maxCount"},null,8,["label"]),o.confType===l(h).CUSTOMER_QUANTITY_LIMIT?(p(),u(i,{key:0,label:"\u6210\u4EA4\u5BA2\u6237\u662F\u5426\u5360\u7528\u62E5\u6709\u5BA2\u6237\u6570",align:"center",prop:"dealCountEnabled","min-width":"100"},{default:n(a=>[t(x,{type:l(j).INFRA_BOOLEAN_STRING,value:a.row.dealCountEnabled},null,8,["type","value"])]),_:1})):$("",!0),t(i,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:l(P),width:"180px"},null,8,["formatter"]),t(i,{label:"\u64CD\u4F5C",align:"center","min-width":"110",fixed:"right"},{default:n(a=>[g((p(),u(f,{link:"",type:"primary",onClick:r=>N("update",a.row.id)},{default:n(()=>e[5]||(e[5]=[_(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:update"]]]),g((p(),u(f,{link:"",type:"danger",onClick:r=>(async c=>{try{await k.delConfirm(),await F(c),k.success(v("common.delSuccess")),await m()}catch{}})(a.row.id)},{default:n(()=>e[6]||(e[6]=[_(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[A,l(y)]]),t(U,{total:l(w),page:l(s).pageNo,"onUpdate:page":e[1]||(e[1]=a=>l(s).pageNo=a),limit:l(s).pageSize,"onUpdate:limit":e[2]||(e[2]=a=>l(s).pageSize=a),onPagination:m},null,8,["total","page","limit"]),t(Q,{ref_key:"formRef",ref:I,onSuccess:m},null,512)],64)}}});export{ee as _};
