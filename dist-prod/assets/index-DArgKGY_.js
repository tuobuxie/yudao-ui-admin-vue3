import{d as ee,a as le,h as R,D as v,I as ae,_ as te}from"./index-D_TWD7wt.js";import{_ as oe}from"./index.vue_vue_type_script_setup_true_lang-ZV0RCuCp.js";import{_ as se}from"./DictTag.vue_vue_type_script_lang-BD_Qe0UA.js";import{_ as pe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-4_WNC8um.js";import{_ as re}from"./index-CBtRt3JL.js";import{l as ne,r as i,j as de,e as ie,ag as ue,m as k,q as p,J as e,B as o,u as t,I as x,$ as N,A as n,Z as j,C as f,G as m,x as me,H as ce}from"./form-create-_84fGzaM.js";import{d as fe}from"./formatTime-BGPGB_ys.js";import{a as _e,d as ye,b as we,e as ve}from"./index-JSktQgAx.js";import{e as he}from"./index-GJ9EVQ8_.js";import{d as be}from"./download-oWiM5xVU.js";import{_ as ge}from"./SmsTemplateForm.vue_vue_type_script_setup_true_lang-XCSCrVoU.js";import{_ as Se}from"./SmsTemplateSendForm.vue_vue_type_script_setup_true_lang-CZVFJhrB.js";import{h as Te,aj as ke,x as xe,Q as Ce,k as Ve,F as Me,f as Ee,Z as Ie,_ as Ae,ak as Ne}from"./form-designer-DHHJWkD5.js";import"./Dialog.vue_vue_type_style_index_0_lang-CJT4CHEp.js";import"./constants-C3gLHYOK.js";const Pe=ne({name:"SystemSmsTemplate",__name:"index",setup(Ue){const h=ee(),{t:P}=le(),C=i(!1),U=i(0),Y=i([]),O=i(),s=de({pageNo:1,pageSize:10,type:void 0,status:void 0,code:"",content:"",apiTemplateId:"",channelId:void 0,createTime:[]}),V=i(!1),M=i([]),_=async()=>{C.value=!0;try{const d=await _e(s);Y.value=d.list,U.value=d.total}finally{C.value=!1}},S=()=>{s.pageNo=1,_()},q=()=>{O.value.resetFields(),S()},D=i(),H=(d,a)=>{D.value.open(d,a)},F=i(),T=i([]),J=d=>{T.value=d.map(a=>a.id)},K=async()=>{try{await h.delConfirm(),await we(T.value),T.value=[],h.success(P("common.delSuccess")),await _()}catch{}},Z=async()=>{try{await h.exportConfirm(),V.value=!0;const d=await ve(s);be.excel(d,"\u77ED\u4FE1\u6A21\u677F.xls")}catch{}finally{V.value=!1}};return ie(async()=>{await _(),M.value=await he()}),(d,a)=>{const $=re,E=Ce,I=xe,c=ke,L=Ve,B=Me,b=te,u=Ee,G=Te,z=pe,r=Ae,A=se,Q=Ie,W=oe,y=ue("hasPermi"),X=Ne;return p(),k(x,null,[e($,{title:"\u77ED\u4FE1\u914D\u7F6E",url:"https://doc.iocoder.cn/sms/"}),e(z,null,{default:o(()=>[e(G,{class:"-mb-15px",model:t(s),ref_key:"queryFormRef",ref:O,inline:!0,"label-width":"150px"},{default:o(()=>[e(c,{label:"\u77ED\u4FE1\u7C7B\u578B",prop:"type"},{default:o(()=>[e(I,{modelValue:t(s).type,"onUpdate:modelValue":a[0]||(a[0]=l=>t(s).type=l),placeholder:"\u8BF7\u9009\u62E9\u77ED\u4FE1\u7C7B\u578B",clearable:"",class:"!w-240px"},{default:o(()=>[(p(!0),k(x,null,N(t(R)(t(v).SYSTEM_SMS_TEMPLATE_TYPE),l=>(p(),n(E,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"\u5F00\u542F\u72B6\u6001",prop:"status"},{default:o(()=>[e(I,{modelValue:t(s).status,"onUpdate:modelValue":a[1]||(a[1]=l=>t(s).status=l),placeholder:"\u8BF7\u9009\u62E9\u5F00\u542F\u72B6\u6001",clearable:"",class:"!w-240px"},{default:o(()=>[(p(!0),k(x,null,N(t(R)(t(v).COMMON_STATUS),l=>(p(),n(E,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"\u6A21\u677F\u7F16\u7801",prop:"code"},{default:o(()=>[e(L,{modelValue:t(s).code,"onUpdate:modelValue":a[2]||(a[2]=l=>t(s).code=l),placeholder:"\u8BF7\u8F93\u5165\u6A21\u677F\u7F16\u7801",clearable:"",onKeyup:j(S,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(c,{label:"\u77ED\u4FE1 API \u7684\u6A21\u677F\u7F16\u53F7",prop:"apiTemplateId"},{default:o(()=>[e(L,{modelValue:t(s).apiTemplateId,"onUpdate:modelValue":a[3]||(a[3]=l=>t(s).apiTemplateId=l),placeholder:"\u8BF7\u8F93\u5165\u77ED\u4FE1 API \u7684\u6A21\u677F\u7F16\u53F7",clearable:"",onKeyup:j(S,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(c,{label:"\u77ED\u4FE1\u6E20\u9053",prop:"channelId"},{default:o(()=>[e(I,{modelValue:t(s).channelId,"onUpdate:modelValue":a[4]||(a[4]=l=>t(s).channelId=l),placeholder:"\u8BF7\u9009\u62E9\u77ED\u4FE1\u6E20\u9053",clearable:"",class:"!w-240px"},{default:o(()=>[(p(!0),k(x,null,N(t(M),l=>(p(),n(E,{key:l.id,value:l.id,label:l.signature+`\u3010 ${t(ae)(t(v).SYSTEM_SMS_CHANNEL_CODE,l.code)}\u3011`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:o(()=>[e(B,{modelValue:t(s).createTime,"onUpdate:modelValue":a[5]||(a[5]=l=>t(s).createTime=l),style:{width:"240px"},type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(c,null,{default:o(()=>[e(u,{onClick:S},{default:o(()=>[e(b,{icon:"ep:search",class:"mr-5px"}),a[9]||(a[9]=m(" \u641C\u7D22"))]),_:1}),e(u,{onClick:q},{default:o(()=>[e(b,{icon:"ep:refresh",class:"mr-5px"}),a[10]||(a[10]=m(" \u91CD\u7F6E"))]),_:1}),f((p(),n(u,{type:"primary",plain:"",onClick:a[6]||(a[6]=l=>H("create"))},{default:o(()=>[e(b,{icon:"ep:plus",class:"mr-5px"}),a[11]||(a[11]=m("\u65B0\u589E "))]),_:1})),[[y,["system:sms-template:create"]]]),f((p(),n(u,{type:"danger",plain:"",disabled:t(T).length===0,onClick:K},{default:o(()=>[e(b,{icon:"ep:delete",class:"mr-5px"}),a[12]||(a[12]=m("\u6279\u91CF\u5220\u9664 "))]),_:1},8,["disabled"])),[[y,["system:sms-template:delete"]]]),f((p(),n(u,{type:"success",plain:"",onClick:Z,loading:t(V)},{default:o(()=>[e(b,{icon:"ep:download",class:"mr-5px"}),a[13]||(a[13]=m(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[y,["system:sms-template:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(z,null,{default:o(()=>[f((p(),n(Q,{data:t(Y),onSelectionChange:J},{default:o(()=>[e(r,{type:"selection",width:"55"}),e(r,{label:"\u6A21\u677F\u7F16\u7801",align:"center",prop:"code",width:"120","show-overflow-tooltip":!0}),e(r,{label:"\u6A21\u677F\u540D\u79F0",align:"center",prop:"name",width:"120","show-overflow-tooltip":!0}),e(r,{label:"\u6A21\u677F\u5185\u5BB9",align:"center",prop:"content",width:"200","show-overflow-tooltip":!0}),e(r,{label:"\u77ED\u4FE1\u7C7B\u578B",align:"center",prop:"type"},{default:o(l=>[e(A,{type:t(v).SYSTEM_SMS_TEMPLATE_TYPE,value:l.row.type},null,8,["type","value"])]),_:1}),e(r,{label:"\u72B6\u6001",align:"center",prop:"status",width:"80"},{default:o(l=>[e(A,{type:t(v).COMMON_STATUS,value:l.row.status},null,8,["type","value"])]),_:1}),e(r,{label:"\u5907\u6CE8",align:"center",prop:"remark"}),e(r,{label:"\u77ED\u4FE1 API \u7684\u6A21\u677F\u7F16\u53F7",align:"center",prop:"apiTemplateId",width:"200","show-overflow-tooltip":!0}),e(r,{label:"\u77ED\u4FE1\u6E20\u9053",align:"center",width:"120"},{default:o(l=>{var g;return[me("div",null,ce((g=t(M).find(w=>w.id===l.row.channelId))==null?void 0:g.signature),1),e(A,{type:t(v).SYSTEM_SMS_CHANNEL_CODE,value:l.row.channelCode},null,8,["type","value"])]}),_:1}),e(r,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",width:"180",formatter:t(fe)},null,8,["formatter"]),e(r,{label:"\u64CD\u4F5C",align:"center",width:"210",fixed:"right"},{default:o(l=>[f((p(),n(u,{link:"",type:"primary",onClick:g=>H("update",l.row.id)},{default:o(()=>a[14]||(a[14]=[m(" \u4FEE\u6539 ")])),_:2},1032,["onClick"])),[[y,["system:sms-template:update"]]]),f((p(),n(u,{link:"",type:"primary",onClick:g=>{return w=l.row.id,void F.value.open(w);var w}},{default:o(()=>a[15]||(a[15]=[m(" \u6D4B\u8BD5 ")])),_:2},1032,["onClick"])),[[y,["system:sms-template:send-sms"]]]),f((p(),n(u,{link:"",type:"danger",onClick:g=>(async w=>{try{await h.delConfirm(),await ye(w),h.success(P("common.delSuccess")),await _()}catch{}})(l.row.id)},{default:o(()=>a[16]||(a[16]=[m(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[y,["system:sms-template:delete"]]])]),_:1})]),_:1},8,["data"])),[[X,t(C)]]),e(W,{total:t(U),page:t(s).pageNo,"onUpdate:page":a[7]||(a[7]=l=>t(s).pageNo=l),limit:t(s).pageSize,"onUpdate:limit":a[8]||(a[8]=l=>t(s).pageSize=l),onPagination:_},null,8,["total","page","limit"])]),_:1}),e(ge,{ref_key:"formRef",ref:D,onSuccess:_},null,512),e(Se,{ref_key:"sendFormRef",ref:F},null,512)],64)}}});export{Pe as default};
