import{d as K,u as T,_ as E,ay as O}from"./index-DmQdxAiK.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-C4PMlRRW.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-OyXbUoED.js";import{_ as X}from"./ContentWrap.vue_vue_type_script_setup_true_lang-OPDE9cVe.js";import{l as Y,r,j as $,ag as ee,A as y,q as v,B as l,J as a,u as s,Z as ae,C as S,G as p,H as le,h as se}from"./form-create-_84fGzaM.js";import{g as te}from"./index-KdlJtvbB.js";import{_ as oe}from"./BusinessForm.vue_vue_type_script_setup_true_lang-BcIEKJXy.js";import{h as re,aj as ne,k as ie,f as ue,ak as pe,Z as me,_ as ce,P as de}from"./form-designer-DHHJWkD5.js";const fe=Y({name:"BusinessListModal",__name:"BusinessListModal",props:{customerId:{}},emits:["success"],setup(V,{expose:R,emit:U}){const z=K(),b=V,n=r(!1),d=r(!0),k=r(0),h=r([]),w=r(),B=r(!1),o=$({pageNo:1,pageSize:10,name:void 0,customerId:b.customerId});R({open:async()=>{n.value=!0,o.customerId=b.customerId,await c()}});const c=async()=>{d.value=!0;try{const i=await te(o);h.value=i.list,k.value=i.total}finally{d.value=!1}},f=()=>{o.pageNo=1,c()},P=()=>{w.value.resetFields(),f()},x=r(),j=U,_=r(),q=async()=>{const i=_.value.getSelectionRows().map(e=>e.id);if(i.length===0)return z.error("\u672A\u9009\u62E9\u5546\u673A");n.value=!1,j("success",i,_.value.getSelectionRows())},{push:F}=T();return(i,e)=>{const J=ie,C=ne,g=E,m=ue,L=re,N=X,u=ce,M=de,Z=me,A=W,D=Q,G=ee("hasPermi"),H=pe;return v(),y(D,{title:"\u5173\u8054\u5546\u673A",modelValue:s(n),"onUpdate:modelValue":e[5]||(e[5]=t=>se(n)?n.value=t:null)},{footer:l(()=>[a(m,{onClick:q,type:"primary",disabled:s(B)},{default:l(()=>e[9]||(e[9]=[p("\u786E \u5B9A")])),_:1},8,["disabled"]),a(m,{onClick:e[4]||(e[4]=t=>n.value=!1)},{default:l(()=>e[10]||(e[10]=[p("\u53D6 \u6D88")])),_:1})]),default:l(()=>[a(N,null,{default:l(()=>[a(L,{class:"-mb-15px",model:s(o),ref_key:"queryFormRef",ref:w,inline:!0,"label-width":"68px"},{default:l(()=>[a(C,{label:"\u5546\u673A\u540D\u79F0",prop:"name"},{default:l(()=>[a(J,{modelValue:s(o).name,"onUpdate:modelValue":e[0]||(e[0]=t=>s(o).name=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u540D\u79F0",clearable:"",onKeyup:ae(f,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(C,null,{default:l(()=>[a(m,{onClick:f},{default:l(()=>[a(g,{icon:"ep:search",class:"mr-5px"}),e[6]||(e[6]=p(" \u641C\u7D22"))]),_:1}),a(m,{onClick:P},{default:l(()=>[a(g,{icon:"ep:refresh",class:"mr-5px"}),e[7]||(e[7]=p(" \u91CD\u7F6E"))]),_:1}),S((v(),y(m,{type:"primary",onClick:e[1]||(e[1]=t=>{x.value.open("create")})},{default:l(()=>[a(g,{icon:"ep:plus",class:"mr-5px"}),e[8]||(e[8]=p(" \u65B0\u589E "))]),_:1})),[[G,["crm:business:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(N,{class:"mt-10px"},{default:l(()=>[S((v(),y(Z,{ref_key:"businessRef",ref:_,data:s(h),stripe:!0,"show-overflow-tooltip":!0},{default:l(()=>[a(u,{type:"selection",width:"55"}),a(u,{label:"\u5546\u673A\u540D\u79F0",fixed:"left",align:"center",prop:"name"},{default:l(t=>[a(M,{type:"primary",underline:!1,onClick:_e=>{return I=t.row.id,void F({name:"CrmBusinessDetail",params:{id:I}});var I}},{default:l(()=>[p(le(t.row.name),1)]),_:2},1032,["onClick"])]),_:1}),a(u,{label:"\u5546\u673A\u91D1\u989D",align:"center",prop:"totalPrice",formatter:s(O)},null,8,["formatter"]),a(u,{label:"\u5BA2\u6237\u540D\u79F0",align:"center",prop:"customerName"}),a(u,{label:"\u5546\u673A\u7EC4",align:"center",prop:"statusTypeName"}),a(u,{label:"\u5546\u673A\u9636\u6BB5",align:"center",prop:"statusName"})]),_:1},8,["data"])),[[H,s(d)]]),a(A,{total:s(k),page:s(o).pageNo,"onUpdate:page":e[2]||(e[2]=t=>s(o).pageNo=t),limit:s(o).pageSize,"onUpdate:limit":e[3]||(e[3]=t=>s(o).pageSize=t),onPagination:c},null,8,["total","page","limit"])]),_:1}),a(oe,{ref_key:"formRef",ref:x,onSuccess:c},null,512)]),_:1},8,["modelValue"])}}});export{fe as _};
