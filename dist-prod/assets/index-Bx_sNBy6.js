import{d as G,a as I,u as J,_ as H,D as L}from"./index-DzK2S43K.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-D3YOFsHs.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-Cvlg2yMl.js";import{_ as X}from"./DictTag.vue_vue_type_script_lang-D8_eTNf5.js";import{_ as Y}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BYZVL11n.js";import{_ as $}from"./index-RnHrue4c.js";import{l as ee,r as m,j as ae,b as le,e as te,aa as oe,ag as re,m as ne,q as i,J as a,B as l,u as t,Z as ie,C as u,G as p,A as d,h as pe,I as se}from"./form-create-_84fGzaM.js";import{d as me}from"./formatTime-BGPGB_ys.js";import{b as ue,d as de,g as ce}from"./index-CYWtznVz.js";import{b as fe}from"./formCreate-BIGK0pmc.js";import{h as _e,aj as ye,k as be,f as ge,Z as ke,_ as Ce,ak as we}from"./form-designer-DHHJWkD5.js";const he=ee({name:"BpmForm",__name:"index",setup(ve){const N=G(),{t:B}=I(),{currentRoute:O,push:T}=J(),g=m(!0),S=m(0),V=m([]),r=ae({pageNo:1,pageSize:10,name:null}),q=m(),c=async()=>{g.value=!0;try{const f=await ue(r);V.value=f.list,S.value=f.total}finally{g.value=!1}},k=()=>{r.pageNo=1,c()},Z=()=>{q.value.resetFields(),k()},C=(f,e)=>{const b={name:"BpmFormEditor",query:{type:f}};typeof e!="number"&&typeof e!="string"||(b.query.id=e),T(b)},y=m(!1),w=m({rule:[],option:{}});return le(()=>O.value,()=>{c()},{immediate:!0}),te(()=>{c()}),(f,e)=>{const b=$,j=be,U=ye,h=H,n=ge,A=_e,F=Y,s=Ce,K=X,M=ke,P=W,R=oe("form-create"),D=Q,_=re("hasPermi"),E=we;return i(),ne(se,null,[a(b,{title:"\u5BA1\u6279\u63A5\u5165\uFF08\u6D41\u7A0B\u8868\u5355\uFF09",url:"https://doc.iocoder.cn/bpm/use-bpm-form/"}),a(F,null,{default:l(()=>[a(A,{ref_key:"queryFormRef",ref:q,inline:!0,model:t(r),class:"-mb-15px","label-width":"68px"},{default:l(()=>[a(U,{label:"\u8868\u5355\u540D",prop:"name"},{default:l(()=>[a(j,{modelValue:t(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>t(r).name=o),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D",onKeyup:ie(k,["enter"])},null,8,["modelValue"])]),_:1}),a(U,null,{default:l(()=>[a(n,{onClick:k},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=p(" \u641C\u7D22 "))]),_:1}),a(n,{onClick:Z},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=p(" \u91CD\u7F6E "))]),_:1}),u((i(),d(n,{plain:"",type:"primary",onClick:C},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=p(" \u65B0\u589E "))]),_:1})),[[_,["bpm:form:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(F,null,{default:l(()=>[u((i(),d(M,{data:t(V)},{default:l(()=>[a(s,{align:"center",label:"\u7F16\u53F7",prop:"id"}),a(s,{align:"center",label:"\u8868\u5355\u540D",prop:"name"}),a(s,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:l(o=>[a(K,{type:t(L).COMMON_STATUS,value:o.row.status},null,8,["type","value"])]),_:1}),a(s,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(s,{formatter:t(me),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},null,8,["formatter"]),a(s,{align:"center",label:"\u64CD\u4F5C"},{default:l(o=>[u((i(),d(n,{link:"",type:"primary",onClick:v=>C("copy",o.row.id)},{default:l(()=>e[7]||(e[7]=[p(" \u590D\u5236 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:update"]]]),u((i(),d(n,{link:"",type:"primary",onClick:v=>C("update",o.row.id)},{default:l(()=>e[8]||(e[8]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:update"]]]),u((i(),d(n,{link:"",onClick:v=>(async x=>{const z=await ce(x);fe(w,z.conf,z.fields),y.value=!0})(o.row.id)},{default:l(()=>e[9]||(e[9]=[p(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:query"]]]),u((i(),d(n,{link:"",type:"danger",onClick:v=>(async x=>{try{await N.delConfirm(),await de(x),N.success(B("common.delSuccess")),await c()}catch{}})(o.row.id)},{default:l(()=>e[10]||(e[10]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:delete"]]])]),_:1})]),_:1},8,["data"])),[[E,t(g)]]),a(P,{limit:t(r).pageSize,"onUpdate:limit":e[1]||(e[1]=o=>t(r).pageSize=o),page:t(r).pageNo,"onUpdate:page":e[2]||(e[2]=o=>t(r).pageNo=o),total:t(S),onPagination:c},null,8,["limit","page","total"])]),_:1}),a(D,{modelValue:t(y),"onUpdate:modelValue":e[3]||(e[3]=o=>pe(y)?y.value=o:null),title:"\u8868\u5355\u8BE6\u60C5",width:"800"},{default:l(()=>[a(R,{option:t(w).option,rule:t(w).rule},null,8,["option","rule"])]),_:1},8,["modelValue"])],64)}}});export{he as default};
