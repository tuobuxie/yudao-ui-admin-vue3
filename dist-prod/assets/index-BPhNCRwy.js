import{d as W,a as X,h as ee,D as S,_ as le}from"./index-DzK2S43K.js";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang-Cvlg2yMl.js";import{_ as te}from"./DictTag.vue_vue_type_script_lang-D8_eTNf5.js";import{_ as oe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BYZVL11n.js";import{_ as se}from"./index-RnHrue4c.js";import{l as re,r as c,j as ne,e as ie,ag as pe,m as z,q as r,J as e,B as o,u as t,Z as A,I as E,$ as ce,A as m,C as f,G as u}from"./form-create-_84fGzaM.js";import{d as me}from"./formatTime-BGPGB_ys.js";import{d as ue}from"./download-oWiM5xVU.js";import{b as de,d as fe,e as ye,f as _e}from"./index-CSB65gGy.js";import{_ as ge}from"./RoleForm.vue_vue_type_script_setup_true_lang-DB7bbnTO.js";import{_ as be}from"./RoleAssignMenuForm.vue_vue_type_script_setup_true_lang-HX5CqEl1.js";import{_ as ke}from"./RoleDataPermissionForm.vue_vue_type_script_setup_true_lang-Cyi5spll.js";import{h as we,aj as ve,k as he,x as Ce,Q as xe,F as Se,f as Te,Z as Ve,_ as Me,ak as Ue}from"./form-designer-DHHJWkD5.js";import"./Dialog.vue_vue_type_style_index_0_lang-D3YOFsHs.js";import"./constants-C3gLHYOK.js";import"./tree-COGD3qag.js";import"./index-C7J1l6yf.js";import"./index-CkOYuZOe.js";import"./index-C5VAipPY.js";const Re=re({name:"SystemRole",__name:"index",setup(Ne){const _=W(),{t:T}=X(),h=c(!0),V=c(0),M=c([]),s=ne({pageNo:1,pageSize:10,code:"",name:"",status:void 0,createTime:[]}),U=c(),C=c(!1),d=async()=>{h.value=!0;try{const i=await de(s);M.value=i.list,V.value=i.total}finally{h.value=!1}},w=()=>{s.pageNo=1,d()},I=()=>{U.value.resetFields(),w()},R=c(),N=(i,l)=>{R.value.open(i,l)},Y=c(),D=c(),v=c([]),j=i=>{v.value=i.map(l=>l.id)},H=async()=>{try{await _.delConfirm(),await ye(v.value),v.value=[],_.success(T("common.delSuccess")),await d()}catch{}},K=async()=>{try{await _.exportConfirm(),C.value=!0;const i=await _e(s);ue.excel(i,"\u89D2\u8272\u6570\u636E.xls")}catch{}finally{C.value=!1}};return ie(()=>{d()}),(i,l)=>{const F=se,O=he,g=ve,Z=xe,B=Ce,G=Se,b=le,p=Te,J=we,P=oe,n=Me,q=te,L=Ve,Q=ae,y=pe("hasPermi"),$=Ue;return r(),z(E,null,[e(F,{title:"\u529F\u80FD\u6743\u9650",url:"https://doc.iocoder.cn/resource-permission"}),e(F,{title:"\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/data-permission"}),e(P,null,{default:o(()=>[e(J,{ref_key:"queryFormRef",ref:U,inline:!0,model:t(s),class:"-mb-15px","label-width":"68px"},{default:o(()=>[e(g,{label:"\u89D2\u8272\u540D\u79F0",prop:"name"},{default:o(()=>[e(O,{modelValue:t(s).name,"onUpdate:modelValue":l[0]||(l[0]=a=>t(s).name=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",onKeyup:A(w,["enter"])},null,8,["modelValue"])]),_:1}),e(g,{label:"\u89D2\u8272\u6807\u8BC6",prop:"code"},{default:o(()=>[e(O,{modelValue:t(s).code,"onUpdate:modelValue":l[1]||(l[1]=a=>t(s).code=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",onKeyup:A(w,["enter"])},null,8,["modelValue"])]),_:1}),e(g,{label:"\u72B6\u6001",prop:"status"},{default:o(()=>[e(B,{modelValue:t(s).status,"onUpdate:modelValue":l[2]||(l[2]=a=>t(s).status=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001"},{default:o(()=>[(r(!0),z(E,null,ce(t(ee)(t(S).COMMON_STATUS),a=>(r(),m(Z,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:o(()=>[e(G,{modelValue:t(s).createTime,"onUpdate:modelValue":l[3]||(l[3]=a=>t(s).createTime=a),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(g,null,{default:o(()=>[e(p,{onClick:w},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:search"}),l[7]||(l[7]=u(" \u641C\u7D22 "))]),_:1}),e(p,{onClick:I},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:refresh"}),l[8]||(l[8]=u(" \u91CD\u7F6E "))]),_:1}),f((r(),m(p,{plain:"",type:"primary",onClick:l[4]||(l[4]=a=>N("create"))},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:plus"}),l[9]||(l[9]=u(" \u65B0\u589E "))]),_:1})),[[y,["system:role:create"]]]),f((r(),m(p,{loading:t(C),plain:"",type:"success",onClick:K},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:download"}),l[10]||(l[10]=u(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[y,["system:role:export"]]]),f((r(),m(p,{disabled:t(v).length===0,plain:"",type:"danger",onClick:H},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:delete"}),l[11]||(l[11]=u(" \u6279\u91CF\u5220\u9664 "))]),_:1},8,["disabled"])),[[y,["system:role:delete"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(P,null,{default:o(()=>[f((r(),m(L,{data:t(M),onSelectionChange:j},{default:o(()=>[e(n,{type:"selection",width:"55"}),e(n,{align:"center",label:"\u89D2\u8272\u7F16\u53F7",prop:"id"}),e(n,{align:"center",label:"\u89D2\u8272\u540D\u79F0",prop:"name"}),e(n,{label:"\u89D2\u8272\u7C7B\u578B",align:"center",prop:"type"},{default:o(a=>[e(q,{type:t(S).SYSTEM_ROLE_TYPE,value:a.row.type},null,8,["type","value"])]),_:1}),e(n,{align:"center",label:"\u89D2\u8272\u6807\u8BC6",prop:"code"}),e(n,{align:"center",label:"\u663E\u793A\u987A\u5E8F",prop:"sort"}),e(n,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),e(n,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:o(a=>[e(q,{type:t(S).COMMON_STATUS,value:a.row.status},null,8,["type","value"])]),_:1}),e(n,{formatter:t(me),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),e(n,{width:300,align:"center",label:"\u64CD\u4F5C"},{default:o(a=>[f((r(),m(p,{link:"",type:"primary",onClick:x=>N("update",a.row.id)},{default:o(()=>l[12]||(l[12]=[u(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[y,["system:role:update"]]]),f((r(),m(p,{link:"",preIcon:"ep:basketball",title:"\u83DC\u5355\u6743\u9650",type:"primary",onClick:x=>(async k=>{D.value.open(k)})(a.row)},{default:o(()=>l[13]||(l[13]=[u(" \u83DC\u5355\u6743\u9650 ")])),_:2},1032,["onClick"])),[[y,["system:permission:assign-role-menu"]]]),f((r(),m(p,{link:"",preIcon:"ep:coin",title:"\u6570\u636E\u6743\u9650",type:"primary",onClick:x=>(async k=>{Y.value.open(k)})(a.row)},{default:o(()=>l[14]||(l[14]=[u(" \u6570\u636E\u6743\u9650 ")])),_:2},1032,["onClick"])),[[y,["system:permission:assign-role-data-scope"]]]),f((r(),m(p,{link:"",type:"danger",onClick:x=>(async k=>{try{await _.delConfirm(),await fe(k),_.success(T("common.delSuccess")),await d()}catch{}})(a.row.id)},{default:o(()=>l[15]||(l[15]=[u(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[y,["system:role:delete"]]])]),_:1})]),_:1},8,["data"])),[[$,t(h)]]),e(Q,{limit:t(s).pageSize,"onUpdate:limit":l[5]||(l[5]=a=>t(s).pageSize=a),page:t(s).pageNo,"onUpdate:page":l[6]||(l[6]=a=>t(s).pageNo=a),total:t(V),onPagination:d},null,8,["limit","page","total"])]),_:1}),e(ge,{ref_key:"formRef",ref:R,onSuccess:d},null,512),e(be,{ref_key:"assignMenuFormRef",ref:D,onSuccess:d},null,512),e(ke,{ref_key:"dataPermissionFormRef",ref:Y,onSuccess:d},null,512)],64)}}});export{Re as default};
