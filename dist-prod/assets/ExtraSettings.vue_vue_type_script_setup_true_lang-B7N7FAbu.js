import{_ as se}from"./index-D_TWD7wt.js";import{ax as T,aj as ue,w as ie,a7 as ne,k as de,x as oe,Q as re,l as pe,s as me,u as fe,o as ve,aQ as ge,D as ce,f as xe,h as Se}from"./form-designer-DHHJWkD5.js";import{B as N,b as we}from"./constants-C3gLHYOK.js";import{g as ye}from"./index-DtDcjRGr.js";import{p as _e}from"./index-BCN8BzfC.js";import{P as U}from"./consts-CvaDWb4S.js";import{a as h}from"./HttpRequestSetting.vue_vue_type_script_setup_true_lang-BaqkTJqn.js";import{_ as Ve}from"./Index.vue_vue_type_script_setup_true_lang-D_aTNp3A.js";import{l as Te,as as he,r as v,c as D,b as Ie,m as I,q as o,J as t,B as a,A as p,E as f,x as i,G as n,I as B,$ as C,u as r,H as Re,h as R,p as O}from"./form-create-_84fGzaM.js";const ke={class:"flex flex-col"},Ae={class:"flex flex-col"},Ue={class:"ml-22px"},De={class:"flex flex-col"},Be={key:0,class:"ml-22px"},Ye={class:"flex flex-col"},Ee={class:"flex flex-col"},be={class:"flex flex-col"},Me={class:"flex flex-col"},Ne={class:"flex flex-col"},Ce={class:"flex flex-col"},Oe={class:"flex flex-col w-100%"},ze={class:"flex"},He={class:"flex flex-col w-100%"},Pe={class:"flex"},We={class:"flex flex-col w-100%"},Fe={class:"flex"},je={class:"flex flex-col w-100%"},qe={class:"flex"},Je={class:"flex flex-col w-100%"},Le={class:"flex"},Qe=Te({__name:"ExtraSettings",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(z,{expose:H}){const l=he(z,"modelValue"),P=v([{value:"",label:"\u65E0"},{value:"DAY",label:"\u7CBE\u786E\u5230\u65E5"},{value:"HOUR",label:"\u7CBE\u786E\u5230\u65F6"},{value:"MINUTE",label:"\u7CBE\u786E\u5230\u5206"},{value:"SECOND",label:"\u7CBE\u786E\u5230\u79D2"}]),W=D(()=>{if(l.value.processIdRule.enable){let u="";switch(l.value.processIdRule.infix){case"DAY":u=T().format("YYYYMMDD");break;case"HOUR":u=T().format("YYYYMMDDHH");break;case"MINUTE":u=T().format("YYYYMMDDHHmm");break;case"SECOND":u=T().format("YYYYMMDDHHmmss")}return l.value.processIdRule.prefix+u+l.value.processIdRule.postfix+"1".padStart(l.value.processIdRule.length-1,"0")}return""}),c=v(!1),F=u=>{l.value.processBeforeTriggerSetting=u?{url:"",header:[],body:[],response:[]}:null},x=v(!1),j=u=>{l.value.processAfterTriggerSetting=u?{url:"",header:[],body:[],response:[]}:null},S=v(!1),q=u=>{l.value.taskBeforeTriggerSetting=u?{url:"",header:[],body:[],response:[]}:null},w=v(!1),J=u=>{l.value.taskAfterTriggerSetting=u?{url:"",header:[],body:[],response:[]}:null},y=v([]),L=D(()=>{let u=y.value.map(e=>({label:e.title,value:e.field}));return u.unshift({label:"\u6D41\u7A0B\u540D\u79F0",value:U.PROCESS_DEFINITION_NAME}),u.unshift({label:"\u53D1\u8D77\u65F6\u95F4",value:U.START_TIME}),u.unshift({label:"\u53D1\u8D77\u4EBA",value:U.START_USER_ID}),u}),Q=D(()=>y.value.map(u=>({label:u.title,value:u.field}))),k=v([]);O("formFields",k),O("formFieldsObj",y),H({initData:()=>{l.value.processIdRule||(l.value.processIdRule={enable:!1,prefix:"",infix:"",postfix:"",length:5}),l.value.autoApprovalType||(l.value.autoApprovalType=we.NONE),l.value.titleSetting||(l.value.titleSetting={enable:!1,title:""}),l.value.summarySetting||(l.value.summarySetting={enable:!1,summary:[]}),l.value.processBeforeTriggerSetting&&(c.value=!0),l.value.processAfterTriggerSetting&&(x.value=!0),l.value.taskBeforeTriggerSetting&&(S.value=!0),l.value.taskAfterTriggerSetting&&(w.value=!0),l.value.allowWithdrawTask&&(l.value.allowWithdrawTask=!1),l.value.printTemplateSetting||(l.value.printTemplateSetting={enable:!1})}}),Ie(()=>l.value.formId,async u=>{if(u&&l.value.formType===N.NORMAL){const e=await ye(u),d=[];e.fields&&(k.value=e.fields,e.fields.forEach(_=>{_e(JSON.parse(_),d)})),y.value=d}else y.value=[],k.value=[]},{immediate:!0});const G=u=>{u&&(l.value.printTemplateSetting.template||(l.value.printTemplateSetting.template='<p style="text-align: center;"><span data-w-e-type="mention" data-w-e-is-void="" data-w-e-is-inline="" data-value="\u6D41\u7A0B\u540D\u79F0" data-info="%7B%22id%22%3A%22processName%22%7D">@\u6D41\u7A0B\u540D\u79F0</span></p><p style="text-align: right;">\u6253\u5370\u4EBA\uFF1A<span data-w-e-type="mention" data-w-e-is-void="" data-w-e-is-inline="" data-value="\u6253\u5370\u4EBA" data-info="%7B%22id%22%3A%22printUser%22%7D">@\u6253\u5370\u4EBA</span></p><p style="text-align: right;">\u6D41\u7A0B\u7F16\u53F7\uFF1A<span data-w-e-type="mention" data-w-e-is-void="" data-w-e-is-inline="" data-value="\u6D41\u7A0B\u7F16\u53F7" data-info="%7B%22id%22%3A%22processNum%22%7D">@\u6D41\u7A0B\u7F16\u53F7</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\u6253\u5370\u65F6\u95F4\uFF1A<span data-w-e-type="mention" data-w-e-is-void="" data-w-e-is-inline="" data-value="\u6253\u5370\u65F6\u95F4" data-info="%7B%22id%22%3A%22printTime%22%7D">@\u6253\u5370\u65F6\u95F4</span></p><table style="width: 100%;"><tbody><tr><td colSpan="1" rowSpan="1" width="auto">\u53D1\u8D77\u4EBA</td><td colSpan="1" rowSpan="1" width="auto"><span data-w-e-type="mention" data-w-e-is-void data-w-e-is-inline data-value="\u53D1\u8D77\u4EBA" data-info="%7B%22id%22%3A%22startUser%22%7D">@\u53D1\u8D77\u4EBA</span></td><td colSpan="1" rowSpan="1" width="auto">\u53D1\u8D77\u65F6\u95F4</td><td colSpan="1" rowSpan="1" width="auto"><span data-w-e-type="mention" data-w-e-is-void data-w-e-is-inline data-value="\u53D1\u8D77\u65F6\u95F4" data-info="%7B%22id%22%3A%22startTime%22%7D">@\u53D1\u8D77\u65F6\u95F4</span></td></tr><tr><td colSpan="1" rowSpan="1" width="auto">\u6240\u5C5E\u90E8\u95E8</td><td colSpan="1" rowSpan="1" width="auto"><span data-w-e-type="mention" data-w-e-is-void data-w-e-is-inline data-value="\u53D1\u8D77\u4EBA\u90E8\u95E8" data-info="%7B%22id%22%3A%22startUserDept%22%7D">@\u53D1\u8D77\u4EBA\u90E8\u95E8</span></td><td colSpan="1" rowSpan="1" width="auto">\u6D41\u7A0B\u72B6\u6001</td><td colSpan="1" rowSpan="1" width="auto"><span data-w-e-type="mention" data-w-e-is-void data-w-e-is-inline data-value="\u6D41\u7A0B\u72B6\u6001" data-info="%7B%22id%22%3A%22processStatus%22%7D">@\u6D41\u7A0B\u72B6\u6001</span></td></tr></tbody></table><p><span data-w-e-type="process-record" data-w-e-is-void data-w-e-is-inline>\u6D41\u7A0B\u8BB0\u5F55</span></p>'))},Y=v(),$=()=>{Y.value.open(l.value.printTemplateSetting.template)},K=u=>{l.value.printTemplateSetting.template=u};return(u,e)=>{const d=ne,_=ie,m=ue,E=de,b=re,M=oe,X=pe,g=fe,A=me,Z=se,ee=ve,le=ge,V=ce,ae=xe,te=Se;return o(),I(B,null,[t(te,{ref:"formRef",model:l.value,"label-width":"130px",class:"mt-20px"},{default:a(()=>[t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[21]||(e[21]=[n("\u63D0\u4EA4\u4EBA\u6743\u9650")])),_:1})]),default:a(()=>[i("div",ke,[t(_,{modelValue:l.value.allowCancelRunningProcess,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.allowCancelRunningProcess=s),label:"\u5141\u8BB8\u64A4\u9500\u5BA1\u6279\u4E2D\u7684\u7533\u8BF7"},null,8,["modelValue"])])]),_:1}),t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[22]||(e[22]=[n("\u5BA1\u6279\u4EBA\u6743\u9650")])),_:1})]),default:a(()=>[i("div",Ae,[t(_,{modelValue:l.value.allowWithdrawTask,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.allowWithdrawTask=s),label:"\u5141\u8BB8\u5BA1\u6279\u4EBA\u64A4\u56DE\u4EFB\u52A1"},null,8,["modelValue"]),i("div",Ue,[t(d,{type:"info"},{default:a(()=>e[23]||(e[23]=[n(" \u5BA1\u6279\u4EBA\u53EF\u64A4\u56DE\u6B63\u5728\u5BA1\u6279\u8282\u70B9\u7684\u524D\u4E00\u8282\u70B9 ")])),_:1})])])]),_:1}),l.value.processIdRule?(o(),p(m,{key:0,class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[24]||(e[24]=[n("\u6D41\u7A0B\u7F16\u7801")])),_:1})]),default:a(()=>[i("div",De,[i("div",null,[t(E,{modelValue:l.value.processIdRule.prefix,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.processIdRule.prefix=s),class:"w-130px!",placeholder:"\u524D\u7F00",disabled:!l.value.processIdRule.enable},{prepend:a(()=>[t(_,{modelValue:l.value.processIdRule.enable,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.processIdRule.enable=s)},null,8,["modelValue"])]),_:1},8,["modelValue","disabled"]),t(M,{modelValue:l.value.processIdRule.infix,"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.processIdRule.infix=s),class:"w-130px! ml-5px",placeholder:"\u4E2D\u7F00",disabled:!l.value.processIdRule.enable},{default:a(()=>[(o(!0),I(B,null,C(r(P),s=>(o(),p(b,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),t(E,{modelValue:l.value.processIdRule.postfix,"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.processIdRule.postfix=s),class:"w-80px! ml-5px",placeholder:"\u540E\u7F00",disabled:!l.value.processIdRule.enable},null,8,["modelValue","disabled"]),t(X,{modelValue:l.value.processIdRule.length,"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.processIdRule.length=s),class:"w-120px! ml-5px",min:5,disabled:!l.value.processIdRule.enable},null,8,["modelValue","disabled"])]),l.value.processIdRule.enable?(o(),I("div",Be,[t(d,{type:"info"},{default:a(()=>[n(" \u7F16\u7801\u793A\u4F8B\uFF1A"+Re(r(W)),1)]),_:1})])):f("",!0)])]),_:1})):f("",!0),t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[25]||(e[25]=[n("\u81EA\u52A8\u53BB\u91CD")])),_:1})]),default:a(()=>[i("div",Ye,[i("div",null,[t(d,null,{default:a(()=>e[26]||(e[26]=[n(" \u540C\u4E00\u5BA1\u6279\u4EBA\u5728\u6D41\u7A0B\u4E2D\u91CD\u590D\u51FA\u73B0\u65F6\uFF1A ")])),_:1})]),t(A,{modelValue:l.value.autoApprovalType,"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.autoApprovalType=s)},{default:a(()=>[i("div",Ee,[t(g,{value:0},{default:a(()=>e[27]||(e[27]=[n("\u4E0D\u81EA\u52A8\u901A\u8FC7")])),_:1}),t(g,{value:1},{default:a(()=>e[28]||(e[28]=[n("\u4EC5\u5BA1\u6279\u4E00\u6B21\uFF0C\u540E\u7EED\u91CD\u590D\u7684\u5BA1\u6279\u8282\u70B9\u5747\u81EA\u52A8\u901A\u8FC7")])),_:1}),t(g,{value:2},{default:a(()=>e[29]||(e[29]=[n("\u4EC5\u9488\u5BF9\u8FDE\u7EED\u5BA1\u6279\u7684\u8282\u70B9\u81EA\u52A8\u901A\u8FC7")])),_:1})])]),_:1},8,["modelValue"])])]),_:1}),l.value.titleSetting?(o(),p(m,{key:1,class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[30]||(e[30]=[n("\u6807\u9898\u8BBE\u7F6E")])),_:1})]),default:a(()=>[i("div",be,[t(A,{modelValue:l.value.titleSetting.enable,"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.titleSetting.enable=s)},{default:a(()=>[i("div",Me,[t(g,{value:!1},{default:a(()=>[e[32]||(e[32]=n("\u7CFB\u7EDF\u9ED8\u8BA4 ")),t(d,{type:"info"},{default:a(()=>e[31]||(e[31]=[n(" \u5C55\u793A\u6D41\u7A0B\u540D\u79F0 ")])),_:1})]),_:1}),t(g,{value:!0},{default:a(()=>[e[33]||(e[33]=n(" \u81EA\u5B9A\u4E49\u6807\u9898 ")),t(d,null,{default:a(()=>[t(ee,{content:"\u8F93\u5165\u5B57\u7B26 '{' \u5373\u53EF\u63D2\u5165\u8868\u5355\u5B57\u6BB5",effect:"light",placement:"top"},{default:a(()=>[t(Z,{icon:"ep:question-filled",class:"ml-5px"})]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue"]),l.value.titleSetting.enable?(o(),p(le,{key:0,modelValue:l.value.titleSetting.title,"onUpdate:modelValue":e[9]||(e[9]=s=>l.value.titleSetting.title=s),type:"textarea",prefix:"{",split:"}",whole:"",options:r(L),placeholder:"\u8BF7\u63D2\u5165\u8868\u5355\u5B57\u6BB5\uFF08\u8F93\u5165 '{' \u53EF\u4EE5\u9009\u62E9\u8868\u5355\u5B57\u6BB5\uFF09\u6216\u8F93\u5165\u6587\u672C",class:"w-600px!"},null,8,["modelValue","options"])):f("",!0)])]),_:1})):f("",!0),l.value.summarySetting&&l.value.formType===r(N).NORMAL?(o(),p(m,{key:2,class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[34]||(e[34]=[n("\u6458\u8981\u8BBE\u7F6E")])),_:1})]),default:a(()=>[i("div",Ne,[t(A,{modelValue:l.value.summarySetting.enable,"onUpdate:modelValue":e[10]||(e[10]=s=>l.value.summarySetting.enable=s)},{default:a(()=>[i("div",Ce,[t(g,{value:!1},{default:a(()=>[e[36]||(e[36]=n(" \u7CFB\u7EDF\u9ED8\u8BA4 ")),t(d,{type:"info"},{default:a(()=>e[35]||(e[35]=[n(" \u5C55\u793A\u8868\u5355\u524D 3 \u4E2A\u5B57\u6BB5 ")])),_:1})]),_:1}),t(g,{value:!0},{default:a(()=>e[37]||(e[37]=[n(" \u81EA\u5B9A\u4E49\u6458\u8981 ")])),_:1})])]),_:1},8,["modelValue"]),l.value.summarySetting.enable?(o(),p(M,{key:0,class:"w-500px!",modelValue:l.value.summarySetting.summary,"onUpdate:modelValue":e[11]||(e[11]=s=>l.value.summarySetting.summary=s),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u8981\u5C55\u793A\u7684\u8868\u5355\u5B57\u6BB5"},{default:a(()=>[(o(!0),I(B,null,C(r(Q),s=>(o(),p(b,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):f("",!0)])]),_:1})):f("",!0),t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[38]||(e[38]=[n("\u6D41\u7A0B\u524D\u7F6E\u901A\u77E5")])),_:1})]),default:a(()=>[i("div",Oe,[i("div",ze,[t(V,{modelValue:r(c),"onUpdate:modelValue":e[12]||(e[12]=s=>R(c)?c.value=s:null),onChange:F},null,8,["modelValue"]),e[39]||(e[39]=i("div",{class:"ml-80px"},"\u6D41\u7A0B\u542F\u52A8\u540E\u901A\u77E5",-1))]),r(c)?(o(),p(h,{key:0,setting:l.value.processBeforeTriggerSetting,"onUpdate:setting":e[13]||(e[13]=s=>l.value.processBeforeTriggerSetting=s),responseEnable:!0,formItemPrefix:"processBeforeTriggerSetting"},null,8,["setting"])):f("",!0)])]),_:1}),t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[40]||(e[40]=[n("\u6D41\u7A0B\u540E\u7F6E\u901A\u77E5")])),_:1})]),default:a(()=>[i("div",He,[i("div",Pe,[t(V,{modelValue:r(x),"onUpdate:modelValue":e[14]||(e[14]=s=>R(x)?x.value=s:null),onChange:j},null,8,["modelValue"]),e[41]||(e[41]=i("div",{class:"ml-80px"},"\u6D41\u7A0B\u7ED3\u675F\u540E\u901A\u77E5",-1))]),r(x)?(o(),p(h,{key:0,setting:l.value.processAfterTriggerSetting,"onUpdate:setting":e[15]||(e[15]=s=>l.value.processAfterTriggerSetting=s),responseEnable:!0,formItemPrefix:"processAfterTriggerSetting"},null,8,["setting"])):f("",!0)])]),_:1}),t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[42]||(e[42]=[n("\u4EFB\u52A1\u524D\u7F6E\u901A\u77E5")])),_:1})]),default:a(()=>[i("div",We,[i("div",Fe,[t(V,{modelValue:r(S),"onUpdate:modelValue":e[16]||(e[16]=s=>R(S)?S.value=s:null),onChange:q},null,8,["modelValue"]),e[43]||(e[43]=i("div",{class:"ml-80px"},"\u4EFB\u52A1\u6267\u884C\u65F6\u901A\u77E5",-1))]),r(S)?(o(),p(h,{key:0,setting:l.value.taskBeforeTriggerSetting,"onUpdate:setting":e[17]||(e[17]=s=>l.value.taskBeforeTriggerSetting=s),responseEnable:!0,formItemPrefix:"taskBeforeTriggerSetting"},null,8,["setting"])):f("",!0)])]),_:1}),t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[44]||(e[44]=[n("\u4EFB\u52A1\u540E\u7F6E\u901A\u77E5")])),_:1})]),default:a(()=>[i("div",je,[i("div",qe,[t(V,{modelValue:r(w),"onUpdate:modelValue":e[18]||(e[18]=s=>R(w)?w.value=s:null),onChange:J},null,8,["modelValue"]),e[45]||(e[45]=i("div",{class:"ml-80px"},"\u4EFB\u52A1\u7ED3\u675F\u540E\u901A\u77E5",-1))]),r(w)?(o(),p(h,{key:0,setting:l.value.taskAfterTriggerSetting,"onUpdate:setting":e[19]||(e[19]=s=>l.value.taskAfterTriggerSetting=s),responseEnable:!0,formItemPrefix:"taskAfterTriggerSetting"},null,8,["setting"])):f("",!0)])]),_:1}),t(m,{class:"mb-20px"},{label:a(()=>[t(d,{size:"large",tag:"b"},{default:a(()=>e[46]||(e[46]=[n("\u81EA\u5B9A\u4E49\u6253\u5370\u6A21\u677F")])),_:1})]),default:a(()=>[i("div",Je,[i("div",Le,[t(V,{modelValue:l.value.printTemplateSetting.enable,"onUpdate:modelValue":e[20]||(e[20]=s=>l.value.printTemplateSetting.enable=s),onChange:G},null,8,["modelValue"]),l.value.printTemplateSetting.enable?(o(),p(ae,{key:0,class:"ml-80px",type:"primary",link:"",onClick:$},{default:a(()=>e[47]||(e[47]=[n(" \u7F16\u8F91\u6A21\u677F ")])),_:1})):f("",!0)])])]),_:1})]),_:1},8,["model"]),t(Ve,{ref_key:"printTemplateRef",ref:Y,onConfirm:K},null,512)],64)}}});export{Qe as _};
