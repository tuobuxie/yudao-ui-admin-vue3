import{_ as O}from"./Dialog.vue_vue_type_style_index_0_lang-C4PMlRRW.js";import{a as R,d as z,e as w,u as N,_ as G,h as H,D as J}from"./index-DmQdxAiK.js";import{_ as L}from"./ContentWrap.vue_vue_type_script_setup_true_lang-OPDE9cVe.js";import{C as P}from"./constants-C3gLHYOK.js";import{g as W,c as $,u as K}from"./index-D29lUHab.js";import{ae as Q,f as X,h as Y,aj as Z,k as ee,s as ae,u as le}from"./form-designer-DHHJWkD5.js";import{s as oe,e as te,a as se}from"./formCreate-BIGK0pmc.js";import{u as re}from"./tagsView-CQDzb46U.js";import{u as ue}from"./useFormCreateDesigner-ycw6yx_7.js";import{l as de,r as d,j as me,e as ne,m as b,q as h,J as l,B as o,x as ie,u as a,G as i,I as V,$ as pe,A as fe,H as ce,h as he}from"./form-create-_84fGzaM.js";import"./index-BCN8BzfC.js";import"./dict.type-uCG97J4P.js";const ve={class:"h-[calc(100vh-var(--top-tool-height)-var(--tags-view-height)-var(--app-content-padding)-var(--app-content-padding)-2px)]"},ge=de({name:"BpmFormEditor",__name:"index",setup(ye){const{t:v}=R(),g=z(),k=w(),{push:C,currentRoute:x}=N(),{query:B}=w(),{delView:D}=re(),F=d({switchType:[],autoActive:!0,useTemplate:!1,formOptions:{form:{labelWidth:"100px"}},fieldReadonly:!1,hiddenDragMenu:!1,hiddenDragBtn:!1,hiddenMenu:[],hiddenItem:[],hiddenItemConfig:{},disabledItemConfig:{},showSaveBtn:!1,showConfig:!0,showBaseForm:!0,showControl:!0,showPropsForm:!0,showEventForm:!0,showValidateForm:!0,showFormConfig:!0,showInputData:!0,showDevice:!0,appendConfigData:[]}),m=d();ue(m);const u=d(!1),p=d(!1),s=d({name:"",status:P.ENABLE,remark:""}),I=me({name:[{required:!0,message:"\u8868\u5355\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u5F00\u542F\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),f=d(),S=()=>{u.value=!0},U=async()=>{if(f&&await f.value.validate()){p.value=!0;try{const r=s.value;r.conf=te(m),r.fields=se(m),r.id?(await K(r),g.success(v("common.updateSuccess"))):(await $(r),g.success(v("common.createSuccess"))),u.value=!1,q()}finally{p.value=!1}}},q=()=>{D(a(x)),C("/bpm/manager/form")};return ne(async()=>{const r=B.id;if(!r)return;const e=await W(r);if(s.value=e,oe(m,e.conf,e.fields),k.query.type!=="copy")return;const{id:y,...n}=e;s.value=n,s.value.name+="_copy"}),(r,e)=>{const y=G,n=X,A=L,_=ee,c=Z,E=le,M=ae,T=Y,j=O;return h(),b(V,null,[l(A,{"body-style":{padding:"0px"},class:"!mb-0"},{default:o(()=>[ie("div",ve,[l(a(Q),{class:"my-designer",ref_key:"designer",ref:m,config:a(F)},{handle:o(()=>[l(n,{size:"small",type:"success",plain:"",onClick:S},{default:o(()=>[l(y,{class:"mr-5px",icon:"ep:plus"}),e[5]||(e[5]=i(" \u4FDD\u5B58 "))]),_:1})]),_:1},8,["config"])])]),_:1}),l(j,{modelValue:a(u),"onUpdate:modelValue":e[4]||(e[4]=t=>he(u)?u.value=t:null),title:"\u4FDD\u5B58\u8868\u5355",width:"600"},{footer:o(()=>[l(n,{disabled:a(p),type:"primary",onClick:U},{default:o(()=>e[6]||(e[6]=[i("\u786E \u5B9A")])),_:1},8,["disabled"]),l(n,{onClick:e[3]||(e[3]=t=>u.value=!1)},{default:o(()=>e[7]||(e[7]=[i("\u53D6 \u6D88")])),_:1})]),default:o(()=>[l(T,{ref_key:"formRef",ref:f,model:a(s),rules:a(I),"label-width":"80px"},{default:o(()=>[l(c,{label:"\u8868\u5355\u540D",prop:"name"},{default:o(()=>[l(_,{modelValue:a(s).name,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).name=t),placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u72B6\u6001",prop:"status"},{default:o(()=>[l(M,{modelValue:a(s).status,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).status=t)},{default:o(()=>[(h(!0),b(V,null,pe(a(H)(a(J).COMMON_STATUS),t=>(h(),fe(E,{key:t.value,value:t.value},{default:o(()=>[i(ce(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"\u5907\u6CE8",prop:"remark"},{default:o(()=>[l(_,{modelValue:a(s).remark,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).remark=t),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}});export{ge as default};
