import{aE as E,N as M,c as z}from"./index-B2urM1q-.js";import K from"./ThingModelEnumDataSpecs-CJJ_M4fU.js";import Z from"./ThingModelNumberDataSpecs-CgvyUkPT.js";import{_ as ee}from"./Dialog.vue_vue_type_style_index_0_lang-bMayE4GC.js";import{a as s,e as A,f as q}from"./constants-D46CCSyK.js";import{a as ae,v as le}from"./index-Dg-RGpco.js";import{aj as w,f as te,V as de,h as se,k as N,ak as pe,s as F,u as Y,x as ue,Q as oe}from"./form-designer-DHHJWkD5.js";import{l as I,r as C,e as re,n as ie,m as f,q as o,I as T,J as r,B as u,$ as O,x,H as R,G as V,u as e,h as ne,C as ce,A as m,E as v,c as me,b as ye}from"./form-create-_84fGzaM.js";const Se={class:"btn"},j=z(I({name:"ThingModelStructDataSpecs",__name:"ThingModelStructDataSpecs",props:{modelValue:{}},emits:["update:modelValue"],setup(h,{emit:k}){const i=E(h,"modelValue",k),l=C(!1),b=C("\u65B0\u589E\u53C2\u6570"),S=C(!1),c=C(),t=C({property:{dataType:s.INT,dataSpecs:{dataType:s.INT}}}),_=p=>{l.value=!0,n(),M(p)||(t.value={identifier:p.identifier,name:p.name,description:p.description,property:{dataType:p.childDataType,dataSpecs:p.dataSpecs,dataSpecsList:p.dataSpecsList}})},g=async()=>{await c.value.validate();try{const p=e(t),d={identifier:p.identifier,name:p.name,description:p.description,dataType:s.STRUCT,childDataType:p.property.dataType,dataSpecs:p.property.dataSpecs&&Object.keys(p.property.dataSpecs).length>1?p.property.dataSpecs:void 0,dataSpecsList:M(p.property.dataSpecsList)?void 0:p.property.dataSpecsList},a=i.value.findIndex(L=>L.identifier===p.identifier);a>-1?i.value[a]=d:i.value.push(d)}finally{l.value=!1}},n=()=>{var p;t.value={property:{dataType:s.INT,dataSpecs:{dataType:s.INT}}},(p=c.value)==null||p.resetFields()},U=(p,d,a)=>{M(i.value)?a(new Error("struct \u4E0D\u80FD\u4E3A\u7A7A")):a()};return re(async()=>{await ie(),M(i.value)&&(i.value=[])}),(p,d)=>{const a=te,L=de,D=w,P=N,G=se,H=ee,Q=pe;return o(),f(T,null,[r(D,{rules:[{required:!0,validator:U,trigger:"change"}],label:"JSON \u5BF9\u8C61"},{default:u(()=>[(o(!0),f(T,null,O(e(i),(y,$)=>(o(),f("div",{key:$,class:"w-1/1 struct-item flex justify-between px-10px mb-10px"},[x("span",null,"\u53C2\u6570\u540D\u79F0\uFF1A"+R(y.name),1),x("div",Se,[r(a,{link:"",type:"primary",onClick:W=>_(y)},{default:u(()=>d[6]||(d[6]=[V("\u7F16\u8F91")])),_:2},1032,["onClick"]),r(L,{direction:"vertical"}),r(a,{link:"",type:"danger",onClick:W=>(X=>{i.value.splice(X,1)})($)},{default:u(()=>d[7]||(d[7]=[V("\u5220\u9664")])),_:2},1032,["onClick"])])]))),128)),r(a,{link:"",type:"primary",onClick:d[0]||(d[0]=y=>_(null))},{default:u(()=>d[8]||(d[8]=[V("+\u65B0\u589E\u53C2\u6570")])),_:1})]),_:1},8,["rules"]),r(H,{modelValue:e(l),"onUpdate:modelValue":d[5]||(d[5]=y=>ne(l)?l.value=y:null),title:e(b),"append-to-body":""},{footer:u(()=>[r(a,{disabled:e(S),type:"primary",onClick:g},{default:u(()=>d[9]||(d[9]=[V("\u786E \u5B9A")])),_:1},8,["disabled"]),r(a,{onClick:d[4]||(d[4]=y=>l.value=!1)},{default:u(()=>d[10]||(d[10]=[V("\u53D6 \u6D88")])),_:1})]),default:u(()=>[ce((o(),m(G,{ref_key:"structFormRef",ref:c,model:e(t),rules:e(ae),"label-width":"100px"},{default:u(()=>[r(D,{label:"\u53C2\u6570\u540D\u79F0",prop:"name"},{default:u(()=>[r(P,{modelValue:e(t).name,"onUpdate:modelValue":d[1]||(d[1]=y=>e(t).name=y),placeholder:"\u8BF7\u8F93\u5165\u529F\u80FD\u540D\u79F0"},null,8,["modelValue"])]),_:1}),r(D,{label:"\u6807\u8BC6\u7B26",prop:"identifier"},{default:u(()=>[r(P,{modelValue:e(t).identifier,"onUpdate:modelValue":d[2]||(d[2]=y=>e(t).identifier=y),placeholder:"\u8BF7\u8F93\u5165\u6807\u8BC6\u7B26"},null,8,["modelValue"])]),_:1}),r(B,{modelValue:e(t).property,"onUpdate:modelValue":d[3]||(d[3]=y=>e(t).property=y),"is-struct-data-specs":""},null,8,["modelValue"])]),_:1},8,["model","rules"])),[[Q,e(S)]])]),_:1},8,["modelValue","title"])],64)}}}),[["__scopeId","data-v-d885a7ea"]]),fe=Object.freeze(Object.defineProperty({__proto__:null,default:j},Symbol.toStringTag,{value:"Module"})),J=I({name:"ThingModelArrayDataSpecs",__name:"ThingModelArrayDataSpecs",props:{modelValue:{}},emits:["update:modelValue"],setup(h,{emit:k}){const i=E(h,"modelValue",k),l=b=>{b===s.STRUCT&&(i.value.dataSpecsList=[])};return(b,S)=>{const c=Y,t=F,_=w,g=N;return o(),f(T,null,[r(_,{label:"\u5143\u7D20\u7C7B\u578B",prop:"property.dataSpecs.childDataType"},{default:u(()=>[r(t,{modelValue:e(i).childDataType,"onUpdate:modelValue":S[0]||(S[0]=n=>e(i).childDataType=n),onChange:l},{default:u(()=>[(o(!0),f(T,null,O(e(A)(),n=>(o(),f(T,{key:n.value},[[e(s).ENUM,e(s).ARRAY,e(s).DATE].includes(n.value)?v("",!0):(o(),m(c,{key:0,value:n.value,class:"w-1/3"},{default:u(()=>[V(R(`${n.value}(${n.label})`),1)]),_:2},1032,["value"]))],64))),128))]),_:1},8,["modelValue"])]),_:1}),r(_,{label:"\u5143\u7D20\u4E2A\u6570",prop:"property.dataSpecs.size"},{default:u(()=>[r(g,{modelValue:e(i).size,"onUpdate:modelValue":S[1]||(S[1]=n=>e(i).size=n),placeholder:"\u8BF7\u8F93\u5165\u6570\u7EC4\u4E2D\u7684\u5143\u7D20\u4E2A\u6570"},null,8,["modelValue"])]),_:1}),e(i).childDataType===e(s).STRUCT?(o(),m(j,{key:0,modelValue:e(i).dataSpecsList,"onUpdate:modelValue":S[2]||(S[2]=n=>e(i).dataSpecsList=n)},null,8,["modelValue"])):v("",!0)],64)}}}),B=z(I({name:"ThingModelProperty",__name:"ThingModelProperty",props:{modelValue:{},isStructDataSpecs:{type:Boolean},isParams:{type:Boolean}},emits:["update:modelValue"],setup(h,{emit:k}){const i=h,l=E(i,"modelValue",k),b=me(()=>{if(!i.isStructDataSpecs)return A();const c=[s.STRUCT,s.ARRAY];return A().filter(t=>!c.includes(t.value))}),S=c=>{switch(l.value.dataSpecs={},l.value.dataSpecsList=[],![s.ENUM,s.BOOL,s.STRUCT].includes(c)&&(l.value.dataSpecs.dataType=c),c){case s.ENUM:l.value.dataSpecsList.push({dataType:s.ENUM,name:"",value:void 0});break;case s.BOOL:for(let t=0;t<2;t++)l.value.dataSpecsList.push({dataType:s.BOOL,name:"",value:t})}};return ye(()=>l.value.accessMode,c=>{i.isStructDataSpecs||i.isParams||M(c)&&(l.value.accessMode=q.READ_WRITE.value)},{immediate:!0}),(c,t)=>{const _=oe,g=ue,n=w,U=N,p=Y,d=F;return o(),f(T,null,[r(n,{rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B",trigger:"change"}],label:"\u6570\u636E\u7C7B\u578B",prop:"property.dataType"},{default:u(()=>[r(g,{modelValue:e(l).dataType,"onUpdate:modelValue":t[0]||(t[0]=a=>e(l).dataType=a),placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B",onChange:S},{default:u(()=>[(o(!0),f(T,null,O(e(b),a=>(o(),m(_,{key:a.value,label:`${a.value}(${a.label})`,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),[e(s).INT,e(s).DOUBLE,e(s).FLOAT].includes(e(l).dataType||"")?(o(),m(e(Z),{key:0,modelValue:e(l).dataSpecs,"onUpdate:modelValue":t[1]||(t[1]=a=>e(l).dataSpecs=a)},null,8,["modelValue"])):v("",!0),e(l).dataType===e(s).ENUM?(o(),m(e(K),{key:1,modelValue:e(l).dataSpecsList,"onUpdate:modelValue":t[2]||(t[2]=a=>e(l).dataSpecsList=a)},null,8,["modelValue"])):v("",!0),e(l).dataType===e(s).BOOL?(o(),m(n,{key:2,label:"\u5E03\u5C14\u503C"},{default:u(()=>[(o(!0),f(T,null,O(e(l).dataSpecsList,(a,L)=>(o(),f("div",{key:a.value,class:"flex items-center justify-start w-1/1 mb-5px"},[x("span",null,R(a.value),1),t[7]||(t[7]=x("span",{class:"mx-2"},"-",-1)),r(n,{prop:`property.dataSpecsList[${L}].name`,rules:[{required:!0,message:"\u679A\u4E3E\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A"},{validator:e(le),trigger:"blur"}],class:"flex-1 mb-0"},{default:u(()=>[r(U,{modelValue:a.name,"onUpdate:modelValue":D=>a.name=D,placeholder:"\u5982\uFF1A"+(a.value===0?"\u5173":"\u5F00"),class:"w-255px!"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["prop","rules"])]))),128))]),_:1})):v("",!0),e(l).dataType===e(s).TEXT?(o(),m(n,{key:3,label:"\u6570\u636E\u957F\u5EA6",prop:"property.dataSpecs.length"},{default:u(()=>[r(U,{modelValue:e(l).dataSpecs.length,"onUpdate:modelValue":t[3]||(t[3]=a=>e(l).dataSpecs.length=a),class:"w-255px!",placeholder:"\u8BF7\u8F93\u5165\u6587\u672C\u5B57\u8282\u957F\u5EA6"},{append:u(()=>t[8]||(t[8]=[V("\u5B57\u8282")])),_:1},8,["modelValue"])]),_:1})):v("",!0),e(l).dataType===e(s).DATE?(o(),m(n,{key:4,label:"\u65F6\u95F4\u683C\u5F0F",prop:"date"},{default:u(()=>[r(U,{class:"w-255px!",disabled:"",placeholder:"String \u7C7B\u578B\u7684 UTC \u65F6\u95F4\u6233\uFF08\u6BEB\u79D2\uFF09"})]),_:1})):v("",!0),e(l).dataType===e(s).ARRAY?(o(),m(e(J),{key:5,modelValue:e(l).dataSpecs,"onUpdate:modelValue":t[4]||(t[4]=a=>e(l).dataSpecs=a)},null,8,["modelValue"])):v("",!0),e(l).dataType===e(s).STRUCT?(o(),m(e(j),{key:6,modelValue:e(l).dataSpecsList,"onUpdate:modelValue":t[5]||(t[5]=a=>e(l).dataSpecsList=a)},null,8,["modelValue"])):v("",!0),c.isStructDataSpecs||c.isParams?v("",!0):(o(),m(n,{key:7,label:"\u8BFB\u5199\u7C7B\u578B",prop:"property.accessMode"},{default:u(()=>[r(d,{modelValue:e(l).accessMode,"onUpdate:modelValue":t[6]||(t[6]=a=>e(l).accessMode=a)},{default:u(()=>[(o(!0),f(T,null,O(Object.values(e(q)),a=>(o(),m(p,{key:a.value,label:a.value},{default:u(()=>[V(R(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}))],64)}}}),[["__scopeId","data-v-b662b380"]]),ve=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));export{B as T,J as _,fe as a,ve as b};
