import{u as E,d as O,_ as W,c as X}from"./index-D_TWD7wt.js";import{_ as Y}from"./Dialog.vue_vue_type_style_index_0_lang-CJT4CHEp.js";import{_ as $}from"./ContentWrap.vue_vue_type_script_setup_true_lang-4_WNC8um.js";import{l as ee,r,j as ae,Q as le,aa as oe,ag as te,m as S,q as d,J as a,B as l,x as g,A as h,u as o,N as se,Z as re,C as B,G as u,h as I,I as me}from"./form-create-_84fGzaM.js";import{V as ne}from"./vuedraggable.umd-DWjAtm99.js";import{C as U}from"./index-CViVmH8f.js";import{a as ie}from"./index-BLgxU3BI.js";import{_ as de}from"./CategoryForm.vue_vue_type_script_setup_true_lang-CmY_nmiC.js";import ue from"./CategoryDraggableModel-Rr94RQLp.js";import{h as pe,aj as ce,k as fe,f as ye,a2 as _e,a3 as xe,a4 as ve,V as ge,ak as he,K as j}from"./form-designer-DHHJWkD5.js";import"./constants-C3gLHYOK.js";import"./el-collapse-transition-l0sNRNKZ.js";import"./DictTag.vue_vue_type_script_lang-BD_Qe0UA.js";import"./formatTime-BGPGB_ys.js";import"./index-DtDcjRGr.js";import"./formCreate-BIGK0pmc.js";import"./permission-DVPfzAr0.js";const Ce={class:"flex justify-between pl-20px items-center"},be={key:1,class:"mr-20px"},ke={class:"px-15px"},we=X(ee({name:"BpmModel",__name:"index",setup(Ve){const{push:A}=E(),q=O(),y=r(!0),n=r(!1),p=ae({name:void 0}),z=r(),m=r([]),C=r([]),F=()=>{i()},_=r(!1),b=r({rule:[],option:{}}),k=r(),K=()=>{k.value.open("create")},L=()=>{C.value=j(m.value),n.value=!0},M=()=>{m.value=j(C.value),n.value=!1},N=async()=>{const c=m.value.map(e=>e.id);await U.updateCategorySortBatch(c),n.value=!1,q.success("\u6392\u5E8F\u5206\u7C7B\u6210\u529F"),await i()},i=async()=>{y.value=!0;try{const c=await ie(p.name),e=await U.getCategorySimpleList();m.value=e.map(s=>({...s,modelList:c.filter(x=>x.categoryName==s.name)}))}finally{y.value=!1}};return le(()=>{i()}),(c,e)=>{const s=W,x=fe,v=ce,f=ye,w=ve,R=xe,T=_e,G=pe,H=ge,V=$,J=oe("form-create"),P=Y,Q=te("hasPermi"),Z=he;return d(),S(me,null,[a(V,null,{default:l(()=>[g("div",Ce,[e[11]||(e[11]=g("h3",{class:"font-extrabold"},"\u6D41\u7A0B\u6A21\u578B",-1)),o(n)?(d(),S("div",be,[a(f,{onClick:M},{default:l(()=>e[9]||(e[9]=[u(" \u53D6 \u6D88 ")])),_:1}),a(f,{type:"primary",onClick:N},{default:l(()=>e[10]||(e[10]=[u(" \u4FDD\u5B58\u6392\u5E8F ")])),_:1})])):(d(),h(G,{key:0,class:"-mb-15px flex mr-10px",model:o(p),ref_key:"queryFormRef",ref:z,inline:!0,"label-width":"68px",onSubmit:e[3]||(e[3]=se(()=>{},["prevent"]))},{default:l(()=>[a(v,{prop:"name",class:"ml-auto"},{default:l(()=>[a(x,{modelValue:o(p).name,"onUpdate:modelValue":e[0]||(e[0]=t=>o(p).name=t),placeholder:"\u641C\u7D22\u6D41\u7A0B",clearable:"",onKeyup:re(F,["enter"]),class:"!w-240px"},{prefix:l(()=>[a(s,{icon:"ep:search",class:"mx-10px"})]),_:1},8,["modelValue"])]),_:1}),a(v,null,{default:l(()=>[B((d(),h(f,{type:"primary",onClick:e[1]||(e[1]=t=>{A({name:"BpmModelCreate"})})},{default:l(()=>[a(s,{icon:"ep:plus",class:"mr-5px"}),e[6]||(e[6]=u(" \u65B0\u5EFA\u6A21\u578B "))]),_:1})),[[Q,["bpm:model:create"]]])]),_:1}),a(v,null,{default:l(()=>[a(T,{onCommand:e[2]||(e[2]=t=>(D=>{switch(D){case"handleCategoryAdd":K();break;case"handleCategorySort":L()}})(t)),placement:"bottom-end"},{dropdown:l(()=>[a(R,null,{default:l(()=>[a(w,{command:"handleCategoryAdd"},{default:l(()=>[a(s,{icon:"ep:circle-plus",size:13,class:"mr-5px"}),e[7]||(e[7]=u(" \u65B0\u5EFA\u5206\u7C7B "))]),_:1}),a(w,{command:"handleCategorySort"},{default:l(()=>[a(s,{icon:"fa:sort-amount-desc",size:13,class:"mr-5px"}),e[8]||(e[8]=u(" \u5206\u7C7B\u6392\u5E8F "))]),_:1})]),_:1})]),default:l(()=>[a(f,{class:"w-30px",plain:""},{default:l(()=>[a(s,{icon:"ep:setting"})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]))]),a(H),g("div",ke,[a(o(ne),{disabled:!o(n),modelValue:o(m),"onUpdate:modelValue":e[4]||(e[4]=t=>I(m)?m.value=t:null),"item-key":"id",animation:400},{item:l(({element:t})=>[B((d(),h(V,{class:"rounded-lg transition-all duration-300 ease-in-out hover:shadow-xl","body-style":{padding:0},key:t.id},{default:l(()=>[a(ue,{isCategorySorting:o(n),categoryInfo:t,onSuccess:i},null,8,["isCategorySorting","categoryInfo"])]),_:2},1024)),[[Z,o(y)]])]),_:1},8,["disabled","modelValue"])])]),_:1}),a(de,{ref_key:"categoryFormRef",ref:k,onSuccess:i},null,512),a(P,{title:"\u8868\u5355\u8BE6\u60C5",modelValue:o(_),"onUpdate:modelValue":e[5]||(e[5]=t=>I(_)?_.value=t:null),width:"800"},{default:l(()=>[a(J,{rule:o(b).rule,option:o(b).option},null,8,["rule","option"])]),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-13d41771"]]);export{we as default};
