import{_ as S}from"./Dialog.vue_vue_type_style_index_0_lang-C4PMlRRW.js";import{d as j,_ as q,M as G,aH as H}from"./index-DmQdxAiK.js";import{i as J}from"./index-oJNTIjFE.js";import{d as D}from"./download-oWiM5xVU.js";import{z as K,w as L,P as M,f as O}from"./form-designer-DHHJWkD5.js";import{l as P,r as i,A as R,q as E,B as l,J as d,u as r,h as x,x as f,G as v,n as N}from"./form-create-_84fGzaM.js";const Q={class:"el-upload__tip text-center"},T={class:"el-upload__tip"},W=P({name:"SystemUserImportForm",__name:"UserImportForm",emits:["success"],setup(X,{expose:b,emit:g}){const m=j(),o=i(!1),n=i(!1),_=i(),y=i(),p=i([]),c=i(0);b({open:()=>{o.value=!0,c.value=0,p.value=[],U()}});const V=async()=>{p.value.length!=0?(y.value={Authorization:"Bearer "+H(),"tenant-id":G()},n.value=!0,_.value.submit()):m.error("\u8BF7\u4E0A\u4F20\u6587\u4EF6")},k=g,w=a=>{if(a.code!==0)return m.error(a.msg),void U();const e=a.data;let s="\u4E0A\u4F20\u6210\u529F\u6570\u91CF\uFF1A"+e.createUsernames.length+";";for(let t of e.createUsernames)s+="< "+t+" >";s+="\u66F4\u65B0\u6210\u529F\u6570\u91CF\uFF1A"+e.updateUsernames.length+";";for(const t of e.updateUsernames)s+="< "+t+" >";s+="\u66F4\u65B0\u5931\u8D25\u6570\u91CF\uFF1A"+Object.keys(e.failureUsernames).length+";";for(const t in e.failureUsernames)s+="< "+t+": "+e.failureUsernames[t]+" >";m.alert(s),n.value=!1,o.value=!1,k("success")},z=()=>{m.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01"),n.value=!1},U=async()=>{var a;n.value=!1,await N(),(a=_.value)==null||a.clearFiles()},C=()=>{m.error("\u6700\u591A\u53EA\u80FD\u4E0A\u4F20\u4E00\u4E2A\u6587\u4EF6\uFF01")},F=async()=>{const a=await J();D.excel(a,"\u7528\u6237\u5BFC\u5165\u6A21\u7248.xls")};return(a,e)=>{const s=q,t=L,A=M,B=K,h=O,I=S;return E(),R(I,{modelValue:r(o),"onUpdate:modelValue":e[3]||(e[3]=u=>x(o)?o.value=u:null),title:"\u7528\u6237\u5BFC\u5165",width:"400"},{footer:l(()=>[d(h,{disabled:r(n),type:"primary",onClick:V},{default:l(()=>e[8]||(e[8]=[v("\u786E \u5B9A")])),_:1},8,["disabled"]),d(h,{onClick:e[2]||(e[2]=u=>o.value=!1)},{default:l(()=>e[9]||(e[9]=[v("\u53D6 \u6D88")])),_:1})]),default:l(()=>[d(B,{ref_key:"uploadRef",ref:_,"file-list":r(p),"onUpdate:fileList":e[1]||(e[1]=u=>x(p)?p.value=u:null),action:"http://47.105.43.107:48080/admin-api/system/user/import?updateSupport="+r(c),"auto-upload":!1,disabled:r(n),headers:r(y),limit:1,"on-error":z,"on-exceed":C,"on-success":w,accept:".xlsx, .xls",drag:""},{tip:l(()=>[f("div",Q,[f("div",T,[d(t,{modelValue:r(c),"onUpdate:modelValue":e[0]||(e[0]=u=>x(c)?c.value=u:null)},null,8,["modelValue"]),e[4]||(e[4]=v(" \u662F\u5426\u66F4\u65B0\u5DF2\u7ECF\u5B58\u5728\u7684\u7528\u6237\u6570\u636E "))]),e[6]||(e[6]=f("span",null,"\u4EC5\u5141\u8BB8\u5BFC\u5165 xls\u3001xlsx \u683C\u5F0F\u6587\u4EF6\u3002",-1)),d(A,{underline:!1,style:{"font-size":"12px","vertical-align":"baseline"},type:"primary",onClick:F},{default:l(()=>e[5]||(e[5]=[v(" \u4E0B\u8F7D\u6A21\u677F ")])),_:1})])]),default:l(()=>[d(s,{icon:"ep:upload"}),e[7]||(e[7]=f("div",{class:"el-upload__text"},[v("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),f("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1))]),_:1},8,["file-list","action","disabled","headers"])]),_:1},8,["modelValue"])}}});export{W as _};
