import{D as p,I as g,N as D,aN as b,aL as C}from"./index-DmQdxAiK.js";import{_ as L}from"./DictTag.vue_vue_type_script_lang-DiMRMEpR.js";import{_ as E}from"./Echart.vue_vue_type_script_setup_true_lang-CIKsMbIq.js";import{S as N}from"./portrait-CFsP0eeL.js";import{ad as O,i as W,j,ag as q,ak as A,_ as Y,Z as z}from"./form-designer-DHHJWkD5.js";import{l as k,r as _,j as y,e as B,m as J,q as w,I as Z,J as e,B as o,u as r,C as F,A as G}from"./form-create-_84fGzaM.js";const H=k({name:"PortraitCustomerIndustry",__name:"PortraitCustomerIndustry",props:{queryParams:{}},setup(v,{expose:I}){const R=v,l=_(!1),f=_([]),n=y({title:{text:"\u5168\u90E8\u5BA2\u6237",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},toolbox:{feature:{saveAsImage:{show:!0,name:"\u5168\u90E8\u5BA2\u6237"}}},series:[{name:"\u5168\u90E8\u5BA2\u6237",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:[]}]}),d=y({title:{text:"\u6210\u4EA4\u5BA2\u6237",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},toolbox:{feature:{saveAsImage:{show:!0,name:"\u6210\u4EA4\u5BA2\u6237"}}},series:[{name:"\u6210\u4EA4\u5BA2\u6237",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:[]}]}),h=async()=>{l.value=!0;const s=await N.getCustomerIndustry(R.queryParams);n.series&&n.series[0]&&n.series[0].data&&(n.series[0].data=s.map(a=>({name:g(p.CRM_CUSTOMER_INDUSTRY,a.industryId),value:a.customerCount}))),d.series&&d.series[0]&&d.series[0].data&&(d.series[0].data=s.map(a=>({name:g(p.CRM_CUSTOMER_INDUSTRY,a.industryId),value:a.dealCount}))),S(s),f.value=s,l.value=!1};I({loadData:h});const S=s=>{if(D(s))return;const a=s,u=b(a.map(t=>t.customerCount)),m=b(a.map(t=>t.dealCount));a.forEach(t=>{t.industryPortion=t.customerCount===0?0:C(t.customerCount,u),t.dealPortion=t.dealCount===0?0:C(t.dealCount,m)})};return B(()=>{h()}),(s,a)=>{const u=E,m=q,t=j,x=W,c=O,i=Y,P=L,M=z,T=A;return w(),J(Z,null,[e(c,{shadow:"never"},{default:o(()=>[e(x,{gutter:20},{default:o(()=>[e(t,{span:12},{default:o(()=>[e(m,{loading:r(l),animated:""},{default:o(()=>[e(u,{height:500,options:r(n)},null,8,["options"])]),_:1},8,["loading"])]),_:1}),e(t,{span:12},{default:o(()=>[e(m,{loading:r(l),animated:""},{default:o(()=>[e(u,{height:500,options:r(d)},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),e(c,{class:"mt-16px",shadow:"never"},{default:o(()=>[F((w(),G(M,{data:r(f)},{default:o(()=>[e(i,{align:"center",label:"\u5E8F\u53F7",type:"index",width:"80"}),e(i,{align:"center",label:"\u5BA2\u6237\u884C\u4E1A",prop:"industryId",width:"100"},{default:o(U=>[e(P,{type:r(p).CRM_CUSTOMER_INDUSTRY,value:U.row.industryId},null,8,["type","value"])]),_:1}),e(i,{align:"center",label:"\u5BA2\u6237\u4E2A\u6570","min-width":"200",prop:"customerCount"}),e(i,{align:"center",label:"\u6210\u4EA4\u4E2A\u6570","min-width":"200",prop:"dealCount"}),e(i,{align:"center",label:"\u884C\u4E1A\u5360\u6BD4(%)","min-width":"200",prop:"industryPortion"}),e(i,{align:"center",label:"\u6210\u4EA4\u5360\u6BD4(%)","min-width":"200",prop:"dealPortion"})]),_:1},8,["data"])),[[T,r(l)]])]),_:1})],64)}}});export{H as _};
