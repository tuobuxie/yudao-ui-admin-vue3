import{d as A,a as B,_ as D,ay as G}from"./index-DzK2S43K.js";import{_ as J}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BYZVL11n.js";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-Cvlg2yMl.js";import{g as W,d as Z}from"./index-B3YA61De.js";import{_ as E}from"./ReceivablePlanForm.vue_vue_type_script_setup_true_lang-Cx6ojFJ7.js";import{b as x}from"./formatTime-BGPGB_ys.js";import{i as H,f as K,ak as M,_ as O,Z as Q}from"./form-designer-DHHJWkD5.js";import{l as V,r as u,j as X,b as Y,ag as $,m as ee,q as s,I as ae,J as a,B as c,G as f,C as g,u as l,A as b}from"./form-create-_84fGzaM.js";const te=V({name:"CrmReceivablePlanList",__name:"ReceivablePlanList",props:{customerId:{},contractId:{}},emits:["createReceivable"],setup(N,{emit:S}){const t=N,w=A(),{t:P}=B(),v=u(!0),_=u(0),k=u([]),r=X({pageNo:1,pageSize:10,customerId:void 0,contractId:void 0}),d=async()=>{v.value=!0;try{t.customerId&&!t.contractId?r.customerId=t.customerId:t.customerId&&t.contractId&&(r.customerId=t.customerId,r.contractId=t.contractId);const n=await W(r);k.value=n.list,_.value=n.total}finally{v.value=!1}},y=u(),h=(n,e)=>{y.value.open(n,e,t.customerId,t.contractId)},R=S;return Y(()=>[t.customerId,t.contractId],n=>{n[0]&&(r.pageNo=1,r.customerId=void 0,r.contractId=void 0,d())},{immediate:!0,deep:!0}),(n,e)=>{const z=D,m=K,U=H,o=O,j=Q,L=F,T=J,I=$("hasPermi"),q=M;return s(),ee(ae,null,[a(U,{justify:"end"},{default:c(()=>[a(m,{onClick:e[0]||(e[0]=i=>h("create",void 0))},{default:c(()=>[a(z,{class:"mr-5px",icon:"icon-park:income"}),e[3]||(e[3]=f(" \u521B\u5EFA\u56DE\u6B3E\u8BA1\u5212 "))]),_:1})]),_:1}),a(T,{class:"mt-10px"},{default:c(()=>[g((s(),b(j,{data:l(k),"show-overflow-tooltip":!0,stripe:!0},{default:c(()=>[a(o,{align:"center",label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName",width:"150px"}),a(o,{align:"center",label:"\u5408\u540C\u7F16\u53F7",prop:"contractNo",width:"200px"}),a(o,{align:"center",label:"\u671F\u6570",prop:"period"}),a(o,{align:"center",label:"\u8BA1\u5212\u56DE\u6B3E(\u5143)",prop:"price",width:"120",formatter:l(G)},null,8,["formatter"]),a(o,{formatter:l(x),align:"center",label:"\u8BA1\u5212\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"180px"},null,8,["formatter"]),a(o,{align:"center",label:"\u63D0\u524D\u51E0\u5929\u63D0\u9192",prop:"remindDays",width:"150"}),a(o,{formatter:l(x),align:"center",label:"\u63D0\u9192\u65E5\u671F",prop:"remindTime",width:"180px"},null,8,["formatter"]),a(o,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"120"}),a(o,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(o,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"200px"},{default:c(i=>[g((s(),b(m,{link:"",type:"primary",onClick:C=>{return p=i.row,void R("createReceivable",p);var p},disabled:i.row.receivableId},{default:c(()=>e[4]||(e[4]=[f(" \u521B\u5EFA\u56DE\u6B3E ")])),_:2},1032,["onClick","disabled"])),[[I,["crm:receivable:create"]]]),g((s(),b(m,{link:"",type:"primary",onClick:C=>h("update",i.row.id)},{default:c(()=>e[5]||(e[5]=[f(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[I,["crm:receivable-plan:update"]]]),g((s(),b(m,{link:"",type:"danger",onClick:C=>(async p=>{try{await w.delConfirm(),await Z(p),w.success(P("common.delSuccess")),await d()}catch{}})(i.row.id)},{default:c(()=>e[6]||(e[6]=[f(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[I,["crm:receivable-plan:delete"]]])]),_:1})]),_:1},8,["data"])),[[q,l(v)]]),a(L,{limit:l(r).pageSize,"onUpdate:limit":e[1]||(e[1]=i=>l(r).pageSize=i),page:l(r).pageNo,"onUpdate:page":e[2]||(e[2]=i=>l(r).pageNo=i),total:l(_),onPagination:d},null,8,["limit","page","total"])]),_:1}),a(E,{ref_key:"formRef",ref:y,onSuccess:d},null,512)],64)}}});export{te as _};
