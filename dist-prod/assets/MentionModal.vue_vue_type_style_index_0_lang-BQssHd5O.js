import{l as C,r as a,c as x,i as U,e as _,m as d,q as u,O,u as o,C as R,x as h,a8 as T,h as $,I as w,$ as E,H as L}from"./form-create-_84fGzaM.js";const N={id:"mention-list"},S=["onClick"],b=C({__name:"MentionModal",emits:["hideMentionModal","insertMention"],setup(j,{emit:k}){const l=k,r=a(),p=a(""),c=a(""),i=a(""),f=a([{id:"startUser",name:"\u53D1\u8D77\u4EBA"},{id:"startUserDept",name:"\u53D1\u8D77\u4EBA\u90E8\u95E8"},{id:"processName",name:"\u6D41\u7A0B\u540D\u79F0"},{id:"processNum",name:"\u6D41\u7A0B\u7F16\u53F7"},{id:"startTime",name:"\u53D1\u8D77\u65F6\u95F4"},{id:"endTime",name:"\u7ED3\u675F\u65F6\u95F4"},{id:"processStatus",name:"\u6D41\u7A0B\u72B6\u6001"},{id:"printUser",name:"\u6253\u5370\u4EBA"},{id:"printTime",name:"\u6253\u5370\u65F6\u95F4"}]),v=x(()=>{const n=i.value.trim().toLowerCase();return f.value.filter(e=>e.name.toLowerCase().indexOf(n)>=0)}),y=n=>{if(n.key==="Escape"&&l("hideMentionModal"),n.key==="Enter"){const e=v.value[0];if(e){const{id:t,name:s}=e;M(t,s)}}},M=(n,e)=>{l("insertMention",n,e),l("hideMentionModal")},m=U("formFieldsObj");return _(()=>{if(m.value&&m.value.length>0){const s=m.value.map(g=>({name:"[\u8868\u5355]"+g.title,id:g.field}));f.value.push(...s)}const n=document.getSelection(),e=n==null?void 0:n.getRangeAt(0);if(e==null)return;const t=e.getBoundingClientRect();p.value=`${t.top+20}px`,c.value=`${t.left+5}px`,r.value.focus()}),(n,e)=>(u(),d("div",{id:"mention-modal",style:O({top:o(p),left:o(c)})},[R(h("input",{id:"mention-input","onUpdate:modelValue":e[0]||(e[0]=t=>$(i)?i.value=t:null),ref_key:"inputRef",ref:r,onKeyup:y},null,544),[[T,o(i)]]),h("ul",N,[(u(!0),d(w,null,E(o(v),t=>(u(),d("li",{key:t.id,onClick:s=>M(t.id,t.name)},L(t.name),9,S))),128))])],4))}});export{b as _};
