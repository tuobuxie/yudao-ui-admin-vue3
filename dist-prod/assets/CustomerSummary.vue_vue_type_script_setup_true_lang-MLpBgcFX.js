import{aL as m,ay as h}from"./index-B2urM1q-.js";import{_ as I}from"./Echart.vue_vue_type_script_setup_true_lang-DN874Bqe.js";import{S as f}from"./customer-BzI0mtJU.js";import{ad as S,ag as D,ak as q,_ as B,Z as L}from"./form-designer-DHHJWkD5.js";import{l as j,r as w,j as U,e as Z,m as k,q as b,I as G,J as a,B as o,u as r,C as H,A as J,G as d,H as u}from"./form-create-_84fGzaM.js";const N=j({name:"CustomerSummary",__name:"CustomerSummary",props:{queryParams:{}},setup(C,{expose:v}){const p=C,l=w(!1),c=w([]),e=U({grid:{left:20,right:30,bottom:20,containLabel:!0},legend:{},series:[{name:"\u65B0\u589E\u5BA2\u6237\u6570",type:"bar",yAxisIndex:0,data:[]},{name:"\u6210\u4EA4\u5BA2\u6237\u6570",type:"bar",yAxisIndex:1,data:[]}],toolbox:{feature:{dataZoom:{xAxisIndex:!1},brush:{type:["lineX","clear"]},saveAsImage:{show:!0,name:"\u5BA2\u6237\u603B\u91CF\u5206\u6790"}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},yAxis:[{type:"value",name:"\u65B0\u589E\u5BA2\u6237\u6570",min:0,minInterval:1},{type:"value",name:"\u6210\u4EA4\u5BA2\u6237\u6570",min:0,minInterval:1,splitLine:{lineStyle:{type:"dotted",opacity:.7}}}],xAxis:{type:"category",name:"\u65E5\u671F",data:[]}}),g=async()=>{l.value=!0;try{await(async()=>{const n=await f.getCustomerSummaryByDate(p.queryParams),y=await f.getCustomerSummaryByUser(p.queryParams);e.xAxis&&e.xAxis.data&&(e.xAxis.data=n.map(s=>s.time)),e.series&&e.series[0]&&e.series[0].data&&(e.series[0].data=n.map(s=>s.customerCreateCount)),e.series&&e.series[1]&&e.series[1].data&&(e.series[1].data=n.map(s=>s.customerDealCount)),c.value=y})()}finally{l.value=!1}};return v({loadData:g}),Z(()=>{g()}),(n,y)=>{const s=I,_=D,x=S,t=B,A=L,P=q;return b(),k(G,null,[a(x,{shadow:"never"},{default:o(()=>[a(_,{loading:r(l),animated:""},{default:o(()=>[a(s,{height:500,options:r(e)},null,8,["options"])]),_:1},8,["loading"])]),_:1}),a(x,{shadow:"never",class:"mt-16px"},{default:o(()=>[H((b(),J(A,{data:r(c)},{default:o(()=>[a(t,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80",fixed:"left"}),a(t,{label:"\u5458\u5DE5\u59D3\u540D",prop:"ownerUserName","min-width":"100",fixed:"left"}),a(t,{label:"\u65B0\u589E\u5BA2\u6237\u6570",align:"right",prop:"customerCreateCount","min-width":"200"}),a(t,{label:"\u6210\u4EA4\u5BA2\u6237\u6570",align:"right",prop:"customerDealCount","min-width":"200"}),a(t,{label:"\u5BA2\u6237\u6210\u4EA4\u7387(%)",align:"right","min-width":"200"},{default:o(i=>[d(u(r(m)(i.row.customerDealCount,i.row.customerCreateCount)),1)]),_:1}),a(t,{label:"\u5408\u540C\u603B\u91D1\u989D",align:"right",prop:"contractPrice","min-width":"200",formatter:r(h)},null,8,["formatter"]),a(t,{label:"\u56DE\u6B3E\u91D1\u989D",align:"right",prop:"receivablePrice","min-width":"200",formatter:r(h)},null,8,["formatter"]),a(t,{label:"\u672A\u56DE\u6B3E\u91D1\u989D",align:"right","min-width":"200"},{default:o(i=>[d(u(r(m)(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1}),a(t,{label:"\u56DE\u6B3E\u5B8C\u6210\u7387(%)",align:"right","min-width":"200",fixed:"right"},{default:o(i=>[d(u(r(m)(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1})]),_:1},8,["data"])),[[P,r(l)]])]),_:1})],64)}}});export{N as _};
