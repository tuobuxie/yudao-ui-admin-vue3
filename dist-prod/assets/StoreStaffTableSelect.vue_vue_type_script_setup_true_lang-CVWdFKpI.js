import{h as ee,D as F,_ as ae}from"./index-B2urM1q-.js";import{_ as le}from"./Dialog.vue_vue_type_style_index_0_lang-bMayE4GC.js";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang-Cj0jlW8o.js";import{_ as oe}from"./DictTag.vue_vue_type_script_lang-wg8pUI-B.js";import{_ as ue}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BRGqERh7.js";import{l as de,r as s,j as se,A as U,q as w,B as o,J as a,u as t,Z as O,m as re,I as ie,$ as pe,G as y,C as me,h as Y}from"./form-create-_84fGzaM.js";import{d as ne}from"./formatTime-BGPGB_ys.js";import{a as fe}from"./index-Bix5n4IG.js";import{_ as ce}from"./DeptTree.vue_vue_type_script_setup_true_lang-CETEwfWC.js";import{i as ve,j as _e,h as he,aj as be,k as ge,x as Ve,Q as we,F as ye,f as ke,Z as xe,_ as Ue,w as Ce,ak as Se}from"./form-designer-DHHJWkD5.js";const Te=de({__name:"StoreStaffTableSelect",emits:["change"],setup(Ne,{expose:j,emit:z}){const i=s(!1),k=s(!1),h=s([]),p=s({}),m=s(!1),n=s(!0),C=s(0),f=s([]),d=se({pageNo:1,pageSize:10,username:void 0,mobile:void 0,status:void 0,deptId:void 0,roleId:void 0,createTime:[]}),S=s(),b=async()=>{n.value=!0;try{const u=await fe(d);f.value=u.list,C.value=u.total}finally{n.value=!1}},g=()=>{d.pageNo=1,b()},A=()=>{var u;(u=S.value)==null||u.resetFields(),g()},D=async u=>{d.deptId=u.id,await b()};j({open:async()=>{m.value=!0,n.value=!0;try{await b()}finally{n.value=!1}}});const q=u=>{i.value=u,k.value=!1,f.value.forEach(e=>T(u,e,!1))},T=(u,e,c)=>{if(u)h.value.push(e),p.value[e.id]=!0;else{const v=H(e);v>-1&&(h.value.splice(v,1),p.value[e.id]=!1,i.value=!1)}c&&J()},H=u=>h.value.findIndex(e=>e.id===u.id),J=()=>{i.value=f.value.every(u=>p.value[u.id]),k.value=!i.value&&f.value.some(u=>p.value[u.id])},K=()=>{m.value=!1,Z("change",[...h.value])},Z=z;return(u,e)=>{const c=ue,v=_e,N=ge,_=be,B=we,E=Ve,G=ye,M=ae,V=ke,P=he,I=Ce,r=Ue,Q=oe,R=xe,$=te,L=ve,W=le,X=Se;return w(),U(W,{title:"\u9009\u62E9\u5E97\u5458",modelValue:t(m),"onUpdate:modelValue":e[8]||(e[8]=l=>Y(m)?m.value=l:null),width:"60%"},{footer:o(()=>[a(V,{type:"primary",onClick:K},{default:o(()=>e[11]||(e[11]=[y("\u786E \u5B9A")])),_:1}),a(V,{onClick:e[7]||(e[7]=l=>m.value=!1)},{default:o(()=>e[12]||(e[12]=[y("\u53D6 \u6D88")])),_:1})]),default:o(()=>[a(L,{gutter:20},{default:o(()=>[a(v,{span:4,xs:24},{default:o(()=>[a(c,{class:"h-1/1"},{default:o(()=>[a(ce,{onNodeClick:D})]),_:1})]),_:1}),a(v,{span:20,xs:24},{default:o(()=>[a(c,null,{default:o(()=>[a(P,{class:"-mb-15px",model:t(d),ref_key:"queryFormRef",ref:S,inline:!0,"label-width":"68px"},{default:o(()=>[a(_,{label:"\u7528\u6237\u540D\u79F0",prop:"username"},{default:o(()=>[a(N,{modelValue:t(d).username,"onUpdate:modelValue":e[0]||(e[0]=l=>t(d).username=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",clearable:"",onKeyup:O(g,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(_,{label:"\u624B\u673A\u53F7\u7801",prop:"mobile"},{default:o(()=>[a(N,{modelValue:t(d).mobile,"onUpdate:modelValue":e[1]||(e[1]=l=>t(d).mobile=l),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",clearable:"",onKeyup:O(g,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(_,{label:"\u72B6\u6001",prop:"status"},{default:o(()=>[a(E,{modelValue:t(d).status,"onUpdate:modelValue":e[2]||(e[2]=l=>t(d).status=l),placeholder:"\u7528\u6237\u72B6\u6001",clearable:"",class:"!w-240px"},{default:o(()=>[(w(!0),re(ie,null,pe(t(ee)(t(F).COMMON_STATUS),l=>(w(),U(B,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:o(()=>[a(G,{modelValue:t(d).createTime,"onUpdate:modelValue":e[3]||(e[3]=l=>t(d).createTime=l),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(_,null,{default:o(()=>[a(V,{onClick:g},{default:o(()=>[a(M,{icon:"ep:search"}),e[9]||(e[9]=y("\u641C\u7D22"))]),_:1}),a(V,{onClick:A},{default:o(()=>[a(M,{icon:"ep:refresh"}),e[10]||(e[10]=y("\u91CD\u7F6E"))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(c,null,{default:o(()=>[me((w(),U(R,{data:t(f)},{default:o(()=>[a(r,{width:"55"},{header:o(()=>[a(I,{modelValue:t(i),"onUpdate:modelValue":e[4]||(e[4]=l=>Y(i)?i.value=l:null),indeterminate:t(k),onChange:q},null,8,["modelValue","indeterminate"])]),default:o(({row:l})=>[a(I,{modelValue:t(p)[l.id],"onUpdate:modelValue":x=>t(p)[l.id]=x,onChange:x=>T(x,l,!0)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(r,{label:"\u7528\u6237\u7F16\u53F7",align:"center",key:"id",prop:"id"}),a(r,{label:"\u7528\u6237\u540D\u79F0",align:"center",prop:"username","show-overflow-tooltip":!0}),a(r,{label:"\u7528\u6237\u6635\u79F0",align:"center",prop:"nickname","show-overflow-tooltip":!0}),a(r,{label:"\u90E8\u95E8",align:"center",key:"deptName",prop:"deptName","show-overflow-tooltip":!0}),a(r,{label:"\u624B\u673A\u53F7\u7801",align:"center",prop:"mobile",width:"120"}),a(r,{label:"\u72B6\u6001",key:"status"},{default:o(l=>[a(Q,{type:t(F).COMMON_STATUS,value:l.row.status},null,8,["type","value"])]),_:1}),a(r,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:t(ne),width:"180"},null,8,["formatter"])]),_:1},8,["data"])),[[X,t(n)]]),a($,{total:t(C),page:t(d).pageNo,"onUpdate:page":e[5]||(e[5]=l=>t(d).pageNo=l),limit:t(d).pageSize,"onUpdate:limit":e[6]||(e[6]=l=>t(d).pageSize=l),onPagination:b},null,8,["total","page","limit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{Te as _};
