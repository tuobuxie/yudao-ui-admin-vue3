import{p as _,S as K,_ as L,c as N}from"./index-DzK2S43K.js";import{l as P,r as k,b as H,m as r,q as n,x as J,I as V,$,O,D as Q,J as R,u as M,E as B,H as T}from"./form-create-_84fGzaM.js";const F=(s,x)=>{const[l,o]=[s.x,x.x].sort(),[a,v]=[s.y,x.y].sort(),p=o+1,f=v+1;return{left:l,right:p,top:a,bottom:f,height:f-a,width:p-l}},U={class:"relative"},W={class:"cube-table"},X=["onClick","onMouseenter"],Y=["onClick"],Z=["onClick"],ee={key:1},te=N(P({name:"MagicCubeEditor",__name:"index",props:{modelValue:K().isRequired,rows:_.number.def(4),cols:_.number.def(4),cubeSize:_.number.def(75)},emits:["update:modelValue","hotAreaSelected"],setup(s,{emit:x}){const l=s,o=k([]);H(()=>[l.rows,l.cols],()=>{if(o.value=[],l.rows&&l.cols)for(let i=0;i<l.rows;i++){o.value[i]=[];for(let e=0;e<l.cols;e++)o.value[i].push({x:e,y:i,active:!1})}},{immediate:!0});const a=k([]);H(()=>l.modelValue,()=>a.value=l.modelValue||[],{immediate:!0});const v=k(),p=()=>!!v.value,f=x,q=()=>f("update:modelValue",a),A=k(0),E=(i,e)=>{A.value=e,f("hotAreaSelected",i,e)};function w(){I((i,e,u)=>{u.active&&(u.active=!1)}),v.value=void 0}const I=i=>{for(let e=0;e<o.value.length;e++)for(let u=0;u<o.value[e].length;u++)i(e,u,o.value[e][u])};return(i,e)=>{const u=L;return n(),r("div",U,[J("table",W,[J("tbody",null,[(n(!0),r(V,null,$(M(o),(t,d)=>(n(),r("tr",{key:d},[(n(!0),r(V,null,$(t,(S,m)=>(n(),r("td",{key:m,class:Q(["cube",{active:S.active}]),style:O({width:`${s.cubeSize}px`,height:`${s.cubeSize}px`}),onClick:G=>((C,z)=>{const b=o.value[C][z];if(!p())return v.value=b,void(v.value.active=!0);a.value.push(F(v.value,b)),w();let c=a.value.length-1;E(a.value[c],c),q()})(d,m),onMouseenter:G=>((C,z)=>{if(!p())return;const b=F(v.value,o.value[C][z]);for(const j of a.value)if(h=b,(c=j).left<h.left+h.width&&c.left+c.width>h.left&&c.top<h.top+h.height&&c.height+c.top>h.top)return void w();var c,h;I((j,le,D)=>{var g,y;D.active=(g=b,(y=D).x>=g.left&&y.x<g.right&&y.y>=g.top&&y.y<g.bottom)})})(d,m)},[R(u,{icon:"ep-plus"})],46,X))),128))]))),128))]),(n(!0),r(V,null,$(M(a),(t,d)=>(n(),r("div",{key:d,class:"hot-area",style:O({top:s.cubeSize*t.top+"px",left:s.cubeSize*t.left+"px",height:s.cubeSize*t.height+"px",width:s.cubeSize*t.width+"px"}),onClick:S=>E(t,d),onMouseover:w},[M(A)===d&&t.width&&t.height?(n(),r("div",{key:0,class:"btn-delete",onClick:S=>(m=>{a.value.splice(m,1),w(),q()})(d)},[R(u,{icon:"ep:circle-close-filled"})],8,Z)):B("",!0),t.width?(n(),r("span",ee,T(`${t.width}\xD7${t.height}`),1)):B("",!0)],44,Y))),128))])])}}}),[["__scopeId","data-v-7f3716e7"]]);export{te as _};
