import{d as J,a as K,h as Q,D as S,_ as $}from"./index-DmQdxAiK.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-OyXbUoED.js";import{_ as X}from"./DictTag.vue_vue_type_script_lang-DiMRMEpR.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-OPDE9cVe.js";import{_ as ae}from"./index-C2x7yuaO.js";import{l as le,r as _,j as te,e as oe,ag as ie,m as D,q as r,J as a,B as t,u as o,Z as re,I as E,$ as ne,A as m,C as g,G as p}from"./form-create-_84fGzaM.js";import{_ as se,g as pe,d as ce,a as de,u as ue,t as me}from"./FileConfigForm.vue_vue_type_script_setup_true_lang-DmPzBRzq.js";import{d as fe}from"./formatTime-BGPGB_ys.js";import{h as _e,aj as ge,k as ye,x as we,Q as ke,F as be,f as he,Z as ve,_ as Ce,ak as xe}from"./form-designer-DHHJWkD5.js";import"./Dialog.vue_vue_type_style_index_0_lang-C4PMlRRW.js";const Se=le({name:"InfraFileConfig",__name:"index",setup(Fe){const c=J(),{t:h}=K(),v=_(!0),F=_(0),N=_([]),i=te({pageNo:1,pageSize:10,name:void 0,storage:void 0,createTime:[]}),T=_(),d=async()=>{v.value=!0;try{const u=await pe(i);N.value=u.list,F.value=u.total}finally{v.value=!1}},C=()=>{i.pageNo=1,d()},U=()=>{T.value.resetFields(),C()},V=_(),I=(u,e)=>{V.value.open(u,e)},w=_([]),G=u=>{w.value=u.map(e=>e.id)},O=async()=>{try{await c.delConfirm(),await de(w.value),w.value=[],c.success(h("common.delSuccess")),await d()}catch{}};return oe(()=>{d()}),(u,e)=>{const Y=ae,z=ye,k=ge,L=ke,P=we,j=be,b=$,n=he,q=_e,R=ee,s=Ce,A=X,B=ve,H=W,y=ie("hasPermi"),M=xe;return r(),D(E,null,[a(Y,{title:"\u4E0A\u4F20\u4E0B\u8F7D",url:"https://doc.iocoder.cn/file/"}),a(R,null,{default:t(()=>[a(q,{class:"-mb-15px",model:o(i),ref_key:"queryFormRef",ref:T,inline:!0,"label-width":"68px"},{default:t(()=>[a(k,{label:"\u914D\u7F6E\u540D",prop:"name"},{default:t(()=>[a(z,{modelValue:o(i).name,"onUpdate:modelValue":e[0]||(e[0]=l=>o(i).name=l),placeholder:"\u8BF7\u8F93\u5165\u914D\u7F6E\u540D",clearable:"",onKeyup:re(C,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(k,{label:"\u5B58\u50A8\u5668",prop:"storage"},{default:t(()=>[a(P,{modelValue:o(i).storage,"onUpdate:modelValue":e[1]||(e[1]=l=>o(i).storage=l),placeholder:"\u8BF7\u9009\u62E9\u5B58\u50A8\u5668",clearable:"",class:"!w-240px"},{default:t(()=>[(r(!0),D(E,null,ne(o(Q)(o(S).INFRA_FILE_STORAGE),l=>(r(),m(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(k,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:t(()=>[a(j,{modelValue:o(i).createTime,"onUpdate:modelValue":e[2]||(e[2]=l=>o(i).createTime=l),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),a(k,null,{default:t(()=>[a(n,{onClick:C},{default:t(()=>[a(b,{icon:"ep:search",class:"mr-5px"}),e[6]||(e[6]=p(" \u641C\u7D22"))]),_:1}),a(n,{onClick:U},{default:t(()=>[a(b,{icon:"ep:refresh",class:"mr-5px"}),e[7]||(e[7]=p(" \u91CD\u7F6E"))]),_:1}),g((r(),m(n,{type:"primary",plain:"",onClick:e[3]||(e[3]=l=>I("create"))},{default:t(()=>[a(b,{icon:"ep:plus",class:"mr-5px"}),e[8]||(e[8]=p(" \u65B0\u589E "))]),_:1})),[[y,["infra:file-config:create"]]]),g((r(),m(n,{type:"danger",plain:"",disabled:o(w).length===0,onClick:O},{default:t(()=>[a(b,{icon:"ep:delete",class:"mr-5px"}),e[9]||(e[9]=p(" \u6279\u91CF\u5220\u9664 "))]),_:1},8,["disabled"])),[[y,["infra:file-config:delete"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(R,null,{default:t(()=>[g((r(),m(B,{data:o(N),onSelectionChange:G},{default:t(()=>[a(s,{type:"selection",width:"55"}),a(s,{label:"\u7F16\u53F7",align:"center",prop:"id"}),a(s,{label:"\u914D\u7F6E\u540D",align:"center",prop:"name"}),a(s,{label:"\u5B58\u50A8\u5668",align:"center",prop:"storage"},{default:t(l=>[a(A,{type:o(S).INFRA_FILE_STORAGE,value:l.row.storage},null,8,["type","value"])]),_:1}),a(s,{label:"\u5907\u6CE8",align:"center",prop:"remark"}),a(s,{label:"\u4E3B\u914D\u7F6E",align:"center",prop:"primary"},{default:t(l=>[a(A,{type:o(S).INFRA_BOOLEAN_STRING,value:l.row.master},null,8,["type","value"])]),_:1}),a(s,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",width:"180",formatter:o(fe)},null,8,["formatter"]),a(s,{label:"\u64CD\u4F5C",align:"center",width:"240px"},{default:t(l=>[g((r(),m(n,{link:"",type:"primary",onClick:x=>I("update",l.row.id)},{default:t(()=>e[10]||(e[10]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[y,["infra:file-config:update"]]]),g((r(),m(n,{link:"",type:"primary",disabled:l.row.master,onClick:x=>(async f=>{try{await c.confirm('\u662F\u5426\u786E\u8BA4\u4FEE\u6539\u914D\u7F6E\u7F16\u53F7\u4E3A"'+f+'"\u7684\u6570\u636E\u9879\u4E3A\u4E3B\u914D\u7F6E?'),await ue(f),c.success(h("common.updateSuccess")),await d()}catch{}})(l.row.id)},{default:t(()=>e[11]||(e[11]=[p(" \u4E3B\u914D\u7F6E ")])),_:2},1032,["disabled","onClick"])),[[y,["infra:file-config:update"]]]),a(n,{link:"",type:"primary",onClick:x=>(async f=>{try{const Z=await me(f);await c.confirm("\u662F\u5426\u8981\u8BBF\u95EE\u8BE5\u6587\u4EF6\uFF1F","\u6D4B\u8BD5\u4E0A\u4F20\u6210\u529F"),window.open(Z,"_blank")}catch{}})(l.row.id)},{default:t(()=>e[12]||(e[12]=[p(" \u6D4B\u8BD5 ")])),_:2},1032,["onClick"]),g((r(),m(n,{link:"",type:"danger",onClick:x=>(async f=>{try{await c.delConfirm(),await ce(f),c.success(h("common.delSuccess")),await d()}catch{}})(l.row.id)},{default:t(()=>e[13]||(e[13]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[y,["infra:file-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[M,o(v)]]),a(H,{total:o(F),page:o(i).pageNo,"onUpdate:page":e[4]||(e[4]=l=>o(i).pageNo=l),limit:o(i).pageSize,"onUpdate:limit":e[5]||(e[5]=l=>o(i).pageSize=l),onPagination:d},null,8,["total","page","limit"])]),_:1}),a(se,{ref_key:"formRef",ref:V,onSuccess:d},null,512)],64)}}});export{Se as default};
