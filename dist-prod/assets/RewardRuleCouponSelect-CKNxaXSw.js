import{aE as S,D as C,N as m,c as E}from"./index-B2urM1q-.js";import{_ as N}from"./DictTag.vue_vue_type_script_lang-wg8pUI-B.js";import"./Dialog.vue_vue_type_style_index_0_lang-bMayE4GC.js";import"./index.vue_vue_type_script_setup_true_lang-Cj0jlW8o.js";import{e as P}from"./couponTemplate-Jfpb-5qV.js";import{d as b}from"./formatter-CEubQjfT.js";import{h as D}from"./constants-C3gLHYOK.js";import{_ as U}from"./CouponSelect.vue_vue_type_script_setup_true_lang-B8SfMeLz.js";import{f as j,k as M}from"./form-designer-DHHJWkD5.js";import{l as G,r as x,e as q,n as A,m as r,q as c,I as y,J as p,B as _,G as s,$ as B,u as i,x as n,H as g}from"./form-create-_84fGzaM.js";import"./formatTime-BGPGB_ys.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-BRGqERh7.js";const H={class:"coupon-list-item-left flex items-center flex-wrap"},J={class:"mr-10px"},L={class:"mr-10px"},Y={class:"flex items-center"},$={class:"coupon-list-item-right"},z=E(G({name:"RewardRuleCouponSelect",__name:"RewardRuleCouponSelect",props:{modelValue:{}},emits:["update:modelValue"],setup(T,{expose:k,emit:O}){const o=S(T,"modelValue",O),u=x([]),v=x(),h=()=>{var t;(t=v.value)==null||t.open()},w=t=>{for(const e of t)u.value.some(a=>a.id===e.id)||u.value.push(e)};return k({setGiveCouponList:()=>{m(o.value)||(o.value.giveCouponTemplateCounts={},u.value.forEach(t=>{o.value.giveCouponTemplateCounts[t.id]=t.giveCount}))}}),q(async()=>{await A(),await(async()=>{if(m(o.value)||m(o.value.giveCouponTemplateCounts))return;const t=Object.keys(o.value.giveCouponTemplateCounts),e=await P(t);e&&e.forEach(a=>{u.value.push({...a,giveCount:o.value.giveCouponTemplateCounts[a.id]})})})()}),(t,e)=>{const a=j,d=N,R=M;return c(),r(y,null,[p(a,{class:"ml-10px",type:"text",onClick:h},{default:_(()=>e[0]||(e[0]=[s("\u6DFB\u52A0\u4F18\u60E0\u52B5")])),_:1}),(c(!0),r(y,null,B(i(u),(l,V)=>(c(),r("div",{key:l.id,class:"coupon-list-item p-x-10px mb-10px flex justify-between"},[n("div",H,[n("div",J," \u4F18\u60E0\u5238\u540D\u79F0\uFF1A"+g(l.name),1),n("div",L,[e[1]||(e[1]=s(" \u8303\u56F4\uFF1A ")),p(d,{type:i(C).PROMOTION_PRODUCT_SCOPE,value:l.productScope},null,8,["type","value"])]),n("div",Y,[e[2]||(e[2]=s(" \u4F18\u60E0\uFF1A ")),p(d,{type:i(C).PROMOTION_DISCOUNT_TYPE,value:l.discountType},null,8,["type","value"]),s(" "+g(i(b)(l)),1)])]),n("div",$,[e[4]||(e[4]=s(" \u9001 ")),p(R,{modelValue:l.giveCount,"onUpdate:modelValue":f=>l.giveCount=f,class:"w-150px! p-x-20px!",placeholder:"",type:"number"},null,8,["modelValue","onUpdate:modelValue"]),e[5]||(e[5]=s(" \u5F20 ")),p(a,{class:"ml-20px",link:"",type:"danger",onClick:f=>(I=>{u.value.splice(I,1)})(V)},{default:_(()=>e[3]||(e[3]=[s("\u5220\u9664")])),_:2},1032,["onClick"])])]))),128)),p(i(U),{ref_key:"couponSelectRef",ref:v,"take-type":i(D).ADMIN.type,onChange:w},null,8,["take-type"])],64)}}}),[["__scopeId","data-v-6eaf3378"]]);export{z as default};
