import{d as A,F as E,L as B}from"./index-B2urM1q-.js";import{_ as D}from"./SkuList.vue_vue_type_style_index_0_lang-BO8c8HIo.js";import{_ as U,al as j,f as q,Z as z}from"./form-designer-DHHJWkD5.js";import{l as F,r as m,b as h,A as v,q as _,B as l,J as a,E as G,u as o,t as H,G as g,H as J}from"./form-create-_84fGzaM.js";const R=F({name:"PromotionSpuAndSkuList",__name:"SpuAndSkuList",props:{spuList:{},ruleConfig:{},spuPropertyListP:{},deletable:{type:Boolean}},emits:["delete"],setup(b,{expose:x,emit:L}){const C=A(),k=b,p=m([]),w=m(),d=m([]),y=m([]);x({getSkuConfigs:e=>{w.value.validateSku();const r=[];return d.value.forEach(t=>{var u;(u=t.spuDetail.skus)==null||u.forEach(f=>{r.push(f[e])})}),r}});const S=L;return h(()=>k.spuList,e=>{e&&(p.value=e)},{deep:!0,immediate:!0}),h(()=>k.spuPropertyListP,e=>{e&&(d.value=e,setTimeout(()=>{y.value=e.map(r=>r.spuId+"")},200))},{deep:!0,immediate:!0}),(e,r)=>{const t=U,u=j,f=q,I=z;return _(),v(I,{data:o(p),"expand-row-keys":o(y),"row-key":"id"},{default:l(()=>[a(t,{type:"expand",width:"30"},{default:l(({row:i})=>{var c,s;return[a(o(D),{ref_key:"skuListRef",ref:w,"is-activity-component":!0,"prop-form-data":(c=o(d).find(n=>n.spuId===i.id))==null?void 0:c.spuDetail,"property-list":(s=o(d).find(n=>n.spuId===i.id))==null?void 0:s.propertyList,"rule-config":e.ruleConfig},{extension:l(()=>[H(e.$slots,"default")]),_:2},1032,["prop-form-data","property-list","rule-config"])]}),_:3}),a(t,{key:"id",align:"center",label:"\u5546\u54C1\u7F16\u53F7",prop:"id"}),a(t,{label:"\u5546\u54C1\u56FE","min-width":"80"},{default:l(({row:i})=>[a(u,{src:i.picUrl,class:"h-30px w-30px",onClick:c=>{return s=i.picUrl,void B({zIndex:99999999,urlList:[s]});var s}},null,8,["src","onClick"])]),_:1}),a(t,{"show-overflow-tooltip":!0,label:"\u5546\u54C1\u540D\u79F0","min-width":"300",prop:"name"}),a(t,{align:"center",label:"\u5546\u54C1\u552E\u4EF7","min-width":"90",prop:"price"},{default:l(({row:i})=>[g(J(o(E)(i.price)),1)]),_:1}),a(t,{align:"center",label:"\u9500\u91CF","min-width":"90",prop:"salesCount"}),a(t,{align:"center",label:"\u5E93\u5B58","min-width":"90",prop:"stock"}),o(p).length>1&&e.deletable?(_(),v(t,{key:0,align:"center",label:"\u64CD\u4F5C","min-width":"90"},{default:l(i=>[a(f,{link:"",type:"primary",onClick:c=>(async s=>{await C.confirm("\u662F\u5426\u5220\u9664\u5546\u54C1\u7F16\u53F7\u4E3A"+s+"\u7684\u6570\u636E\uFF1F");const n=p.value.findIndex(P=>P.id==s);p.value.splice(n,1),S("delete",s)})(i.row.id)},{default:l(()=>r[0]||(r[0]=[g(" \u5220\u9664")])),_:2},1032,["onClick"])]),_:1})):G("",!0)]),_:3},8,["data","expand-row-keys"])}}});export{R as _};
