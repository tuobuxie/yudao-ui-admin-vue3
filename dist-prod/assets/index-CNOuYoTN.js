import{H as w}from"./index-DmQdxAiK.js";import{b as C}from"./spu-BE3uLdh7.js";import{P as I}from"./index-BSu1aFKy.js";import{al as P}from"./form-designer-DHHJWkD5.js";import{l as S,r as d,b as B,m as p,q as r,I as R,$,O as s,E as c,x as n,J as g,D as u,H as a,u as m,A}from"./form-create-_84fGzaM.js";const L={key:0,class:"absolute left-0 top-0 z-1 items-center justify-center"},E={class:"text-12px"},U={class:"absolute bottom-8px right-8px"},_=S({name:"PromotionPoint",__name:"index",props:{property:{}},setup(h){const i=h,y=d([]),x=d([]),f=d([]);B(()=>i.property.activityIds,async()=>{try{const e=i.property.activityIds;Array.isArray(e)&&e.length>0&&(f.value=await I.getPointActivityListByIds(e),y.value=[],x.value=f.value.map(o=>o.spuId),x.value.length>0&&(y.value=await C(x.value)),f.value.forEach(o=>{const l=y.value.find(t=>t.id===o.spuId);l&&(l.pointStock=o.stock,l.pointTotalStock=o.totalStock,l.point=o.point,l.pointPrice=o.price)}))}catch{}},{immediate:!0,deep:!0});const k=e=>{const o=i.property.layoutType==="twoCol"?2:1;return{marginLeft:e%o===0?"0":i.property.space+"px",marginTop:e<o?"0":i.property.space+"px"}},v=d(),T=()=>{let e="100%";return i.property.layoutType==="twoCol"&&(e=(v.value.offsetWidth-i.property.space)/2+"px"),{width:e}};return(e,o)=>{const l=P;return r(),p("div",{ref_key:"containerRef",ref:v,class:u("box-content min-h-30px w-full flex flex-row flex-wrap")},[(r(!0),p(R,null,$(m(y),(t,b)=>(r(),p("div",{key:b,style:s({...k(b),...T(),borderTopLeftRadius:`${e.property.borderRadiusTop}px`,borderTopRightRadius:`${e.property.borderRadiusTop}px`,borderBottomLeftRadius:`${e.property.borderRadiusBottom}px`,borderBottomRightRadius:`${e.property.borderRadiusBottom}px`}),class:"relative box-content flex flex-row flex-wrap overflow-hidden bg-white"},[e.property.badge.show?(r(),p("div",L,[g(l,{src:e.property.badge.imgUrl,class:"h-26px w-38px",fit:"cover"},null,8,["src"])])):c("",!0),n("div",{class:u(["h-140px",{"w-full":e.property.layoutType!=="oneColSmallImg","w-140px":e.property.layoutType==="oneColSmallImg"}])},[g(l,{src:t.picUrl,class:"h-full w-full",fit:"cover"},null,8,["src"])],2),n("div",{class:u([" flex flex-col gap-8px p-8px box-border",{"w-full":e.property.layoutType!=="oneColSmallImg","w-[calc(100%-140px-16px)]":e.property.layoutType==="oneColSmallImg"}])},[e.property.fields.name.show?(r(),p("div",{key:0,class:u(["text-14px ",{truncate:e.property.layoutType!=="oneColSmallImg","overflow-ellipsis line-clamp-2":e.property.layoutType==="oneColSmallImg"}]),style:s({color:e.property.fields.name.color})},a(t.name),7)):c("",!0),e.property.fields.introduction.show?(r(),p("div",{key:1,style:s({color:e.property.fields.introduction.color}),class:"truncate text-12px"},a(t.introduction),5)):c("",!0),n("div",null,[e.property.fields.price.show?(r(),p("span",{key:0,style:s({color:e.property.fields.price.color}),class:"text-16px"},a(t.point)+"\u79EF\u5206 "+a(t.pointPrice&&t.pointPrice!==0?`+${m(w)(t.pointPrice)}\u5143`:""),5)):c("",!0),e.property.fields.marketPrice.show&&t.marketPrice?(r(),p("span",{key:1,style:s({color:e.property.fields.marketPrice.color}),class:"ml-4px text-10px line-through"}," \uFFE5"+a(m(w)(t.marketPrice)),5)):c("",!0)]),n("div",E,[e.property.fields.salesCount.show?(r(),p("span",{key:0,style:s({color:e.property.fields.salesCount.color})}," \u5DF2\u5151"+a((t.pointTotalStock||0)-(t.pointStock||0))+"\u4EF6 ",5)):c("",!0),e.property.fields.stock.show?(r(),p("span",{key:1,style:s({color:e.property.fields.stock.color})}," \u5E93\u5B58"+a(t.pointTotalStock||0),5)):c("",!0)])],2),n("div",U,[e.property.btnBuy.type==="text"?(r(),p("span",{key:0,style:s({background:`linear-gradient(to right, ${e.property.btnBuy.bgBeginColor}, ${e.property.btnBuy.bgEndColor}`}),class:"rounded-full p-x-12px p-y-4px text-12px text-white"},a(e.property.btnBuy.text),5)):(r(),A(l,{key:1,src:e.property.btnBuy.imgUrl,class:"h-28px w-28px rounded-full",fit:"cover"},null,8,["src"]))])],4))),128))],512)}}});export{_ as default};
