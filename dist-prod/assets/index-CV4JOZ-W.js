import{X as y,d as P,_ as S}from"./index-DmQdxAiK.js";import{_ as X}from"./index-C2x7yuaO.js";import{_ as L}from"./ReplyForm.vue_vue_type_script_setup_true_lang-CThvQyTH.js";import{R as A}from"./TabNews-B7LkNpZh.js";import"./index.vue_vue_type_script_setup_true_lang-OyXbUoED.js";import"./main-CJVSjYz7.js";import"./main-Ddqx4-1N.js";import"./main.vue_vue_type_script_setup_true_lang-DeOxeHzY.js";import{h as Q,aj as W,a0 as Y,i as Z,j as ee,f as ae,$ as le,v as te}from"./form-designer-DHHJWkD5.js";import"./main-I-_7yN8H.js";import"./useUpload-CW5EVrRd.js";import"./TabImage-DasBtZ73.js";import"./TabVoice-Cfw_efun.js";import"./TabVideo-CkUeWTPH.js";import"./main-BWoc3Odi.js";import{_ as se}from"./main.vue_vue_type_script_setup_true_lang-DijmNsTR.js";import{_ as D}from"./ContentWrap.vue_vue_type_script_setup_true_lang-OPDE9cVe.js";import{_ as oe}from"./ReplyTable.vue_vue_type_script_setup_true_lang-Bk76TfOo.js";import{M as c}from"./types-CAO1T7C7.js";import{l as re,r as p,j as ue,ag as pe,m as ie,q as k,J as l,B as s,u as t,h,C as ne,E as de,A as me,G as v,I as ce}from"./form-create-_84fGzaM.js";import"./index-CHHBmOkg.js";import"./index-CebrFt1o.js";import"./formatTime-BGPGB_ys.js";import"./TabText.vue_vue_type_script_setup_true_lang-CjSjCXTv.js";import"./TabMusic.vue_vue_type_script_setup_true_lang-CrK_E0Z2.js";import"./index-W8edep2c.js";import"./tagsView-CQDzb46U.js";import"./DictTag.vue_vue_type_script_lang-DiMRMEpR.js";import"./main-D9VokZmh.js";const ve=re({name:"MpAutoReply",__name:"index",setup(ye){const f=P(),q=p(-1),u=p(c.Keyword),I=p(!0),j=p(0),U=p([]),w=p(null),i=ue({pageNo:1,pageSize:10,accountId:q}),b=p(!1),n=p(!1),r=p({}),o=p({type:A.Text,accountId:-1}),F=a=>{q.value=a,o.value.accountId=a,i.pageNo=1,M()},M=async()=>{I.value=!0;try{const e=await(a={...i,type:u.value},y.get({url:"/mp/auto-reply/page",params:a}));U.value=e.list,j.value=e.total}finally{I.value=!1}var a},K=a=>{u.value=a,i.pageNo=1,M()},N=()=>{T(),o.value={type:A.Text,accountId:i.accountId},b.value=!0,n.value=!0},R=async a=>{T();const e=await(m=>y.get({url:"/mp/auto-reply/get?id="+m}))(a);r.value={...e},delete r.value.responseMessageType,delete r.value.responseContent,delete r.value.responseMediaId,delete r.value.responseMediaUrl,delete r.value.responseDescription,delete r.value.responseArticles,o.value={type:e.responseMessageType,accountId:i.accountId,content:e.responseContent,mediaId:e.responseMediaId,url:e.responseMediaUrl,title:e.responseTitle,description:e.responseDescription,thumbMediaId:e.responseThumbMediaId,thumbMediaUrl:e.responseThumbMediaUrl,articles:e.responseArticles,musicUrl:e.responseMusicUrl,hqMusicUrl:e.responseHqMusicUrl},b.value=!1,n.value=!0},z=async a=>{await f.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u6B64\u6570\u636E?"),await(e=>y.delete({url:"/mp/auto-reply/delete?id="+e}))(a),await M(),f.success("\u5220\u9664\u6210\u529F")},H=async()=>{var m;await((m=w.value)==null?void 0:m.validate());const a={...r.value};var e;a.responseMessageType=o.value.type,a.responseContent=o.value.content,a.responseMediaId=o.value.mediaId,a.responseMediaUrl=o.value.url,a.responseTitle=o.value.title,a.responseDescription=o.value.description,a.responseThumbMediaId=o.value.thumbMediaId,a.responseThumbMediaUrl=o.value.thumbMediaUrl,a.responseArticles=o.value.articles,a.responseMusicUrl=o.value.musicUrl,a.responseHqMusicUrl=o.value.hqMusicUrl,r.value.id!==void 0?(await(e=a,y.put({url:"/mp/auto-reply/update",data:e})),f.success("\u4FEE\u6539\u6210\u529F")):(await(x=>y.post({url:"/mp/auto-reply/create",data:x}))(a),f.success("\u65B0\u589E\u6210\u529F")),n.value=!1,await M()},T=()=>{var a;r.value={id:void 0,accountId:i.accountId,type:u.value,requestKeyword:void 0,requestMatch:u.value===c.Keyword?1:void 0,requestMessageType:void 0},(a=w.value)==null||a.resetFields()},O=()=>{n.value=!1,T()};return(a,e)=>{const m=X,x=W,$=Q,g=S,C=ae,B=ee,_=Z,V=le,E=Y,G=te,J=pe("hasPermi");return k(),ie(ce,null,[l(m,{title:"\u81EA\u52A8\u56DE\u590D",url:"https://doc.iocoder.cn/mp/auto-reply/"}),l(t(D),null,{default:s(()=>[l($,{class:"-mb-15px",model:t(i),inline:!0,"label-width":"68px"},{default:s(()=>[l(x,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:s(()=>[l(t(se),{onChange:F})]),_:1})]),_:1},8,["model"])]),_:1}),l(t(D),null,{default:s(()=>[l(E,{modelValue:t(u),"onUpdate:modelValue":e[0]||(e[0]=d=>h(u)?u.value=d:null),onTabChange:K},{default:s(()=>[l(_,{gutter:10,class:"mb8"},{default:s(()=>[l(B,{span:1.5},{default:s(()=>[t(u)!==t(c).Follow||t(U).length<=0?ne((k(),me(C,{key:0,type:"primary",plain:"",onClick:N},{default:s(()=>[l(g,{icon:"ep:plus"}),e[4]||(e[4]=v("\u65B0\u589E "))]),_:1})),[[J,["mp:auto-reply:create"]]]):de("",!0)]),_:1})]),_:1}),l(V,{name:t(c).Follow},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:star",class:"mr-2px"}),e[5]||(e[5]=v(" \u5173\u6CE8\u65F6\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(V,{name:t(c).Message},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:chat-line-round",class:"mr-2px"}),e[6]||(e[6]=v(" \u6D88\u606F\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(V,{name:t(c).Keyword},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"fa:newspaper-o",class:"mr-2px"}),e[7]||(e[7]=v(" \u5173\u952E\u8BCD\u56DE\u590D"))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"]),l(oe,{loading:t(I),list:t(U),"msg-type":t(u),onOnUpdate:R,onOnDelete:z},null,8,["loading","list","msg-type"]),l(G,{title:t(b)?"\u65B0\u589E\u81EA\u52A8\u56DE\u590D":"\u4FEE\u6539\u81EA\u52A8\u56DE\u590D",modelValue:t(n),"onUpdate:modelValue":e[3]||(e[3]=d=>h(n)?n.value=d:null),width:"800px","destroy-on-close":""},{footer:s(()=>[l(C,{onClick:O},{default:s(()=>e[8]||(e[8]=[v("\u53D6 \u6D88")])),_:1}),l(C,{type:"primary",onClick:H},{default:s(()=>e[9]||(e[9]=[v("\u786E \u5B9A")])),_:1})]),default:s(()=>[l(L,{modelValue:t(r),"onUpdate:modelValue":e[1]||(e[1]=d=>h(r)?r.value=d:null),reply:t(o),"onUpdate:reply":e[2]||(e[2]=d=>h(o)?o.value=d:null),"msg-type":t(u),ref_key:"formRef",ref:w},null,8,["modelValue","reply","msg-type"])]),_:1},8,["title","modelValue"])]),_:1})],64)}}});export{ve as default};
