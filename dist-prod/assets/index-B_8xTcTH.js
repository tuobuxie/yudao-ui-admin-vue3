import{X as F,d as W,h as H,D as x,_ as ee}from"./index-B2urM1q-.js";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang-Cj0jlW8o.js";import{_ as le}from"./DictTag.vue_vue_type_script_lang-wg8pUI-B.js";import{_ as te}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BRGqERh7.js";import{_ as oe}from"./index-Cb5mbozM.js";import{l as se,r as f,j as re,e as de,ag as ue,m as d,q as o,J as l,B as s,u as t,Z as C,I as y,$ as _,A as w,C as N,G as u,x as K,H as b,E as v}from"./form-create-_84fGzaM.js";import{d as ne}from"./formatTime-BGPGB_ys.js";import{d as ie}from"./download-oWiM5xVU.js";import{e as pe}from"./index-BeB3HCEO.js";import{_ as me}from"./MailLogDetail.vue_vue_type_script_setup_true_lang-WaAAs7BH.js";import{h as ce,aj as fe,k as ye,x as _e,Q as we,F as ve,f as ge,Z as be,_ as he,ak as xe}from"./form-designer-DHHJWkD5.js";import"./Dialog.vue_vue_type_style_index_0_lang-bMayE4GC.js";const ke={key:0},Me={key:1},Se={class:"text-left"},Ve={key:0},Te={key:0},Ie={key:1},Ue={key:0},Ee={key:2},Ye={key:0},Ce=se({name:"SystemMailLog",__name:"index",setup(Ne){const L=W(),k=f(!1),A=f(0),D=f([]),P=f(),r=re({pageNo:1,pageSize:10,toMail:"",accountId:void 0,templateId:void 0,sendStatus:void 0,userId:void 0,userType:void 0,sendTime:[]}),M=f(!1),S=f([]),V=async()=>{k.value=!0;try{const p=await(async a=>await F.get({url:"/system/mail-log/page",params:a}))(r);D.value=p.list,A.value=p.total}finally{k.value=!1}},g=()=>{r.pageNo=1,V()},X=()=>{P.value.resetFields(),g()},Z=async()=>{try{await L.exportConfirm(),M.value=!0;const a=await(p=r,F.download({url:"/system/mail-log/export-excel",params:p}));ie.excel(a,"\u90AE\u4EF6\u65E5\u5FD7.xls")}catch{}finally{M.value=!1}var p},R=f(),B=p=>{const a=S.value.find(T=>T.id===p);return(a==null?void 0:a.mail)||""};return de(async()=>{await V(),S.value=await pe()}),(p,a)=>{const T=oe,I=ye,m=fe,U=we,E=_e,G=ve,Y=ee,h=ge,J=ce,j=te,n=he,q=le,Q=be,$=ae,z=ue("hasPermi"),O=xe;return o(),d(y,null,[l(T,{title:"\u90AE\u4EF6\u914D\u7F6E",url:"https://doc.iocoder.cn/mail"}),l(j,null,{default:s(()=>[l(J,{class:"-mb-15px",model:t(r),ref_key:"queryFormRef",ref:P,inline:!0,"label-width":"100px"},{default:s(()=>[l(m,{label:"\u63A5\u6536\u90AE\u7BB1",prop:"toMail"},{default:s(()=>[l(I,{modelValue:t(r).toMail,"onUpdate:modelValue":a[0]||(a[0]=e=>t(r).toMail=e),placeholder:"\u8BF7\u8F93\u5165\u63A5\u6536\u90AE\u7BB1",clearable:"",onKeyup:C(g,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(m,{label:"\u90AE\u7BB1\u8D26\u53F7",prop:"accountId"},{default:s(()=>[l(E,{modelValue:t(r).accountId,"onUpdate:modelValue":a[1]||(a[1]=e=>t(r).accountId=e),placeholder:"\u8BF7\u9009\u62E9\u90AE\u7BB1\u8D26\u53F7",clearable:"",class:"!w-240px"},{default:s(()=>[(o(!0),d(y,null,_(t(S),e=>(o(),w(U,{key:e.id,value:e.id,label:e.mail},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"\u6A21\u677F\u7F16\u53F7",prop:"templateId"},{default:s(()=>[l(I,{modelValue:t(r).templateId,"onUpdate:modelValue":a[2]||(a[2]=e=>t(r).templateId=e),placeholder:"\u8BF7\u8F93\u5165\u6A21\u677F\u7F16\u53F7",clearable:"",onKeyup:C(g,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(m,{label:"\u53D1\u9001\u72B6\u6001",prop:"sendStatus"},{default:s(()=>[l(E,{modelValue:t(r).sendStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>t(r).sendStatus=e),placeholder:"\u8BF7\u9009\u62E9\u53D1\u9001\u72B6\u6001",clearable:"",class:"!w-240px"},{default:s(()=>[(o(!0),d(y,null,_(t(H)(t(x).SYSTEM_MAIL_SEND_STATUS),e=>(o(),w(U,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"\u7528\u6237\u7F16\u53F7",prop:"userId"},{default:s(()=>[l(I,{modelValue:t(r).userId,"onUpdate:modelValue":a[4]||(a[4]=e=>t(r).userId=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u7F16\u53F7",clearable:"",onKeyup:C(g,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(m,{label:"\u7528\u6237\u7C7B\u578B",prop:"userType"},{default:s(()=>[l(E,{modelValue:t(r).userType,"onUpdate:modelValue":a[5]||(a[5]=e=>t(r).userType=e),placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u7C7B\u578B",clearable:"",class:"!w-240px"},{default:s(()=>[(o(!0),d(y,null,_(t(H)(t(x).USER_TYPE),e=>(o(),w(U,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"\u53D1\u9001\u65F6\u95F4",prop:"sendTime"},{default:s(()=>[l(G,{modelValue:t(r).sendTime,"onUpdate:modelValue":a[6]||(a[6]=e=>t(r).sendTime=e),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(m,null,{default:s(()=>[l(h,{onClick:g},{default:s(()=>[l(Y,{icon:"ep:search",class:"mr-5px"}),a[9]||(a[9]=u(" \u641C\u7D22"))]),_:1}),l(h,{onClick:X},{default:s(()=>[l(Y,{icon:"ep:refresh",class:"mr-5px"}),a[10]||(a[10]=u(" \u91CD\u7F6E"))]),_:1}),N((o(),w(h,{type:"success",plain:"",onClick:Z,loading:t(M)},{default:s(()=>[l(Y,{icon:"ep:download",class:"mr-5px"}),a[11]||(a[11]=u(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[z,["system:mail-log:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),l(j,null,{default:s(()=>[N((o(),w(Q,{data:t(D)},{default:s(()=>[l(n,{label:"\u7F16\u53F7",align:"center",prop:"id"}),l(n,{label:"\u53D1\u9001\u65F6\u95F4",align:"center",prop:"sendTime",width:"180",formatter:t(ne)},null,8,["formatter"]),l(n,{label:"\u63A5\u6536\u7528\u6237",align:"center",width:"150"},{default:s(e=>[e.row.userType&&e.row.userId?(o(),d("div",ke,[l(q,{type:t(x).USER_TYPE,value:e.row.userType},null,8,["type","value"]),K("div",null,b("("+e.row.userId+")"),1)])):(o(),d("div",Me,"-"))]),_:1}),l(n,{label:"\u63A5\u6536\u4FE1\u606F",align:"center",width:"300"},{default:s(e=>[K("div",Se,[e.row.toMails&&e.row.toMails.length>0?(o(),d("div",Ve,[a[12]||(a[12]=u(" \u6536\u4EF6\uFF1A ")),(o(!0),d(y,null,_(e.row.toMails,(i,c)=>(o(),d("span",{key:i},[u(b(i),1),c<e.row.toMails.length-1?(o(),d("span",Te,"\u3001")):v("",!0)]))),128))])):v("",!0),e.row.ccMails&&e.row.ccMails.length>0?(o(),d("div",Ie,[a[13]||(a[13]=u(" \u6284\u9001\uFF1A ")),(o(!0),d(y,null,_(e.row.ccMails,(i,c)=>(o(),d("span",{key:i},[u(b(i),1),c<e.row.ccMails.length-1?(o(),d("span",Ue,"\u3001")):v("",!0)]))),128))])):v("",!0),e.row.bccMails&&e.row.bccMails.length>0?(o(),d("div",Ee,[a[14]||(a[14]=u(" \u5BC6\u9001\uFF1A ")),(o(!0),d(y,null,_(e.row.bccMails,(i,c)=>(o(),d("span",{key:i},[u(b(i),1),c<e.row.bccMails.length-1?(o(),d("span",Ye,"\u3001")):v("",!0)]))),128))])):v("",!0)])]),_:1}),l(n,{label:"\u90AE\u4EF6\u6807\u9898",align:"center",prop:"templateTitle",width:"200"}),l(n,{label:"\u53D1\u9001\u72B6\u6001",align:"center",width:"120"},{default:s(e=>[l(q,{type:t(x).SYSTEM_MAIL_SEND_STATUS,value:e.row.sendStatus},null,8,["type","value"])]),_:1}),l(n,{label:"\u90AE\u7BB1\u8D26\u53F7",align:"center",width:"200"},{default:s(e=>[u(b(B(e.row.accountId)),1)]),_:1}),l(n,{label:"\u6A21\u677F\u7F16\u53F7",align:"center",prop:"templateId"}),l(n,{label:"\u64CD\u4F5C",align:"center",fixed:"right","class-name":"fixed-width"},{default:s(e=>[N((o(),w(h,{link:"",type:"primary",onClick:i=>{return c=e.row,void R.value.open(c);var c}},{default:s(()=>a[15]||(a[15]=[u(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[z,["system:mail-log:query"]]])]),_:1})]),_:1},8,["data"])),[[O,t(k)]]),l($,{total:t(A),page:t(r).pageNo,"onUpdate:page":a[7]||(a[7]=e=>t(r).pageNo=e),limit:t(r).pageSize,"onUpdate:limit":a[8]||(a[8]=e=>t(r).pageSize=e),onPagination:V},null,8,["total","page","limit"])]),_:1}),l(me,{ref_key:"detailRef",ref:R},null,512)],64)}}});export{Ce as default};
