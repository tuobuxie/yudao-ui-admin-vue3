import{X as r,a as Z,d as z,Y as H}from"./index-B2urM1q-.js";import{_ as K}from"./Dialog.vue_vue_type_style_index_0_lang-bMayE4GC.js";import{_ as M}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BRGqERh7.js";import{_ as O}from"./StockInItemForm.vue_vue_type_script_setup_true_lang-DzzTCWEm.js";import{S as W}from"./index-CtEQlEHd.js";import{h as ee,i as ae,j as le,aj as te,k as se,F as oe,x as ue,Q as de,ak as ie,a0 as re,$ as me,f as pe}from"./form-designer-DHHJWkD5.js";import{l as ne,r as i,j as ce,c as fe,A as v,q as f,B as t,C as ve,J as l,u as a,m as ke,I as _e,$ as Ve,h as F,E as we,G as j}from"./form-create-_84fGzaM.js";const k={getStockInPage:async u=>await r.get({url:"/erp/stock-in/page",params:u}),getStockIn:async u=>await r.get({url:"/erp/stock-in/get?id="+u}),createStockIn:async u=>await r.post({url:"/erp/stock-in/create",data:u}),updateStockIn:async u=>await r.put({url:"/erp/stock-in/update",data:u}),updateStockInStatus:async(u,_)=>await r.put({url:"/erp/stock-in/update-status",params:{id:u,status:_}}),deleteStockIn:async u=>await r.delete({url:"/erp/stock-in/delete",params:{ids:u.join(",")}}),exportStockIn:async u=>await r.download({url:"/erp/stock-in/export-excel",params:u})},ye=ne({name:"StockInForm",__name:"StockInForm",emits:["success"],setup(u,{expose:_,emit:C}){const{t:V}=Z(),I=z(),m=i(!1),g=i(""),p=i(!1),w=i(""),o=i({id:void 0,supplierId:void 0,inTime:void 0,remark:void 0,fileUrl:"",items:[]}),q=ce({inTime:[{required:!0,message:"\u5165\u5E93\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),y=fe(()=>w.value==="detail"),b=i(),U=i([]),S=i("item"),x=i();_({open:async(d,e)=>{if(m.value=!0,g.value=V("action."+d),w.value=d,G(),e){p.value=!0;try{o.value=await k.getStockIn(e)}finally{p.value=!1}}U.value=await W.getSupplierSimpleList()}});const B=C,E=async()=>{await b.value.validate(),await x.value.validate(),p.value=!0;try{const d=o.value;w.value==="create"?(await k.createStockIn(d),I.success(V("common.createSuccess"))):(await k.updateStockIn(d),I.success(V("common.updateSuccess"))),m.value=!1,B("success")}finally{p.value=!1}},G=()=>{var d;o.value={id:void 0,supplierId:void 0,inTime:void 0,remark:void 0,fileUrl:void 0,items:[]},(d=b.value)==null||d.resetFields()};return(d,e)=>{const h=se,n=te,c=le,P=oe,R=de,$=ue,A=H,D=ae,J=ee,L=me,N=re,Q=M,T=pe,X=K,Y=ie;return f(),v(X,{title:a(g),modelValue:a(m),"onUpdate:modelValue":e[7]||(e[7]=s=>F(m)?m.value=s:null),width:"1080"},{footer:t(()=>[a(y)?we("",!0):(f(),v(T,{key:0,onClick:E,type:"primary",disabled:a(p)},{default:t(()=>e[8]||(e[8]=[j(" \u786E \u5B9A ")])),_:1},8,["disabled"])),l(T,{onClick:e[6]||(e[6]=s=>m.value=!1)},{default:t(()=>e[9]||(e[9]=[j("\u53D6 \u6D88")])),_:1})]),default:t(()=>[ve((f(),v(J,{ref_key:"formRef",ref:b,model:a(o),rules:a(q),"label-width":"100px",disabled:a(y)},{default:t(()=>[l(D,{gutter:20},{default:t(()=>[l(c,{span:8},{default:t(()=>[l(n,{label:"\u5165\u5E93\u5355\u53F7",prop:"no"},{default:t(()=>[l(h,{disabled:"",modelValue:a(o).no,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).no=s),placeholder:"\u4FDD\u5B58\u65F6\u81EA\u52A8\u751F\u6210"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:8},{default:t(()=>[l(n,{label:"\u5165\u5E93\u65F6\u95F4",prop:"inTime"},{default:t(()=>[l(P,{modelValue:a(o).inTime,"onUpdate:modelValue":e[1]||(e[1]=s=>a(o).inTime=s),type:"date","value-format":"x",placeholder:"\u9009\u62E9\u5165\u5E93\u65F6\u95F4",class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:8},{default:t(()=>[l(n,{label:"\u4F9B\u5E94\u5546",prop:"supplierId"},{default:t(()=>[l($,{modelValue:a(o).supplierId,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).supplierId=s),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4F9B\u5E94\u5546",class:"!w-1/1"},{default:t(()=>[(f(!0),ke(_e,null,Ve(a(U),s=>(f(),v(R,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:16},{default:t(()=>[l(n,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[l(h,{type:"textarea",modelValue:a(o).remark,"onUpdate:modelValue":e[3]||(e[3]=s=>a(o).remark=s),rows:1,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:8},{default:t(()=>[l(n,{label:"\u9644\u4EF6",prop:"fileUrl"},{default:t(()=>[l(A,{"is-show-tip":!1,modelValue:a(o).fileUrl,"onUpdate:modelValue":e[4]||(e[4]=s=>a(o).fileUrl=s),limit:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules","disabled"])),[[Y,a(p)]]),l(Q,null,{default:t(()=>[l(N,{modelValue:a(S),"onUpdate:modelValue":e[5]||(e[5]=s=>F(S)?S.value=s:null),class:"-mt-15px -mb-10px"},{default:t(()=>[l(L,{label:"\u5165\u5E93\u4EA7\u54C1\u6E05\u5355",name:"item"},{default:t(()=>[l(O,{ref_key:"itemFormRef",ref:x,items:a(o).items,disabled:a(y)},null,8,["items","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["title","modelValue"])}}});export{k as S,ye as _};
