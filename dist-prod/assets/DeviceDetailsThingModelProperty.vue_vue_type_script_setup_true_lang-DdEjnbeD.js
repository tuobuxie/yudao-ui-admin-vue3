import{_ as M}from"./index-DmQdxAiK.js";import{_ as X}from"./ContentWrap.vue_vue_type_script_setup_true_lang-OPDE9cVe.js";import{l as E,r as o,j as O,b as Q,P as W,e as Y,m as $,q as v,I as N,J as a,B as t,N as ee,u as r,Z as ae,h as le,C as R,A as I,$ as te,x as i,H as u,G as k}from"./form-create-_84fGzaM.js";import{D as se}from"./index-m3HcIj_K.js";import{f as ie,d as re}from"./formatTime-BGPGB_ys.js";import{_ as ne}from"./DeviceDetailsThingModelPropertyHistory.vue_vue_type_script_setup_true_lang-DzRsL9Pp.js";import{h as oe,aj as de,k as ce,aq as ue,f as pe,D as fe,ak as me,i as ve,j as ye,ad as xe,a6 as _e,Z as be,_ as we}from"./form-designer-DHHJWkD5.js";const ke={class:"p-4 relative"},ge={class:"flex items-center mb-3"},he={class:"mr-2.5 flex items-center"},Ie={class:"text-[16px] font-600 flex-1"},Ce={class:"inline-flex items-center mr-2"},Te={class:"inline-flex items-center mr-2"},Ve=["onClick"],De={class:"text-[14px]"},je={class:"mb-2.5 last:mb-0"},Le={class:"text-[#0b1d30] font-600"},qe={class:"mb-2.5 last:mb-0"},ze={class:"text-[#0b1d30] text-[12px]"},Pe=E({__name:"DeviceDetailsThingModelProperty",props:{deviceId:{}},setup(S){const y=S,x=o(!0),_=o([]),g=o([]),p=O({keyword:""}),b=o(!1);let f=null;const m=o("card"),U=o(),C=async()=>{x.value=!0;try{const s={deviceId:y.deviceId,identifier:void 0,name:void 0};g.value=await se.getLatestDeviceProperties(s),T()}finally{x.value=!1}},T=()=>{if(p.keyword.trim()){const s=p.keyword.toLowerCase();_.value=g.value.filter(e=>{var n,d;return((n=e.identifier)==null?void 0:n.toLowerCase().includes(s))||((d=e.name)==null?void 0:d.toLowerCase().includes(s))})}else _.value=g.value},V=()=>{T()},D=o(),j=(s,e,n)=>{D.value.open(s,e,n)},L=s=>{var n;if(s.value===null||s.value===void 0||s.value==="")return"-";const e=(n=s.dataSpecs)==null?void 0:n.unitName;return e?`${s.value} ${e}`:s.value};return Q(b,s=>{s?f=setInterval(()=>{C()},5e3):(clearInterval(f),f=null)}),W(()=>{f&&clearInterval(f)}),Y(()=>{C()}),(s,e)=>{const n=ce,d=de,w=M,h=pe,Z=ue,A=fe,B=oe,q=X,z=_e,F=xe,G=ye,H=ve,c=we,J=be,P=me;return v(),$(N,null,[a(q,null,{default:t(()=>[a(B,{class:"-mb-15px",model:r(p),ref_key:"queryFormRef",ref:U,inline:!0,"label-width":"68px",onSubmit:e[4]||(e[4]=ee(()=>{},["prevent"]))},{default:t(()=>[a(d,{label:"",prop:"keyword"},{default:t(()=>[a(n,{modelValue:r(p).keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>r(p).keyword=l),placeholder:"\u8BF7\u8F93\u5165\u5C5E\u6027\u540D\u79F0\u3001\u6807\u5FD7\u7B26",clearable:"",class:"!w-240px",onKeyup:ae(V,["enter"]),onClear:V},null,8,["modelValue"])]),_:1}),a(d,{class:"float-right !mr-0 !mb-0"},{default:t(()=>[a(Z,null,{default:t(()=>[a(h,{type:r(m)==="card"?"primary":"default",onClick:e[1]||(e[1]=l=>m.value="card")},{default:t(()=>[a(w,{icon:"ep:grid"})]),_:1},8,["type"]),a(h,{type:r(m)==="list"?"primary":"default",onClick:e[2]||(e[2]=l=>m.value="list")},{default:t(()=>[a(w,{icon:"ep:list"})]),_:1},8,["type"])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(A,{size:"large",width:"80",modelValue:r(b),"onUpdate:modelValue":e[3]||(e[3]=l=>le(b)?b.value=l:null),class:"-ml-15px","inline-prompt":"","active-text":"\u5B9A\u65F6\u5237\u65B0","inactive-text":"\u5B9A\u65F6\u5237\u65B0",style:{"--el-switch-on-color":"#13ce66"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),a(q,null,{default:t(()=>[r(m)==="card"?R((v(),I(H,{key:0,gutter:16},{default:t(()=>[(v(!0),$(N,null,te(r(_),l=>(v(),I(G,{key:l.identifier,xs:24,sm:12,md:12,lg:6,class:"mb-4"},{default:t(()=>[a(F,{class:"h-full transition-colors relative overflow-hidden","body-style":{padding:"0"}},{default:t(()=>[e[7]||(e[7]=i("div",{class:"absolute top-0 left-0 right-0 h-[50px] pointer-events-none bg-gradient-to-b from-[#eefaff] to-transparent"},null,-1)),i("div",ke,[i("div",ge,[i("div",he,[a(w,{icon:"ep:cpu",class:"text-[18px] text-[#0070ff]"})]),i("div",Ie,u(l.name),1),i("div",Ce,[a(z,{size:"small",type:"primary"},{default:t(()=>[k(u(l.identifier),1)]),_:2},1024)]),i("div",Te,[a(z,{size:"small",type:"info"},{default:t(()=>[k(u(l.dataType),1)]),_:2},1024)]),i("div",{class:"cursor-pointer flex items-center justify-center w-8 h-8 rounded-full hover:bg-blue-50 transition-colors",onClick:K=>j(y.deviceId,l.identifier,l.dataType)},[a(w,{icon:"ep:data-line",class:"text-[18px] text-[#0070ff]"})],8,Ve)]),i("div",De,[i("div",je,[e[5]||(e[5]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u5C5E\u6027\u503C",-1)),i("span",Le,u(L(l)),1)]),i("div",qe,[e[6]||(e[6]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u66F4\u65B0\u65F6\u95F4",-1)),i("span",ze,u(l.updateTime?r(ie)(l.updateTime):"-"),1)])])])]),_:2},1024)]),_:2},1024))),128))]),_:1})),[[P,r(x)]]):R((v(),I(J,{key:1,data:r(_),stripe:!0,"show-overflow-tooltip":!0},{default:t(()=>[a(c,{label:"\u5C5E\u6027\u6807\u8BC6\u7B26",align:"center",prop:"identifier"}),a(c,{label:"\u5C5E\u6027\u540D\u79F0",align:"center",prop:"name"}),a(c,{label:"\u6570\u636E\u7C7B\u578B",align:"center",prop:"dataType"}),a(c,{label:"\u5C5E\u6027\u503C",align:"center",prop:"value"},{default:t(l=>[k(u(L(l.row)),1)]),_:1}),a(c,{label:"\u66F4\u65B0\u65F6\u95F4",align:"center",prop:"updateTime",formatter:r(re),width:"180px"},null,8,["formatter"]),a(c,{label:"\u64CD\u4F5C",align:"center"},{default:t(l=>[a(h,{link:"",type:"primary",onClick:K=>j(y.deviceId,l.row.identifier,l.row.dataType)},{default:t(()=>e[8]||(e[8]=[k(" \u67E5\u770B\u6570\u636E ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[P,r(x)]]),a(ne,{ref_key:"historyRef",ref:D,deviceId:y.deviceId},null,8,["deviceId"])]),_:1})],64)}}});export{Pe as _};
