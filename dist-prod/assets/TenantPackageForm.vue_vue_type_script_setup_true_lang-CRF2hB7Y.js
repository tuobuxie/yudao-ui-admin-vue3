import{a as P,d as R,h as G,D as J}from"./index-DzK2S43K.js";import{_ as K}from"./Dialog.vue_vue_type_style_index_0_lang-D3YOFsHs.js";import{C as I}from"./constants-C3gLHYOK.js";import{d as $,h as z}from"./tree-COGD3qag.js";import{a as Q,c as W,u as X}from"./index-C0VS8u1k.js";import{g as Y}from"./index-C7J1l6yf.js";import{h as Z,aj as ee,k as ae,ad as le,y as se,D as ue,s as te,u as oe,ak as re,f as de}from"./form-designer-DHHJWkD5.js";import{l as ne,r,j as me,A as _,q as h,B as u,C as ie,u as a,J as t,G as f,h as g,m as ce,I as pe,$ as ve,H as fe}from"./form-create-_84fGzaM.js";const ke=ne({name:"SystemTenantPackageForm",__name:"TenantPackageForm",emits:["success"],setup(he,{expose:E,emit:N}){const{t:y}=P(),x=R(),m=r(!1),b=r(""),i=r(!1),C=r(""),o=r({id:null,name:null,remark:null,menuIds:[],status:I.ENABLE}),S=me({name:[{required:!0,message:"\u5957\u9910\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],menuIds:[{required:!0,message:"\u5173\u8054\u7684\u83DC\u5355\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),k=r(),V=r([]),c=r(!1),n=r(),v=r(!1);E({open:async(s,e)=>{if(m.value=!0,b.value=y("action."+s),C.value=s,F(),V.value=z(await Y()),e){i.value=!0;try{const d=await Q(e);o.value=d,d.menuIds.forEach(p=>{n.value.setChecked(p,!0,!1)})}finally{i.value=!1}}}});const q=N,A=async()=>{if(k&&await k.value.validate()){i.value=!0;try{const s=o.value;s.menuIds=[...n.value.getCheckedKeys(!1),...n.value.getHalfCheckedKeys()],C.value==="create"?(await W(s),x.success(y("common.createSuccess"))):(await X(s),x.success(y("common.updateSuccess"))),m.value=!1,q("success")}finally{i.value=!1}}},F=()=>{var s,e;v.value=!1,c.value=!1,o.value={id:null,name:null,remark:null,menuIds:[],status:I.ENABLE},(s=n.value)==null||s.setCheckedNodes([]),(e=k.value)==null||e.resetFields()},T=()=>{n.value.setCheckedNodes(v.value?V.value:[])},B=()=>{var e;const s=(e=n.value)==null?void 0:e.store.nodesMap;for(let d in s)s[d].expanded!==c.value&&(s[d].expanded=c.value)};return(s,e)=>{const d=ae,p=ee,w=ue,M=le,j=oe,D=te,H=Z,U=de,L=K,O=re;return h(),_(L,{modelValue:a(m),"onUpdate:modelValue":e[6]||(e[6]=l=>g(m)?m.value=l:null),title:a(b)},{footer:u(()=>[t(U,{disabled:a(i),type:"primary",onClick:A},{default:u(()=>e[9]||(e[9]=[f("\u786E \u5B9A")])),_:1},8,["disabled"]),t(U,{onClick:e[5]||(e[5]=l=>m.value=!1)},{default:u(()=>e[10]||(e[10]=[f("\u53D6 \u6D88")])),_:1})]),default:u(()=>[ie((h(),_(H,{ref_key:"formRef",ref:k,model:a(o),rules:a(S),"label-width":"80px"},{default:u(()=>[t(p,{label:"\u5957\u9910\u540D",prop:"name"},{default:u(()=>[t(d,{modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).name=l),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u540D"},null,8,["modelValue"])]),_:1}),t(p,{label:"\u83DC\u5355\u6743\u9650"},{default:u(()=>[t(M,{class:"w-full h-400px !overflow-y-scroll",shadow:"never"},{header:u(()=>[e[7]||(e[7]=f(" \u5168\u9009/\u5168\u4E0D\u9009: ")),t(w,{modelValue:a(v),"onUpdate:modelValue":e[1]||(e[1]=l=>g(v)?v.value=l:null),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:T},null,8,["modelValue"]),e[8]||(e[8]=f(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: ")),t(w,{modelValue:a(c),"onUpdate:modelValue":e[2]||(e[2]=l=>g(c)?c.value=l:null),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:B},null,8,["modelValue"])]),default:u(()=>[t(a(se),{ref_key:"treeRef",ref:n,data:a(V),props:a($),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019","node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1})]),_:1}),t(p,{label:"\u72B6\u6001",prop:"status"},{default:u(()=>[t(D,{modelValue:a(o).status,"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).status=l)},{default:u(()=>[(h(!0),ce(pe,null,ve(a(G)(a(J).COMMON_STATUS),l=>(h(),_(j,{key:l.value,value:l.value},{default:u(()=>[f(fe(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"\u5907\u6CE8",prop:"remark"},{default:u(()=>[t(d,{modelValue:a(o).remark,"onUpdate:modelValue":e[4]||(e[4]=l=>a(o).remark=l),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[O,a(i)]])]),_:1},8,["modelValue","title"])}}});export{ke as _};
