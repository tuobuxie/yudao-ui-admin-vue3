import{d as se,h as L,D as C,_ as me}from"./index-B2urM1q-.js";import{_ as ce}from"./Dialog.vue_vue_type_style_index_0_lang-bMayE4GC.js";import{_ as re}from"./index.vue_vue_type_script_setup_true_lang-Cj0jlW8o.js";import{_ as ve}from"./DictTag.vue_vue_type_script_lang-wg8pUI-B.js";import{_ as fe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BRGqERh7.js";import{l as _e,r as p,j as ge,e as be,A as n,q as d,B as t,J as o,u as a,E as q,m as b,I as y,$ as I,Z as F,G as f,C as ye,h as K,H as Y}from"./form-create-_84fGzaM.js";import{d as Ie}from"./formatTime-BGPGB_ys.js";import{D as Ve}from"./index-DM-qCYCO.js";import{P as we}from"./index-CHLLHQ4c.js";import{D as ke}from"./index-B-kcUgvz.js";import{h as Te,aj as he,x as Ce,Q as De,k as xe,f as Ee,Z as Ne,_ as Ue,u as Se,a6 as Pe,ak as Oe}from"./form-designer-DHHJWkD5.js";const Re=_e({name:"IoTDeviceTableSelect",__name:"DeviceTableSelect",props:{multiple:{type:Boolean,default:!1},productId:{type:Number,default:null}},emits:["success"],setup(U,{expose:Z,emit:H}){const c=U,J=se(),_=p(!1),Q=p("\u8BBE\u5907\u9009\u62E9\u5668"),$=p(!1),D=p(!0),S=p([]),P=p(0),r=p([]),g=p(),x=p([]),E=p([]),u=ge({pageNo:1,pageSize:10,deviceName:void 0,productId:void 0,deviceType:void 0,nickname:void 0,status:void 0,groupId:void 0}),O=p(),N=async()=>{D.value=!0;try{c.productId&&(u.productId=c.productId);const s=await Ve.getDevicePage(u);S.value=s.list,P.value=s.total}finally{D.value=!1}},V=()=>{u.pageNo=1,N()},M=()=>{O.value.resetFields(),V()};Z({open:async()=>{_.value=!0,r.value=[],g.value=void 0,c.productId||(x.value=await we.getSimpleProductList()),await N()}});const R=p(),W=s=>{var l;c.multiple?(l=R.value)==null||l.toggleRowSelection(s):(g.value=s.id,r.value=[s])},X=s=>{c.multiple&&(r.value=s)},ee=H,le=async()=>{r.value.length!==0?(ee("success",c.multiple?r.value:r.value[0]),_.value=!1):J.warning(c.multiple?"\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u8BBE\u5907":"\u8BF7\u9009\u62E9\u4E00\u4E2A\u8BBE\u5907")};return be(async()=>{E.value=await ke.getSimpleDeviceGroupList()}),(s,l)=>{const w=De,k=Ce,v=he,z=xe,j=me,T=Ee,ae=Te,A=fe,m=Ue,oe=Se,B=ve,te=Pe,ue=Ne,de=re,pe=ce,ie=Oe;return d(),n(pe,{title:a(Q),modelValue:a(_),"onUpdate:modelValue":l[10]||(l[10]=e=>K(_)?_.value=e:null),appendToBody:!0,width:"60%"},{footer:t(()=>[o(T,{onClick:le,type:"primary",disabled:a($)},{default:t(()=>l[14]||(l[14]=[f("\u786E \u5B9A")])),_:1},8,["disabled"]),o(T,{onClick:l[9]||(l[9]=e=>_.value=!1)},{default:t(()=>l[15]||(l[15]=[f("\u53D6 \u6D88")])),_:1})]),default:t(()=>[o(A,null,{default:t(()=>[o(ae,{ref_key:"queryFormRef",ref:O,inline:!0,model:a(u),class:"-mb-15px","label-width":"100px"},{default:t(()=>[c.productId?q("",!0):(d(),n(v,{key:0,label:"\u4EA7\u54C1",prop:"productId"},{default:t(()=>[o(k,{modelValue:a(u).productId,"onUpdate:modelValue":l[0]||(l[0]=e=>a(u).productId=e),placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1",clearable:"",class:"!w-240px"},{default:t(()=>[(d(!0),b(y,null,I(a(x),e=>(d(),n(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})),o(v,{label:"DeviceName",prop:"deviceName"},{default:t(()=>[o(z,{modelValue:a(u).deviceName,"onUpdate:modelValue":l[1]||(l[1]=e=>a(u).deviceName=e),placeholder:"\u8BF7\u8F93\u5165 DeviceName",clearable:"",onKeyup:F(V,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),o(v,{label:"\u5907\u6CE8\u540D\u79F0",prop:"nickname"},{default:t(()=>[o(z,{modelValue:a(u).nickname,"onUpdate:modelValue":l[2]||(l[2]=e=>a(u).nickname=e),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\u540D\u79F0",clearable:"",onKeyup:F(V,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),o(v,{label:"\u8BBE\u5907\u7C7B\u578B",prop:"deviceType"},{default:t(()=>[o(k,{modelValue:a(u).deviceType,"onUpdate:modelValue":l[3]||(l[3]=e=>a(u).deviceType=e),placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907\u7C7B\u578B",clearable:"",class:"!w-240px"},{default:t(()=>[(d(!0),b(y,null,I(a(L)(a(C).IOT_PRODUCT_DEVICE_TYPE),e=>(d(),n(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(v,{label:"\u8BBE\u5907\u72B6\u6001",prop:"status"},{default:t(()=>[o(k,{modelValue:a(u).status,"onUpdate:modelValue":l[4]||(l[4]=e=>a(u).status=e),placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907\u72B6\u6001",clearable:"",class:"!w-240px"},{default:t(()=>[(d(!0),b(y,null,I(a(L)(a(C).IOT_DEVICE_STATE),e=>(d(),n(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(v,{label:"\u8BBE\u5907\u5206\u7EC4",prop:"groupId"},{default:t(()=>[o(k,{modelValue:a(u).groupId,"onUpdate:modelValue":l[5]||(l[5]=e=>a(u).groupId=e),placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907\u5206\u7EC4",clearable:"",class:"!w-240px"},{default:t(()=>[(d(!0),b(y,null,I(a(E),e=>(d(),n(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(v,null,{default:t(()=>[o(T,{onClick:V},{default:t(()=>[o(j,{class:"mr-5px",icon:"ep:search"}),l[11]||(l[11]=f(" \u641C\u7D22 "))]),_:1}),o(T,{onClick:M},{default:t(()=>[o(j,{class:"mr-5px",icon:"ep:refresh"}),l[12]||(l[12]=f(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(A,null,{default:t(()=>[ye((d(),n(ue,{ref_key:"tableRef",ref:R,data:a(S),"show-overflow-tooltip":!0,stripe:!0,onRowClick:W,onSelectionChange:X},{default:t(()=>[U.multiple?(d(),n(m,{key:0,type:"selection",width:"55"})):(d(),n(m,{key:1,width:"55"},{default:t(e=>[o(oe,{modelValue:a(g),"onUpdate:modelValue":l[6]||(l[6]=i=>K(g)?g.value=i:null),value:e.row.id,onChange:()=>{return i=e.row,void(r.value=[i]);var i}},{default:t(()=>l[13]||(l[13]=[f(" \xA0 ")])),_:2},1032,["modelValue","value","onChange"])]),_:1})),o(m,{label:"DeviceName",align:"center",prop:"deviceName"}),o(m,{label:"\u5907\u6CE8\u540D\u79F0",align:"center",prop:"nickname"}),o(m,{label:"\u6240\u5C5E\u4EA7\u54C1",align:"center",prop:"productId"},{default:t(e=>{var i;return[f(Y(((i=a(x).find(h=>h.id===e.row.productId))==null?void 0:i.name)||"-"),1)]}),_:1}),o(m,{label:"\u8BBE\u5907\u7C7B\u578B",align:"center",prop:"deviceType"},{default:t(e=>[o(B,{type:a(C).IOT_PRODUCT_DEVICE_TYPE,value:e.row.deviceType},null,8,["type","value"])]),_:1}),o(m,{label:"\u6240\u5C5E\u5206\u7EC4",align:"center",prop:"groupId"},{default:t(e=>{var i;return[(i=e.row.groupIds)!=null&&i.length?(d(!0),b(y,{key:0},I(e.row.groupIds,h=>(d(),n(te,{key:h,class:"ml-5px",size:"small"},{default:t(()=>{var G;return[f(Y((G=a(E).find(ne=>ne.id===h))==null?void 0:G.name),1)]}),_:2},1024))),128)):q("",!0)]}),_:1}),o(m,{label:"\u8BBE\u5907\u72B6\u6001",align:"center",prop:"status"},{default:t(e=>[o(B,{type:a(C).IOT_DEVICE_STATE,value:e.row.status},null,8,["type","value"])]),_:1}),o(m,{label:"\u6700\u540E\u4E0A\u7EBF\u65F6\u95F4",align:"center",prop:"onlineTime",formatter:a(Ie),width:"180px"},null,8,["formatter"])]),_:1},8,["data"])),[[ie,a(D)]]),o(de,{limit:a(u).pageSize,"onUpdate:limit":l[7]||(l[7]=e=>a(u).pageSize=e),page:a(u).pageNo,"onUpdate:page":l[8]||(l[8]=e=>a(u).pageNo=e),total:a(P),onPagination:N},null,8,["limit","page","total"])]),_:1})]),_:1},8,["title","modelValue"])}}});export{Re as default};
