import{a as ne,d as oe,u as se,q as ie,_ as re,r as ce,ai as pe,A as k,w as ue,x as de,y as me,t as fe,M as ge,z,aj as we,c as he}from"./index-D_TWD7wt.js";import{_ as _e}from"./Verify-CuMsxnPz.js";import{_ as ye}from"./XButton-D2DbA0bE.js";import{l as xe,r as m,c as be,u as l,j as ve,b as ke,e as Fe,C as Ve,K as Ee,A as F,q as y,B as t,J as a,E as U,Z as Ne,G as p,H as V,x as O,m as Ce,I as Re,$ as je}from"./form-create-_84fGzaM.js";import{u as Le,L as w,_ as Me,a as Se}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-DpnEEzet.js";import{u as E}from"./useIcon-DuY-PePd.js";import{r as N}from"./formRules-DgRLzYxc.js";import{i as Ie,j as Pe,aj as ze,k as Ue,w as Oe,P as Ae,V as Te,h as qe,d as Ge}from"./form-designer-DHHJWkD5.js";const $e={class:"w-full flex justify-between"},Be={class:"w-full flex justify-between"},De=he(xe({name:"LoginForm",__name:"LoginForm",setup(Ke){const{t:c}=ne(),C=oe(),A=E({icon:"ep:house"}),T=E({icon:"ep:avatar"}),q=E({icon:"ep:lock"}),R=m(),{validForm:G}=Se(R),{setLoginState:h,getLoginState:$}=Le(),{currentRoute:B,push:D}=se(),K=ie(),u=m(""),f=m(!1),j=m(),Q=m("blockPuzzle"),H=be(()=>l($)===w.LOGIN),J={tenantName:[N],username:[N],password:[N]},n=ve({isShowPassword:!1,captchaEnable:"false",tenantEnable:"true",loginForm:{tenantName:"saas",username:"admin",password:"asdfasdf3dds@@!",captchaVerification:"",rememberMe:!0}}),W=[{icon:"ant-design:wechat-filled",type:30},{icon:"ant-design:dingtalk-circle-filled",type:20},{icon:"ant-design:github-filled",type:0},{icon:"ant-design:alipay-circle-filled",type:0}],L=async()=>{n.captchaEnable==="false"?await I({}):j.value.show()},M=async()=>{if(n.tenantEnable==="true"){const o=await z(n.loginForm.tenantName);k(o)}},S=m(),I=async o=>{f.value=!0;try{if(await M(),!await G())return;const e={...n.loginForm};e.captchaVerification=o.captchaVerification;const r=await ue(e);if(!r)return;S.value=Ge.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),e.rememberMe?de(e):me(),fe(r),u.value||(u.value="/"),u.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):await D({path:u.value||K.addRouters[0].path})}finally{f.value=!1,S.value.close()}};return ke(()=>B.value,o=>{var e;u.value=(e=o==null?void 0:o.query)==null?void 0:e.redirect},{immediate:!0}),Fe(()=>{(()=>{const o=ce();o&&(n.loginForm={...n.loginForm,username:o.username?o.username:n.loginForm.username,password:o.password?o.password:n.loginForm.password,rememberMe:o.rememberMe,tenantName:o.tenantName?o.tenantName:n.loginForm.tenantName})})(),(async()=>{if(n.tenantEnable==="true"){const o=location.host,e=await pe(o);e&&(n.loginForm.tenantName=e.name,k(e.id))}})()}),(o,e)=>{const r=ze,i=Pe,x=Ue,Z=Oe,g=Ae,b=Ie,_=ye,X=_e,P=Te,Y=re,ee=qe;return Ve((y(),F(ee,{ref_key:"formLogin",ref:R,model:l(n).loginForm,rules:J,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:t(()=>[a(b,{class:"mx-[-10px]"},{default:t(()=>[a(i,{span:24,class:"px-10px"},{default:t(()=>[a(r,null,{default:t(()=>[a(Me,{class:"w-full"})]),_:1})]),_:1}),a(i,{span:24,class:"px-10px"},{default:t(()=>[l(n).tenantEnable==="true"?(y(),F(r,{key:0,prop:"tenantName"},{default:t(()=>[a(x,{modelValue:l(n).loginForm.tenantName,"onUpdate:modelValue":e[0]||(e[0]=s=>l(n).loginForm.tenantName=s),placeholder:l(c)("login.tenantNamePlaceholder"),"prefix-icon":l(A),link:"",type:"primary"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})):U("",!0)]),_:1}),a(i,{span:24,class:"px-10px"},{default:t(()=>[a(r,{prop:"username"},{default:t(()=>[a(x,{modelValue:l(n).loginForm.username,"onUpdate:modelValue":e[1]||(e[1]=s=>l(n).loginForm.username=s),placeholder:l(c)("login.usernamePlaceholder"),"prefix-icon":l(T)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(i,{span:24,class:"px-10px"},{default:t(()=>[a(r,{prop:"password"},{default:t(()=>[a(x,{modelValue:l(n).loginForm.password,"onUpdate:modelValue":e[2]||(e[2]=s=>l(n).loginForm.password=s),placeholder:l(c)("login.passwordPlaceholder"),"prefix-icon":l(q),"show-password":"",type:"password",onKeyup:e[3]||(e[3]=Ne(s=>L(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(i,{span:24,class:"px-10px mt-[-20px] mb-[-20px]"},{default:t(()=>[a(r,null,{default:t(()=>[a(b,{justify:"space-between",style:{width:"100%"}},{default:t(()=>[a(i,{span:6},{default:t(()=>[a(Z,{modelValue:l(n).loginForm.rememberMe,"onUpdate:modelValue":e[4]||(e[4]=s=>l(n).loginForm.rememberMe=s)},{default:t(()=>[p(V(l(c)("login.remember")),1)]),_:1},8,["modelValue"])]),_:1}),a(i,{offset:6,span:12},{default:t(()=>[a(g,{class:"float-right",type:"primary",onClick:e[5]||(e[5]=s=>l(h)(l(w).RESET_PASSWORD))},{default:t(()=>[p(V(l(c)("login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(i,{span:24,class:"px-10px"},{default:t(()=>[a(r,null,{default:t(()=>[a(_,{loading:l(f),title:l(c)("login.login"),class:"w-full",type:"primary",onClick:e[6]||(e[6]=s=>L())},null,8,["loading","title"])]),_:1})]),_:1}),l(n).captchaEnable==="true"?(y(),F(X,{key:0,ref_key:"verify",ref:j,captchaType:l(Q),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:I},null,8,["captchaType"])):U("",!0),a(i,{span:24,class:"px-10px"},{default:t(()=>[a(r,null,{default:t(()=>[a(b,{gutter:5,justify:"space-between",style:{width:"100%"}},{default:t(()=>[a(i,{span:8},{default:t(()=>[a(_,{title:l(c)("login.btnMobile"),class:"w-full",onClick:e[7]||(e[7]=s=>l(h)(l(w).MOBILE))},null,8,["title"])]),_:1}),a(i,{span:8},{default:t(()=>[a(_,{title:l(c)("login.btnQRCode"),class:"w-full",onClick:e[8]||(e[8]=s=>l(h)(l(w).QR_CODE))},null,8,["title"])]),_:1}),a(i,{span:8},{default:t(()=>[a(_,{title:l(c)("login.btnRegister"),class:"w-full",onClick:e[9]||(e[9]=s=>l(h)(l(w).REGISTER))},null,8,["title"])]),_:1})]),_:1})]),_:1})]),_:1}),a(P,{"content-position":"center"},{default:t(()=>[p(V(l(c)("login.otherLogin")),1)]),_:1}),a(i,{span:24,class:"px-10px"},{default:t(()=>[a(r,null,{default:t(()=>[O("div",$e,[(y(),Ce(Re,null,je(W,(s,ae)=>a(Y,{key:ae,icon:s.icon,size:30,class:"anticon cursor-pointer",color:"#999",onClick:Qe=>(async v=>{if(v===0)C.error("\u6B64\u65B9\u5F0F\u672A\u914D\u7F6E");else{if(f.value=!0,n.tenantEnable==="true"&&(await M(),!ge()))try{const d=await C.prompt("\u8BF7\u8F93\u5165\u79DF\u6237\u540D\u79F0",c("common.reminder"));if((d==null?void 0:d.action)!=="confirm")throw"cancel";const te=await z(d.value);k(te)}catch(d){if(d==="cancel")return}finally{f.value=!1}const le=location.origin+"/social-login?"+encodeURIComponent(`type=${v}&redirect=${u.value||"/"}`);window.location.href=await we(v,encodeURIComponent(le))}})(s.type)},null,8,["icon","onClick"])),64))])]),_:1})]),_:1}),a(P,{"content-position":"center"},{default:t(()=>e[10]||(e[10]=[p("\u840C\u65B0\u5FC5\u8BFB")])),_:1}),a(i,{span:24,class:"px-10px"},{default:t(()=>[a(r,null,{default:t(()=>[O("div",Be,[a(g,{href:"https://doc.iocoder.cn/",target:"_blank"},{default:t(()=>e[11]||(e[11]=[p("\u{1F4DA}\u5F00\u53D1\u6307\u5357")])),_:1}),a(g,{href:"https://doc.iocoder.cn/video/",target:"_blank"},{default:t(()=>e[12]||(e[12]=[p("\u{1F525}\u89C6\u9891\u6559\u7A0B")])),_:1}),a(g,{href:"https://www.iocoder.cn/Interview/good-collection/",target:"_blank"},{default:t(()=>e[13]||(e[13]=[p(" \u26A1\u9762\u8BD5\u624B\u518C ")])),_:1}),a(g,{href:"http://static.yudao.iocoder.cn/mp/Aix9975.jpeg",target:"_blank"},{default:t(()=>e[14]||(e[14]=[p(" \u{1F91D}\u5916\u5305\u54A8\u8BE2 ")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[Ee,l(H)]])}}}),[["__scopeId","data-v-5a4fa068"]]);export{De as default};
