import{_ as D,c as M}from"./index-DmQdxAiK.js";import{V as g}from"./vuedraggable.umd-D1BZfJwI.js";import{l as N,c as O,m as i,q as u,I as T,J as m,E as h,u as v,h as j,B as b,x as k,D as V,G as q,H as y}from"./form-create-_84fGzaM.js";import"./form-designer-DHHJWkD5.js";const A={class:"menu_bottom"},B=["onClick"],G={key:0,class:"submenu"},H={class:"menu_bottom subtitle"},J=["onClick"],L=["onClick"],P=M(N({__name:"MenuPreviewer",props:{modelValue:{},activeIndex:{},parentIndex:{},accountId:{}},emits:["update:modelValue","menu-clicked","submenu-clicked"],setup(f,{emit:C}){const d=f,s=C,o=O({get:()=>d.modelValue,set:l=>s("update:modelValue",l)}),E=()=>{const l=o.value.length,n={name:"\u83DC\u5355\u540D\u79F0",children:[],reply:{type:"text",accountId:d.accountId}};o.value[l]=n,I(n,l-1)},I=(l,n)=>{s("menu-clicked",l,n)},x=(l,n,a)=>{s("submenu-clicked",l,n,a)},w=({oldIndex:l,newIndex:n})=>{if(d.activeIndex==="__MENU_NOT_SELECTED__")return;const a=new Array(o.value.length).fill(!1);a[d.parentIndex]=!0;const[e]=a.splice(l,1);a.splice(n,0,e);const t=a.indexOf(!0),c=o.value[t];s("menu-clicked",c,t)},U=({newIndex:l})=>{var t;const n=d.parentIndex,a=l,e=(t=o.value[n])==null?void 0:t.children;if(e&&(e==null?void 0:e.length)>0){const c=e[a];s("submenu-clicked",c,n,a)}};return(l,n)=>{const a=D;return u(),i(T,null,[m(v(g),{modelValue:v(o),"onUpdate:modelValue":n[0]||(n[0]=e=>j(o)?o.value=e:null),"item-key":"id","ghost-class":"draggable-ghost",animation:400,onEnd:w},{item:b(({element:e,index:t})=>[k("div",A,[k("div",{onClick:c=>I(e,t),class:V(["menu_item",{active:d.activeIndex===`${t}`}])},[m(a,{icon:"ep:fold",color:"black"}),q(y(e.name),1)],10,B),d.parentIndex===t&&e.children?(u(),i("div",G,[m(v(g),{modelValue:e.children,"onUpdate:modelValue":c=>e.children=c,"item-key":"id","ghost-class":"draggable-ghost",animation:400,onEnd:U},{item:b(({element:c,index:r})=>[k("div",H,[e.children?(u(),i("div",{key:0,class:V(["menu_subItem",{active:d.activeIndex===`${t}-${r}`}]),onClick:p=>x(c,t,r)},y(c.name),11,J)):h("",!0)])]),_:2},1032,["modelValue","onUpdate:modelValue"]),!e.children||e.children.length<5?(u(),i("div",{key:0,class:"menu_bottom menu_addicon",onClick:c=>((r,p)=>{const _=p.children.length,$={name:"\u5B50\u83DC\u5355\u540D\u79F0",reply:{type:"text",accountId:d.accountId}};p.children[_]=$,x(p.children[_],r,_)})(t,e)},[m(a,{icon:"ep:plus",class:"plus"})],8,L)):h("",!0)])):h("",!0)])]),_:1},8,["modelValue"]),v(o).length<3?(u(),i("div",{key:0,class:"menu_bottom menu_addicon",onClick:E},[m(a,{icon:"ep:plus",class:"plus"})])):h("",!0)],64)}}}),[["__scopeId","data-v-7bc68e28"]]);export{P as default};
