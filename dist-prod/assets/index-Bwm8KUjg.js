import{d as q,u as A,e as D}from"./index-D_TWD7wt.js";import{_ as F,g as G}from"./index-Bjdg_kCb.js";import{u as J}from"./tagsView-CwT_HwtR.js";import{g as P,t as Q}from"./index-BmmFhn4n.js";import{_ as V}from"./ClueForm.vue_vue_type_script_setup_true_lang-CjmA3JXk.js";import{_ as W}from"./ClueDetailsHeader.vue_vue_type_script_setup_true_lang-yamn4cxE.js";import{_ as j}from"./ClueDetailsInfo.vue_vue_type_script_setup_true_lang-CUjRdG9O.js";import{_ as H}from"./PermissionList.vue_vue_type_script_setup_true_lang-TMOVSfdL.js";import{_ as K}from"./TransferForm.vue_vue_type_script_setup_true_lang-Bwfo_4_t.js";import{_ as N}from"./index.vue_vue_type_script_setup_true_lang-CSjlBwjF.js";import{B as f}from"./index-VdMMiVod.js";import{f as X,a0 as Y,$ as Z,j as aa}from"./form-designer-DHHJWkD5.js";import{l as ea,r as s,e as ia,ag as ra,m as ta,q as m,J as e,B as i,C as la,E as U,A as d,u as a,G as c,I as oa}from"./form-create-_84fGzaM.js";import"./formatTime-BGPGB_ys.js";import"./Dialog.vue_vue_type_style_index_0_lang-CJT4CHEp.js";import"./index-DtNLj0dw.js";import"./tree-COGD3qag.js";import"./index-tmtszvF2.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-4_WNC8um.js";import"./DictTag.vue_vue_type_script_lang-BD_Qe0UA.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-CNiXc62E.js";import"./index-DoU43qGs.js";import"./index-BoXj699D.js";import"./index-Cftm-TQu.js";import"./index-DWOJJ8tv.js";import"./index.vue_vue_type_script_setup_true_lang-ZV0RCuCp.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-BJRmdZ3t.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-BQoiLXn_.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-ntvcuEfM.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DRHRD0YZ.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-DlVIFTCR.js";import"./index-CD1V9362.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-ym4qXgXJ.js";import"./index-BKoHmqfi.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-fd7Wm1O7.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CsaJ42-r.js";const sa=ea({name:"CrmClueDetail",__name:"index",setup(ma){const l=s(0),_=s(!0),y=q(),{delView:L}=J(),{currentRoute:M}=A(),u=s(),o=s({}),v=async()=>{_.value=!0;try{o.value=await P(l.value),await x()}finally{_.value=!1}},C=s(),S=()=>{var r;(r=C.value)==null||r.open("update",l.value)},z=s(),$=()=>{var r;(r=z.value)==null||r.open(l.value)},h=async()=>{await y.confirm(`\u786E\u5B9A\u5C06\u3010${o.value.name}\u3011\u8F6C\u5316\u4E3A\u5BA2\u6237\u5417\uFF1F`),await Q(l.value),y.success(`\u8F6C\u5316\u5BA2\u6237\u3010${o.value.name}\u3011\u6210\u529F`),await v()},w=s([]),x=async()=>{const r=await G({bizType:f.CRM_CLUE,bizId:l.value});w.value=r.list},b=()=>{L(a(M))},{params:g}=D();return ia(()=>{if(!g.id)return y.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u7EBF\u7D22\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void b();l.value=g.id,v()}),(r,t)=>{const p=X,n=Z,B=F,I=Y,O=aa,T=ra("hasPermi");return m(),ta(oa,null,[e(W,{clue:a(o),loading:a(_)},{default:i(()=>{var k,R,E;return[(k=a(u))!=null&&k.validateWrite?la((m(),d(p,{key:0,type:"primary",onClick:S},{default:i(()=>t[0]||(t[0]=[c(" \u7F16\u8F91 ")])),_:1})),[[T,["crm:clue:update"]]]):U("",!0),(R=a(u))!=null&&R.validateOwnerUser?(m(),d(p,{key:1,type:"primary",onClick:$},{default:i(()=>t[1]||(t[1]=[c(" \u8F6C\u79FB ")])),_:1})):U("",!0),(E=a(u))!=null&&E.validateOwnerUser&&!a(o).transformStatus?(m(),d(p,{key:2,type:"success",onClick:h},{default:i(()=>t[2]||(t[2]=[c(" \u8F6C\u5316\u4E3A\u5BA2\u6237 ")])),_:1})):(m(),d(p,{key:3,disabled:"",type:"success"},{default:i(()=>t[3]||(t[3]=[c("\u5DF2\u8F6C\u5316\u5BA2\u6237")])),_:1}))]}),_:1},8,["clue","loading"]),e(O,null,{default:i(()=>[e(I,null,{default:i(()=>[e(n,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:i(()=>[e(N,{"biz-id":a(l),"biz-type":a(f).CRM_CLUE},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u57FA\u672C\u4FE1\u606F"},{default:i(()=>[e(j,{clue:a(o)},null,8,["clue"])]),_:1}),e(n,{label:"\u56E2\u961F\u6210\u5458"},{default:i(()=>[e(H,{ref_key:"permissionListRef",ref:u,"biz-id":a(o).id,"biz-type":a(f).CRM_CLUE,"show-action":!0,onQuitTeam:b},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:i(()=>[e(B,{"log-list":a(w)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),e(V,{ref_key:"formRef",ref:C,onSuccess:v},null,512),e(K,{ref_key:"transferFormRef",ref:z,"biz-type":a(f).CRM_CLUE,onSuccess:b},null,8,["biz-type"])],64)}}});export{sa as default};
