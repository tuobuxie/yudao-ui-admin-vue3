import{d as A,u as D,e as G}from"./index-D_TWD7wt.js";import{_ as J,g as L}from"./index-Bjdg_kCb.js";import{u as O}from"./tagsView-CwT_HwtR.js";import{a as P}from"./index-DoU43qGs.js";import{_ as Q}from"./BusinessDetailsHeader.vue_vue_type_script_setup_true_lang-BU8hc8VE.js";import{_ as V}from"./BusinessDetailsInfo.vue_vue_type_script_setup_true_lang-CKCzy7Uf.js";import{_ as H}from"./PermissionList.vue_vue_type_script_setup_true_lang-TMOVSfdL.js";import{B as m}from"./index-VdMMiVod.js";import{_ as K}from"./BusinessForm.vue_vue_type_script_setup_true_lang-DlVIFTCR.js";import{_ as X}from"./TransferForm.vue_vue_type_script_setup_true_lang-Bwfo_4_t.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-CSjlBwjF.js";import{_ as $}from"./ContactList.vue_vue_type_script_setup_true_lang-QcAYI2qT.js";import{_ as Z}from"./BusinessUpdateStatusForm.vue_vue_type_script_setup_true_lang-CDASnbYj.js";import{_ as ii}from"./ContractList.vue_vue_type_script_setup_true_lang-C2hxsaAJ.js";import{_ as ei}from"./BusinessProductList.vue_vue_type_script_setup_true_lang-CcEmtyjj.js";import{ak as ai,f as ri,a0 as si,$ as ti,j as oi}from"./form-designer-DHHJWkD5.js";import{l as li,r as t,e as mi,m as ui,q as u,C as pi,J as e,u as i,A as d,B as r,E as c,G as z,I as ni}from"./form-create-_84fGzaM.js";import"./formatTime-BGPGB_ys.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-4_WNC8um.js";import"./DictTag.vue_vue_type_script_lang-BD_Qe0UA.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-CNiXc62E.js";import"./Dialog.vue_vue_type_style_index_0_lang-CJT4CHEp.js";import"./index-tmtszvF2.js";import"./index-CD1V9362.js";import"./index-Cftm-TQu.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-ym4qXgXJ.js";import"./index-BKoHmqfi.js";import"./index-BmmFhn4n.js";import"./index-BoXj699D.js";import"./index-DWOJJ8tv.js";import"./index.vue_vue_type_script_setup_true_lang-ZV0RCuCp.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-BJRmdZ3t.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-BQoiLXn_.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-ntvcuEfM.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DRHRD0YZ.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-fd7Wm1O7.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CsaJ42-r.js";import"./index-DtNLj0dw.js";import"./tree-COGD3qag.js";import"./ContractForm.vue_vue_type_script_setup_true_lang-BA_4hEpN.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-rTB5-jmN.js";const di=li({name:"CrmBusinessDetail",__name:"index",setup(fi){const M=A(),p=t(0),f=t(!0),a=t({}),n=t(),b=async()=>{f.value=!0;try{a.value=await P(p.value),await g(p.value)}finally{f.value=!1}},S=t(),v=t(),C=t(),N=()=>{var l;(l=C.value)==null||l.open(a.value.id)},k=t([]),g=async l=>{if(!l)return;const s=await L({bizType:m.CRM_BUSINESS,bizId:l});k.value=s.list},{delView:x}=O(),{currentRoute:F}=D(),_=()=>{x(i(F))},{params:R}=G();return mi(async()=>{if(!R.id)return M.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5546\u673A\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void _();p.value=R.id,await b()}),(l,s)=>{const y=ri,o=ti,T=J,W=si,h=oi,j=ai;return u(),ui(ni,null,[pi((u(),d(Q,{business:i(a)},{default:r(()=>{var B,I,w;return[(B=i(n))!=null&&B.validateWrite?(u(),d(y,{key:0,onClick:s[0]||(s[0]=q=>{return E="update",U=i(a).id,void S.value.open(E,U);var E,U})},{default:r(()=>s[2]||(s[2]=[z(" \u7F16\u8F91 ")])),_:1})):c("",!0),(I=i(n))!=null&&I.validateWrite?(u(),d(y,{key:1,disabled:i(a).endStatus,type:"success",onClick:s[1]||(s[1]=q=>{v.value.open(a.value)})},{default:r(()=>s[3]||(s[3]=[z(" \u53D8\u66F4\u5546\u673A\u72B6\u6001 ")])),_:1},8,["disabled"])):c("",!0),(w=i(n))!=null&&w.validateOwnerUser?(u(),d(y,{key:2,type:"primary",onClick:N},{default:r(()=>s[4]||(s[4]=[z(" \u8F6C\u79FB ")])),_:1})):c("",!0)]}),_:1},8,["business"])),[[j,i(f)]]),e(h,null,{default:r(()=>[e(W,null,{default:r(()=>[e(o,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:r(()=>[e(Y,{"biz-id":i(p),"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:r(()=>[e(V,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u8054\u7CFB\u4EBA",lazy:""},{default:r(()=>[e($,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"business-id":i(a).id,"customer-id":i(a).customerId},null,8,["biz-id","biz-type","business-id","customer-id"])]),_:1}),e(o,{label:"\u4EA7\u54C1"},{default:r(()=>[e(ei,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u5408\u540C",lazy:""},{default:r(()=>[e(ii,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:r(()=>[e(T,{"log-list":i(k)},null,8,["log-list"])]),_:1}),e(o,{label:"\u56E2\u961F\u6210\u5458"},{default:r(()=>[e(H,{ref_key:"permissionListRef",ref:n,"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"show-action":!0,onQuitTeam:_},null,8,["biz-id","biz-type"])]),_:1})]),_:1})]),_:1}),e(K,{ref_key:"formRef",ref:S,onSuccess:b},null,512),e(Z,{ref_key:"statusFormRef",ref:v,onSuccess:b},null,512),e(X,{ref_key:"transferFormRef",ref:C,"biz-type":i(m).CRM_BUSINESS,onSuccess:_},null,8,["biz-type"])],64)}}});export{di as default};
