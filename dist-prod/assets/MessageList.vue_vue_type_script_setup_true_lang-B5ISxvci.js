import{d as j,aG as N,b as W}from"./index-DzK2S43K.js";import{f as M}from"./formatTime-BGPGB_ys.js";import{M as J,_ as $}from"./MessageReasoning-BTfXvaVF.js";import{_ as F}from"./MessageKnowledge.vue_vue_type_script_setup_true_lang-C7hE13Uu.js";import{_ as z}from"./MessageFiles.vue_vue_type_script_setup_true_lang-BTZtHKCY.js";import K from"./MessageWebSearch-CZrP-37t.js";import{ah as X,a7 as Z,f as Q,b as e2,aR as l2,aM as a2,aY as s2}from"./form-designer-DHHJWkD5.js";import{C as t2}from"./index-H5W3Tj9_.js";import{a as r2}from"./avatar-BG6NdH5s.js";import{r as c2}from"./gpt-WhTktY3S.js";import{l as o2,r as H,c as T,a5 as n2,e as i2,m as i,q as t,x as a,E as p,I as V,$ as p2,J as l,u as o,B as c,G as D,H as u,A as w,n as h2}from"./form-create-_84fGzaM.js";const G="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715352878351'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1499'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M624.5%20786.3c92.9%200%20168.2-75.3%20168.2-168.2V309c0-92.4-75.3-168.2-168.2-168.2H303.6c-92.4%200-168.2%2075.3-168.2%20168.2v309.1c0%2092.4%2075.3%20168.2%20168.2%20168.2h320.9zM178.2%20618.1V309c0-69.4%2056.1-125.5%20125.5-125.5h320.9c69.4%200%20125.5%2056.1%20125.5%20125.5v309.1c0%2069.4-56.1%20125.5-125.5%20125.5h-321c-69.4%200-125.4-56.1-125.4-125.5z'%20p-id='1500'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M849.8%20295.1v361.5c0%20102.7-83.6%20186.3-186.3%20186.3H279.1v42.7h384.4c126.3%200%20229.1-102.8%20229.1-229.1V295.1h-42.8zM307.9%20361.8h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4zM307.9%20484.6h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4z'%20p-id='1501'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M620.2%20607.4c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.8%209.6%2021.4%2021.4%2021.4h312.3z'%20p-id='1502'%20fill='%238a8a8a'%3e%3c/path%3e%3c/svg%3e",E="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715354120346'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3256'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M907.1%20263.7H118.9c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4H907c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3257'%3e%3c/path%3e%3cpath%20d='M772.5%20928.3H257.4c-27.7%200-50.2-22.5-50.2-50.2V247.2c0-9.1%207.3-16.4%2016.4-16.4H801c12.1%200%2021.9%209.8%2021.9%2021.9v625.2c0%2027.8-22.6%2050.4-50.4%2050.4zM240%20263.7v614.4c0%209.6%207.8%2017.4%2017.4%2017.4h515.2c9.7%200%2017.5-7.9%2017.5-17.5V263.7H240zM657.4%20131.1H368.6c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4h288.7c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3258'%3e%3c/path%3e%3cpath%20d='M416%20754.5c-9.1%200-16.4-7.3-16.4-16.4V517.8c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0.1%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20p-id='3259'%3e%3c/path%3e%3cpath%20d='M416%20465.2c-9.1%200-16.4-7.3-16.4-16.4v-59.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v59.4c0.1%209.1-7.3%2016.4-16.4%2016.4zM604.9%20754.5c-9.1%200-16.4-7.3-16.4-16.4v-67.2c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20opacity='.4'%20p-id='3260'%3e%3c/path%3e%3cpath%20d='M604.9%20619.1c-9.1%200-16.4-7.3-16.4-16.4V389.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v213.3c0%209.1-7.3%2016.4-16.4%2016.4z'%20fill='%238a8a8a'%20p-id='3261'%3e%3c/path%3e%3c/svg%3e",v2={key:0,class:"flex flex-row mt-50px"},f2={class:"avatar"},d2={class:"flex flex-col text-left mx-15px"},x2={class:"flex flex-row mt-8px"},m2={key:1,class:"flex flex-row-reverse justify-start mt-50px"},g2={class:"avatar"},u2={class:"flex flex-col text-left mx-15px"},w2={key:0,class:"flex flex-row-reverse mb-8px"},k2={class:"flex flex-row-reverse"},y2={key:0,class:"text-[0.95rem] text-[var(--el-color-white)] inline bg-[var(--el-color-primary)] shadow-[0_0_0_1px_var(--el-color-primary)] rounded-10px p-10px w-auto break-words whitespace-pre-wrap"},b2={class:"flex flex-row-reverse mt-8px"},_2=o2({__name:"MessageList",props:{conversation:{type:Object,required:!0},list:{type:Array,required:!0}},emits:["onDeleteSuccess","onRefresh","onEdit"],setup(S,{expose:B,emit:P}){const k=j(),{copy:U}=N(),L=W(),n=H(null),x=H(!1),R=T(()=>L.user.avatar||r2),q=T(()=>y.conversation.roleAvatar??c2),y=S,{list:A}=n2(y),m=P;function I(){const s=n.value,r=s.scrollTop,f=s.scrollHeight,d=s.offsetHeight;x.value=r+d<f-100}const O=async()=>{const s=n.value;s.scrollTop=s.scrollHeight};B({scrollToBottom:async s=>{await h2(),!s&&x.value||(n.value.scrollTop=n.value.scrollHeight-n.value.offsetHeight)},handlerGoTop:async()=>{n.value.scrollTop=0}});const b=async s=>{await U(s),k.success("\u590D\u5236\u6210\u529F\uFF01")},_=async s=>{await t2.deleteChatMessage(s),k.success("\u5220\u9664\u6210\u529F\uFF01"),m("onDeleteSuccess")};return i2(async()=>{n.value.addEventListener("scroll",I)}),(s,r)=>{const f=X,d=Z,h=Q,C=e2;return t(),i(V,null,[a("div",{ref_key:"messageContainer",ref:n,class:"h-100% overflow-y-auto relative"},[(t(!0),i(V,null,p2(o(A),(e,Y)=>(t(),i("div",{class:"flex flex-col overflow-y-hidden px-20px",key:Y},[e.type!=="user"?(t(),i("div",v2,[a("div",f2,[l(f,{src:o(q)},null,8,["src"])]),a("div",d2,[a("div",null,[l(d,{class:"text-left leading-30px"},{default:c(()=>[D(u(o(M)(e.createTime)),1)]),_:2},1024)]),a("div",{class:"relative flex flex-col break-words bg-[var(--el-fill-color-light)] shadow-[0_0_0_1px_var(--el-border-color-light)] rounded-10px pt-10px px-10px pb-5px",ref_for:!0,ref:"markdownViewRef"},[l(J,{"reasoning-content":e.reasoningContent||"",content:e.content||""},null,8,["reasoning-content","content"]),l($,{class:"text-[var(--el-text-color-primary)] text-[0.95rem]",content:e.content},null,8,["content"]),l(z,{"attachment-urls":e.attachmentUrls},null,8,["attachment-urls"]),e.segments?(t(),w(F,{key:0,segments:e.segments},null,8,["segments"])):p("",!0),e.webSearchPages?(t(),w(K,{key:1,"web-search-pages":e.webSearchPages},null,8,["web-search-pages"])):p("",!0)],512),a("div",x2,[l(h,{class:"flex bg-transparent items-center hover:cursor-pointer hover:bg-[var(--el-fill-color-lighter)]",link:"",onClick:v=>b(e.content)},{default:c(()=>r[0]||(r[0]=[a("img",{class:"h-20px",src:G},null,-1)])),_:2},1032,["onClick"]),e.id>0?(t(),w(h,{key:0,class:"flex bg-transparent items-center hover:cursor-pointer hover:bg-[var(--el-fill-color-lighter)]",link:"",onClick:v=>_(e.id)},{default:c(()=>r[1]||(r[1]=[a("img",{class:"h-17px",src:E},null,-1)])),_:2},1032,["onClick"])):p("",!0)])])])):p("",!0),e.type==="user"?(t(),i("div",m2,[a("div",g2,[l(f,{src:o(R)},null,8,["src"])]),a("div",u2,[a("div",null,[l(d,{class:"text-left leading-30px"},{default:c(()=>[D(u(o(M)(e.createTime)),1)]),_:2},1024)]),e.attachmentUrls&&e.attachmentUrls.length>0?(t(),i("div",w2,[l(z,{"attachment-urls":e.attachmentUrls},null,8,["attachment-urls"])])):p("",!0),a("div",k2,[e.content&&e.content.trim()?(t(),i("div",y2,u(e.content),1)):p("",!0)]),a("div",b2,[l(h,{class:"flex bg-transparent items-center hover:cursor-pointer hover:bg-[var(--el-fill-color-lighter)]",link:"",onClick:v=>b(e.content)},{default:c(()=>r[2]||(r[2]=[a("img",{class:"h-20px",src:G},null,-1)])),_:2},1032,["onClick"]),l(h,{class:"flex bg-transparent items-center hover:cursor-pointer hover:bg-[var(--el-fill-color-lighter)]",link:"",onClick:v=>_(e.id)},{default:c(()=>r[3]||(r[3]=[a("img",{class:"h-17px mr-12px",src:E},null,-1)])),_:2},1032,["onClick"]),l(h,{class:"flex bg-transparent items-center hover:cursor-pointer hover:bg-[var(--el-fill-color-lighter)]",link:"",onClick:v=>(async g=>{m("onRefresh",g)})(e)},{default:c(()=>[l(C,{size:"17"},{default:c(()=>[l(o(l2))]),_:1})]),_:2},1032,["onClick"]),l(h,{class:"flex bg-transparent items-center hover:cursor-pointer hover:bg-[var(--el-fill-color-lighter)]",link:"",onClick:v=>(async g=>{m("onEdit",g)})(e)},{default:c(()=>[l(C,{size:"17"},{default:c(()=>[l(o(a2))]),_:1})]),_:2},1032,["onClick"])])])])):p("",!0)]))),128))],512),o(x)?(t(),i("div",{key:0,class:"absolute z-1000 bottom-0 right-50%",onClick:O},[l(h,{icon:o(s2),circle:""},null,8,["icon"])])):p("",!0)],64)}}});export{_2 as _};
