import{a as z,d as B,b as E,h as x,D as R}from"./index-DzK2S43K.js";import{_ as H}from"./Dialog.vue_vue_type_style_index_0_lang-D3YOFsHs.js";import{a as K,c as L,u as W}from"./index-Cw8Ai6YR.js";import{g as X}from"./index-DCjsvoDj.js";import{h as Y,d as Z}from"./tree-COGD3qag.js";import{g as ee}from"./index-xS-5DhXp.js";import{h as le,i as ae,j as oe,aj as se,k as ue,x as de,Q as re,m as te,l as ie,ak as ne,f as pe}from"./form-designer-DHHJWkD5.js";import{l as me,r as i,j as ce,e as ve,A as c,q as n,B as s,C as fe,u as l,J as o,m as V,I as U,$ as w,G as T,h as _e}from"./form-create-_84fGzaM.js";const be=me({name:"CrmProductForm",__name:"ProductForm",emits:["success"],setup(ge,{expose:j,emit:D}){const{t:f}=z(),y=B(),p=i(!1),I=i(""),m=i(!1),h=i(""),P=E().getUser.id,u=i({id:void 0,name:void 0,no:void 0,unit:void 0,price:NaN,status:void 0,categoryId:void 0,description:void 0,ownerUserId:-1}),S=ce({name:[{required:!0,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],no:[{required:!0,message:"\u4EA7\u54C1\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],categoryId:[{required:!0,message:"\u4EA7\u54C1\u5206\u7C7BID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ownerUserId:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],price:[{required:!0,message:"\u4EF7\u683C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),v=i();j({open:async(d,a)=>{if(p.value=!0,I.value=f("action."+d),h.value=d,O(),a){m.value=!0;try{u.value=await K(a)}finally{m.value=!1}}else u.value.ownerUserId=P}});const F=D,N=async()=>{if(v&&await v.value.validate()){m.value=!0;try{const d=u.value;h.value==="create"?(await L(d),y.success(f("common.createSuccess"))):(await W(d),y.success(f("common.updateSuccess"))),p.value=!1,F("success")}finally{m.value=!1}}},O=()=>{var d;u.value={id:void 0,name:void 0,no:void 0,unit:void 0,price:NaN,status:void 0,categoryId:void 0,description:void 0,ownerUserId:-1},(d=v.value)==null||d.resetFields()},k=i([]),C=i([]);return ve(async()=>{const d=await X({});k.value=Y(d,"id","parentId"),C.value=await ee()}),(d,a)=>{const _=ue,r=se,t=oe,b=re,g=de,A=te,M=ie,G=ae,J=le,q=pe,Q=H,$=ne;return n(),c(Q,{title:l(I),modelValue:l(p),"onUpdate:modelValue":a[9]||(a[9]=e=>_e(p)?p.value=e:null)},{footer:s(()=>[o(q,{onClick:N,type:"primary",disabled:l(m)},{default:s(()=>a[10]||(a[10]=[T("\u786E \u5B9A")])),_:1},8,["disabled"]),o(q,{onClick:a[8]||(a[8]=e=>p.value=!1)},{default:s(()=>a[11]||(a[11]=[T("\u53D6 \u6D88")])),_:1})]),default:s(()=>[fe((n(),c(J,{ref_key:"formRef",ref:v,model:l(u),rules:l(S),"label-width":"100px"},{default:s(()=>[o(G,null,{default:s(()=>[o(t,{span:12},{default:s(()=>[o(r,{label:"\u4EA7\u54C1\u540D\u79F0",prop:"name"},{default:s(()=>[o(_,{modelValue:l(u).name,"onUpdate:modelValue":a[0]||(a[0]=e=>l(u).name=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),o(t,{span:12},{default:s(()=>[o(r,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserId"},{default:s(()=>[o(g,{modelValue:l(u).ownerUserId,"onUpdate:modelValue":a[1]||(a[1]=e=>l(u).ownerUserId=e),placeholder:"\u8BF7\u9009\u62E9\u8D1F\u8D23\u4EBA",disabled:l(u).id,class:"w-1/1"},{default:s(()=>[(n(!0),V(U,null,w(l(C),e=>(n(),c(b,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),o(t,{span:12},{default:s(()=>[o(r,{label:"\u4EA7\u54C1\u7C7B\u578B",prop:"categoryId"},{default:s(()=>[o(A,{modelValue:l(u).categoryId,"onUpdate:modelValue":a[2]||(a[2]=e=>l(u).categoryId=e),options:l(k),props:l(Z),class:"w-1/1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1\u7C7B\u578B",filterable:""},null,8,["modelValue","options","props"])]),_:1})]),_:1}),o(t,{span:12},{default:s(()=>[o(r,{label:"\u4EA7\u54C1\u5355\u4F4D",prop:"unit"},{default:s(()=>[o(g,{modelValue:l(u).unit,"onUpdate:modelValue":a[3]||(a[3]=e=>l(u).unit=e),class:"w-1/1",placeholder:"\u8BF7\u9009\u62E9\u5355\u4F4D"},{default:s(()=>[(n(!0),V(U,null,w(l(x)(l(R).CRM_PRODUCT_UNIT),e=>(n(),c(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(t,{span:12},{default:s(()=>[o(r,{label:"\u4EA7\u54C1\u7F16\u7801",prop:"no"},{default:s(()=>[o(_,{modelValue:l(u).no,"onUpdate:modelValue":a[4]||(a[4]=e=>l(u).no=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u7F16\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),o(t,{span:12},{default:s(()=>[o(r,{label:"\u4EF7\u683C",prop:"price"},{default:s(()=>[o(M,{modelValue:l(u).price,"onUpdate:modelValue":a[5]||(a[5]=e=>l(u).price=e),placeholder:"\u8BF7\u8F93\u5165\u4EF7\u683C",min:0,precision:2,step:.1,class:"w-full!"},null,8,["modelValue"])]),_:1})]),_:1}),o(t,{span:12},{default:s(()=>[o(r,{label:"\u4EA7\u54C1\u63CF\u8FF0",prop:"description"},{default:s(()=>[o(_,{modelValue:l(u).description,"onUpdate:modelValue":a[6]||(a[6]=e=>l(u).description=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u63CF\u8FF0"},null,8,["modelValue"])]),_:1})]),_:1}),o(t,{span:12},{default:s(()=>[o(r,{label:"\u4E0A\u67B6\u72B6\u6001",prop:"status"},{default:s(()=>[o(g,{modelValue:l(u).status,"onUpdate:modelValue":a[7]||(a[7]=e=>l(u).status=e),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",class:"w-1/1"},{default:s(()=>[(n(!0),V(U,null,w(l(x)(l(R).CRM_PRODUCT_STATUS),e=>(n(),c(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[$,l(m)]])]),_:1},8,["title","modelValue"])}}});export{be as _};
