import{p as O}from"./index-DzK2S43K.js";import{T as e}from"./index-s3lOz2Xx.js";import{a as i}from"./consts-CvaDWb4S.js";import{_ as v}from"./simple-process-designer-CF_0mCEZ.js";import{u as I}from"./node-CVgg3tbr.js";import{l as E,r as u,b as T,A as f,q as m,u as y,p as A,C as P,m as D,J as V}from"./form-create-_84fGzaM.js";import{ak as w}from"./form-designer-DHHJWkD5.js";const C=E({name:"SimpleProcessViewer",__name:"SimpleProcessViewer",props:{flowNode:{type:Object,required:!0},tasks:{type:Array,default:()=>[]},processInstance:{type:Object,default:()=>{}}},setup(N){const c=N,r=u(c.tasks),p=u(c.processInstance),S=I(c);return T(()=>c.tasks,o=>{r.value=o}),T(()=>c.processInstance,o=>{p.value=o}),A("tasks",r),A("processInstance",p),(o,t)=>{const s=v;return m(),f(s,{"flow-node":y(S),readonly:!0},null,8,["flow-node"])}}}),k={class:"process-viewer-container"},L=E({name:"BpmProcessInstanceSimpleViewer",__name:"ProcessInstanceSimpleViewer",props:{loading:O.bool.def(!1),modelView:O.object,simpleJson:O.string},setup(N){const c=N,r=u({}),p=u([]),S=u();T(()=>c.modelView,async t=>{var s;if(t){p.value=t.tasks,S.value=t.processInstance;const n=t.rejectedTaskActivityIds,l=t.unfinishedTaskActivityIds,a=t.finishedTaskActivityIds,d=t.finishedSequenceFlowActivityIds;o(t.simpleModel,(s=t.processInstance)==null?void 0:s.status,n,l,a,d),r.value=t.simpleModel?t.simpleModel:{}}}),T(()=>c.simpleJson,async t=>{t&&(r.value=JSON.parse(t))});const o=(t,s,n,l,a,d)=>{var _;t&&(t.type!==i.END_EVENT_NODE?(t.type!==i.START_USER_NODE&&t.type!==i.USER_TASK_NODE&&t.type!==i.TRANSACTOR_NODE&&t.type!==i.CHILD_PROCESS_NODE||(t.activityStatus=e.NOT_START,n.includes(t.id)?t.activityStatus=e.REJECT:l.includes(t.id)?t.activityStatus=e.RUNNING:a.includes(t.id)&&(t.activityStatus=e.APPROVE)),t.type===i.COPY_TASK_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.DELAY_TIMER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.TRIGGER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.CONDITION_NODE&&(d.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type!==i.CONDITION_BRANCH_NODE&&t.type!==i.PARALLEL_BRANCH_NODE&&t.type!==i.INCLUSIVE_BRANCH_NODE&&t.type!==i.ROUTER_BRANCH_NODE||(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START,(_=t.conditionNodes)==null||_.forEach(R=>{o(R,s,n,l,a,d)})),o(t.childNode,s,n,l,a,d)):a.includes(t.id)?t.activityStatus=s:t.activityStatus=e.NOT_START)};return(t,s)=>{const n=w;return P((m(),D("div",k,[V(y(C),{"flow-node":y(r),tasks:y(p),"process-instance":y(S)},null,8,["flow-node","tasks","process-instance"])])),[[n,N.loading]])}}});export{L as _};
