import{d as Z,u as H,e as Q,a as $,h as W,D as X,_ as Y}from"./index-B2urM1q-.js";import{_ as ee}from"./index.vue_vue_type_script_setup_true_lang-Cj0jlW8o.js";import{_ as ae}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BRGqERh7.js";import{l as te,r as f,j as le,e as oe,ag as ne,m as B,q as d,J as e,B as l,u as o,Z as se,I as D,$ as re,A as g,C as _,G as u,x as L,H as de}from"./form-create-_84fGzaM.js";import{d as ie}from"./formatTime-BGPGB_ys.js";import{K as C}from"./index-BUi5Jgs2.js";import{_ as ue}from"./KnowledgeSegmentForm.vue_vue_type_script_setup_true_lang-8mbhiXFO.js";import{C as b}from"./constants-C3gLHYOK.js";import{c as pe}from"./permission-BEHR5baN.js";import{h as ce,aj as me,k as fe,x as ge,Q as we,f as _e,Z as be,_ as he,D as ve,ak as xe}from"./form-designer-DHHJWkD5.js";import"./Dialog.vue_vue_type_style_index_0_lang-bMayE4GC.js";const ye={class:"content-expand",style:{padding:"10px 20px","white-space":"pre-wrap","line-height":"1.5","background-color":"#f9f9f9","border-radius":"4px","border-left":"3px solid #409eff"}},ke=te({name:"KnowledgeSegment",__name:"index",setup(Ce){const p=Z(),q=H(),S=Q(),{t:I}=$(),h=f(!0),V=f([]),N=f(0),n=le({pageNo:1,pageSize:10,documentId:void 0,content:void 0,status:void 0}),A=f(),i=async()=>{h.value=!0;try{const c=await C.getKnowledgeSegmentPage(n);V.value=c.list,N.value=c.total}finally{h.value=!1}},v=()=>{n.pageNo=1,i()},z=()=>{A.value.resetFields(),v()},E=f(),K=(c,a)=>{E.value.open(c,a,n.documentId)};return oe(()=>{if(!S.query.documentId)return p.error("\u6587\u6863 ID \u4E0D\u5B58\u5728\uFF0C\u65E0\u6CD5\u67E5\u770B\u5206\u6BB5\u5217\u8868"),void q.push({name:"AiKnowledgeDocument"});n.documentId=S.query.documentId,i()}),(c,a)=>{const M=fe,x=me,P=we,T=ge,y=Y,m=_e,j=ce,U=ae,s=he,F=ve,G=be,J=ee,k=ne("hasPermi"),O=xe;return d(),B(D,null,[e(U,null,{default:l(()=>[e(j,{class:"-mb-15px",model:o(n),ref_key:"queryFormRef",ref:A,inline:!0,"label-width":"68px"},{default:l(()=>[e(x,{label:"\u6587\u6863\u7F16\u53F7",prop:"documentId"},{default:l(()=>[e(M,{modelValue:o(n).documentId,"onUpdate:modelValue":a[0]||(a[0]=t=>o(n).documentId=t),placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u7F16\u53F7",clearable:"",onKeyup:se(v,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(x,{label:"\u662F\u5426\u542F\u7528",prop:"status"},{default:l(()=>[e(T,{modelValue:o(n).status,"onUpdate:modelValue":a[1]||(a[1]=t=>o(n).status=t),placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u542F\u7528",clearable:"",class:"!w-240px"},{default:l(()=>[(d(!0),B(D,null,re(o(W)(o(X).COMMON_STATUS),t=>(d(),g(P,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:l(()=>[e(m,{onClick:v},{default:l(()=>[e(y,{icon:"ep:search",class:"mr-5px"}),a[5]||(a[5]=u(" \u641C\u7D22"))]),_:1}),e(m,{onClick:z},{default:l(()=>[e(y,{icon:"ep:refresh",class:"mr-5px"}),a[6]||(a[6]=u(" \u91CD\u7F6E"))]),_:1}),_((d(),g(m,{type:"primary",plain:"",onClick:a[2]||(a[2]=t=>K("create"))},{default:l(()=>[e(y,{icon:"ep:plus",class:"mr-5px"}),a[7]||(a[7]=u(" \u65B0\u589E "))]),_:1})),[[k,["ai:knowledge:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(U,null,{default:l(()=>[_((d(),g(G,{data:o(V),stripe:!0,"show-overflow-tooltip":!0},{default:l(()=>[e(s,{label:"\u5206\u6BB5\u7F16\u53F7",align:"center",prop:"id"}),e(s,{type:"expand"},{default:l(t=>[L("div",ye,[a[8]||(a[8]=L("div",{class:"content-title",style:{"margin-bottom":"8px",color:"#606266","font-size":"14px","font-weight":"bold"}}," \u5B8C\u6574\u5185\u5BB9\uFF1A ",-1)),u(" "+de(t.row.content),1)])]),_:1}),e(s,{label:"\u5207\u7247\u5185\u5BB9",align:"center",prop:"content","min-width":"250px","show-overflow-tooltip":!0}),e(s,{label:"\u5B57\u7B26\u6570",align:"center",prop:"contentLength"}),e(s,{label:"token \u6570\u91CF",align:"center",prop:"tokens"}),e(s,{label:"\u53EC\u56DE\u6B21\u6570",align:"center",prop:"retrievalCount"}),e(s,{label:"\u662F\u5426\u542F\u7528",align:"center",prop:"status"},{default:l(t=>[e(F,{modelValue:t.row.status,"onUpdate:modelValue":w=>t.row.status=w,"active-value":0,"inactive-value":1,onChange:w=>(async r=>{try{const R=r.status===b.ENABLE?"\u542F\u7528":"\u7981\u7528";await p.confirm('\u786E\u8BA4\u8981"'+R+'"\u8BE5\u5206\u6BB5\u5417?'),await C.updateKnowledgeSegmentStatus({id:r.id,status:r.status}),p.success(I("common.updateSuccess")),await i()}catch{r.status=r.status===b.ENABLE?b.DISABLE:b.ENABLE}})(t.row),disabled:!o(pe)(["ai:knowledge:update"])},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])]),_:1}),e(s,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:o(ie),width:"180px"},null,8,["formatter"]),e(s,{label:"\u64CD\u4F5C",align:"center","min-width":"120px"},{default:l(t=>[_((d(),g(m,{link:"",type:"primary",onClick:w=>K("update",t.row.id)},{default:l(()=>a[9]||(a[9]=[u(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:update"]]]),_((d(),g(m,{link:"",type:"danger",onClick:w=>(async r=>{try{await p.delConfirm(),await C.deleteKnowledgeSegment(r),p.success(I("common.delSuccess")),await i()}catch{}})(t.row.id)},{default:l(()=>a[10]||(a[10]=[u(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:delete"]]])]),_:1})]),_:1},8,["data"])),[[O,o(h)]]),e(J,{total:o(N),page:o(n).pageNo,"onUpdate:page":a[3]||(a[3]=t=>o(n).pageNo=t),limit:o(n).pageSize,"onUpdate:limit":a[4]||(a[4]=t=>o(n).pageSize=t),onPagination:i},null,8,["total","page","limit"])]),_:1}),e(ue,{ref_key:"formRef",ref:E,onSuccess:i},null,512)],64)}}});export{ke as default};
