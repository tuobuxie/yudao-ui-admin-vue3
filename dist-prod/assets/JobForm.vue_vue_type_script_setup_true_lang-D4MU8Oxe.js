import{a as P,d as T}from"./index-DzK2S43K.js";import{_ as F}from"./Dialog.vue_vue_type_style_index_0_lang-D3YOFsHs.js";import{C as J}from"./Crontab-DJGnk6yY.js";import{g as R,c as j,u as O}from"./index-D0_oxc2N.js";import{h as S,aj as A,k as B,ak as G,f as z}from"./form-designer-DHHJWkD5.js";import{l as D,r as i,j as H,A as h,q as g,B as t,C as K,u as l,J as o,G as _,h as L}from"./form-create-_84fGzaM.js";const M=D({name:"JobForm",__name:"JobForm",emits:["success"],setup(Q,{expose:b,emit:C}){const{t:c}=P(),v=T(),n=i(!1),f=i(""),m=i(!1),V=i(""),a=i({id:void 0,name:"",handlerName:"",handlerParam:"",cronExpression:"",retryCount:void 0,retryInterval:void 0,monitorTimeout:void 0}),x=H({name:[{required:!0,message:"\u4EFB\u52A1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],handlerName:[{required:!0,message:"\u5904\u7406\u5668\u7684\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],cronExpression:[{required:!0,message:"CRON \u8868\u8FBE\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],retryCount:[{required:!0,message:"\u91CD\u8BD5\u6B21\u6570\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],retryInterval:[{required:!0,message:"\u91CD\u8BD5\u95F4\u9694\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),p=i();b({open:async(u,e)=>{if(n.value=!0,f.value=c("action."+u),V.value=u,q(),e){m.value=!0;try{a.value=await R(e)}finally{m.value=!1}}}});const N=C,U=async()=>{if(p&&await p.value.validate()){m.value=!0;try{const u=a.value;V.value==="create"?(await j(u),v.success(c("common.createSuccess"))):(await O(u),v.success(c("common.updateSuccess"))),n.value=!1,N("success")}finally{m.value=!1}}},q=()=>{var u;a.value={id:void 0,name:"",handlerName:"",handlerParam:"",cronExpression:"",retryCount:void 0,retryInterval:void 0,monitorTimeout:void 0},(u=p.value)==null||u.resetFields()};return(u,e)=>{const s=B,d=A,E=J,I=S,y=z,k=F,w=G;return g(),h(k,{title:l(f),modelValue:l(n),"onUpdate:modelValue":e[8]||(e[8]=r=>L(n)?n.value=r:null)},{footer:t(()=>[o(y,{type:"primary",onClick:U,loading:l(m)},{default:t(()=>e[9]||(e[9]=[_("\u786E \u5B9A")])),_:1},8,["loading"]),o(y,{onClick:e[7]||(e[7]=r=>n.value=!1)},{default:t(()=>e[10]||(e[10]=[_("\u53D6 \u6D88")])),_:1})]),default:t(()=>[K((g(),h(I,{ref_key:"formRef",ref:p,model:l(a),rules:l(x),"label-width":"120px"},{default:t(()=>[o(d,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"name"},{default:t(()=>[o(s,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=r=>l(a).name=r),placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(d,{label:"\u5904\u7406\u5668\u7684\u540D\u5B57",prop:"handlerName"},{default:t(()=>[o(s,{readonly:l(a).id!==void 0,modelValue:l(a).handlerName,"onUpdate:modelValue":e[1]||(e[1]=r=>l(a).handlerName=r),placeholder:"\u8BF7\u8F93\u5165\u5904\u7406\u5668\u7684\u540D\u5B57"},null,8,["readonly","modelValue"])]),_:1}),o(d,{label:"\u5904\u7406\u5668\u7684\u53C2\u6570",prop:"handlerParam"},{default:t(()=>[o(s,{modelValue:l(a).handlerParam,"onUpdate:modelValue":e[2]||(e[2]=r=>l(a).handlerParam=r),placeholder:"\u8BF7\u8F93\u5165\u5904\u7406\u5668\u7684\u53C2\u6570"},null,8,["modelValue"])]),_:1}),o(d,{label:"CRON \u8868\u8FBE\u5F0F",prop:"cronExpression"},{default:t(()=>[o(E,{modelValue:l(a).cronExpression,"onUpdate:modelValue":e[3]||(e[3]=r=>l(a).cronExpression=r)},null,8,["modelValue"])]),_:1}),o(d,{label:"\u91CD\u8BD5\u6B21\u6570",prop:"retryCount"},{default:t(()=>[o(s,{modelValue:l(a).retryCount,"onUpdate:modelValue":e[4]||(e[4]=r=>l(a).retryCount=r),placeholder:"\u8BF7\u8F93\u5165\u91CD\u8BD5\u6B21\u6570\u3002\u8BBE\u7F6E\u4E3A 0 \u65F6\uFF0C\u4E0D\u8FDB\u884C\u91CD\u8BD5"},null,8,["modelValue"])]),_:1}),o(d,{label:"\u91CD\u8BD5\u95F4\u9694",prop:"retryInterval"},{default:t(()=>[o(s,{modelValue:l(a).retryInterval,"onUpdate:modelValue":e[5]||(e[5]=r=>l(a).retryInterval=r),placeholder:"\u8BF7\u8F93\u5165\u91CD\u8BD5\u95F4\u9694\uFF0C\u5355\u4F4D\uFF1A\u6BEB\u79D2\u3002\u8BBE\u7F6E\u4E3A 0 \u65F6\uFF0C\u65E0\u9700\u95F4\u9694"},null,8,["modelValue"])]),_:1}),o(d,{label:"\u76D1\u63A7\u8D85\u65F6\u65F6\u95F4",prop:"monitorTimeout"},{default:t(()=>[o(s,{modelValue:l(a).monitorTimeout,"onUpdate:modelValue":e[6]||(e[6]=r=>l(a).monitorTimeout=r),placeholder:"\u8BF7\u8F93\u5165\u76D1\u63A7\u8D85\u65F6\u65F6\u95F4\uFF0C\u5355\u4F4D\uFF1A\u6BEB\u79D2"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[w,l(m)]])]),_:1},8,["title","modelValue"])}}});export{M as _};
