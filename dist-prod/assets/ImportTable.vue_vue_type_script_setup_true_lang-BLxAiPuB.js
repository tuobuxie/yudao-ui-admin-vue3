import{d as M,_ as N}from"./index-DzK2S43K.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-D3YOFsHs.js";import{l as $,r as n,j as z,A as b,q as v,B as o,J as a,u as l,m as D,I as E,$ as H,Z as V,G as _,C as L,h as O}from"./form-create-_84fGzaM.js";import{b as P,c as W}from"./index-C-y2KhGA.js";import{g as X}from"./index-DIxM96wI.js";import{h as Y,aj as ee,x as ae,Q as le,k as oe,f as te,i as de,Z as ne,_ as se,ak as ue}from"./form-designer-DHHJWkD5.js";const re=$({name:"InfraCodegenImportTable",__name:"ImportTable",emits:["success"],setup(me,{expose:k,emit:x}){const S=M(),u=n(!1),s=n(!0),y=n([]),t=z({name:void 0,comment:void 0,dataSourceConfigId:0}),R=n(),m=n([]),r=async()=>{s.value=!0;try{y.value=await P(t)}finally{s.value=!1}},U=async()=>{t.name=void 0,t.comment=void 0,t.dataSourceConfigId=m.value[0].id,await r()};k({open:async()=>{m.value=await X(),t.dataSourceConfigId=m.value[0].id,u.value=!0,await r()}});const g=()=>{u.value=!1,i.value=[]},C=n(),i=n([]),K=c=>{var e;(e=l(C))==null||e.toggleRowSelection(c)},T=c=>{i.value=c.map(e=>e.name)},j=async()=>{s.value=!0;try{await W({dataSourceConfigId:t.dataSourceConfigId,tableNames:i.value}),S.success("\u5BFC\u5165\u6210\u529F"),q("success"),g()}finally{s.value=!1}},q=x;return(c,e)=>{const Z=le,A=ae,p=ee,h=oe,I=N,f=te,B=Y,w=se,F=de,G=Q,J=ue;return v(),b(G,{modelValue:l(u),"onUpdate:modelValue":e[3]||(e[3]=d=>O(u)?u.value=d:null),title:"\u5BFC\u5165\u8868",width:"800px"},{footer:o(()=>[a(f,{disabled:l(i).length===0||l(s),type:"primary",onClick:j},{default:o(()=>e[6]||(e[6]=[_(" \u5BFC\u5165 ")])),_:1},8,["disabled"]),a(f,{onClick:g},{default:o(()=>e[7]||(e[7]=[_("\u5173\u95ED")])),_:1})]),default:o(()=>[a(B,{ref_key:"queryFormRef",ref:R,inline:!0,model:l(t),"label-width":"68px"},{default:o(()=>[a(p,{label:"\u6570\u636E\u6E90",prop:"dataSourceConfigId"},{default:o(()=>[a(A,{modelValue:l(t).dataSourceConfigId,"onUpdate:modelValue":e[0]||(e[0]=d=>l(t).dataSourceConfigId=d),class:"!w-240px",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90"},{default:o(()=>[(v(!0),D(E,null,H(l(m),d=>(v(),b(Z,{key:d.id,label:d.name,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u8868\u540D\u79F0",prop:"name"},{default:o(()=>[a(h,{modelValue:l(t).name,"onUpdate:modelValue":e[1]||(e[1]=d=>l(t).name=d),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u540D\u79F0",onKeyup:V(r,["enter"])},null,8,["modelValue"])]),_:1}),a(p,{label:"\u8868\u63CF\u8FF0",prop:"comment"},{default:o(()=>[a(h,{modelValue:l(t).comment,"onUpdate:modelValue":e[2]||(e[2]=d=>l(t).comment=d),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u63CF\u8FF0",onKeyup:V(r,["enter"])},null,8,["modelValue"])]),_:1}),a(p,null,{default:o(()=>[a(f,{onClick:r},{default:o(()=>[a(I,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=_(" \u641C\u7D22 "))]),_:1}),a(f,{onClick:U},{default:o(()=>[a(I,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=_(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"]),a(F,null,{default:o(()=>[L((v(),b(l(ne),{ref_key:"tableRef",ref:C,data:l(y),height:"260px",onRowClick:K,onSelectionChange:T},{default:o(()=>[a(w,{type:"selection",width:"55"}),a(w,{"show-overflow-tooltip":!0,label:"\u8868\u540D\u79F0",prop:"name"}),a(w,{"show-overflow-tooltip":!0,label:"\u8868\u63CF\u8FF0",prop:"comment"})]),_:1},8,["data"])),[[J,l(s)]])]),_:1})]),_:1},8,["modelValue"])}}});export{re as _};
