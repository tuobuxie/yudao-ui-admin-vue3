import{a as E,d as T,u as j,e as A}from"./index-B2urM1q-.js";import{_ as B}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BRGqERh7.js";import{u as G}from"./tagsView-DIbur9wp.js";import{_ as J}from"./BasicInfoForm.vue_vue_type_script_setup_true_lang-0LJSovIm.js";import{_ as S}from"./ColumInfoForm.vue_vue_type_script_setup_true_lang-styxgjVf.js";import{_ as U}from"./GenerateInfoForm.vue_vue_type_script_setup_true_lang-3pEk_34j.js";import{g as $,u as F}from"./index-DzoYtAMz.js";import{ak as W,a0 as X,$ as z,h as D,aj as H,f as K}from"./form-designer-DHHJWkD5.js";import{l as L,r as u,e as M,C as N,u as a,A as O,q as P,B as t,J as e,h as Q,G as p}from"./form-create-_84fGzaM.js";import"./formRules-DMdZ225J.js";import"./dict.type-C_QbCOEj.js";import"./tree-COGD3qag.js";import"./index-CEHJ_lZw.js";const Y=L({name:"InfraCodegenEditTable",__name:"EditTable",setup(Z){const{t:_}=E(),b=T(),{push:y,currentRoute:g}=j(),{query:v}=A(),{delView:k}=G(),r=u(!1),n=u("colum"),f=u(),I=u(),i=u(),o=u({table:{},columns:[]}),w=async()=>{var s,l;if(a(o)){await((s=a(f))==null?void 0:s.validate()),await((l=a(i))==null?void 0:l.validate());try{await F(o.value),b.success(_("common.updateSuccess")),c()}catch{}}},c=()=>{k(a(g)),y("/infra/codegen")};return M(()=>{(async()=>{const s=v.id;if(s){r.value=!0;try{o.value=await $(s)}finally{r.value=!1}}})()}),(s,l)=>{const m=z,h=X,d=K,C=H,R=D,V=B,q=W;return N((P(),O(V,null,{default:t(()=>[e(h,{modelValue:a(n),"onUpdate:modelValue":l[0]||(l[0]=x=>Q(n)?n.value=x:null)},{default:t(()=>[e(m,{label:"\u57FA\u672C\u4FE1\u606F",name:"basicInfo"},{default:t(()=>[e(a(J),{ref_key:"basicInfoRef",ref:f,table:a(o).table},null,8,["table"])]),_:1}),e(m,{label:"\u5B57\u6BB5\u4FE1\u606F",name:"colum"},{default:t(()=>[e(a(S),{ref_key:"columInfoRef",ref:I,columns:a(o).columns},null,8,["columns"])]),_:1}),e(m,{label:"\u751F\u6210\u4FE1\u606F",name:"generateInfo"},{default:t(()=>[e(a(U),{ref_key:"generateInfoRef",ref:i,table:a(o).table,columns:a(o).columns},null,8,["table","columns"])]),_:1})]),_:1},8,["modelValue"]),e(R,null,{default:t(()=>[e(C,{style:{float:"right"}},{default:t(()=>[e(d,{loading:a(r),type:"primary",onClick:w},{default:t(()=>l[1]||(l[1]=[p("\u4FDD\u5B58")])),_:1},8,["loading"]),e(d,{onClick:c},{default:t(()=>l[2]||(l[2]=[p("\u8FD4\u56DE")])),_:1})]),_:1})]),_:1})]),_:1})),[[q,a(r)]])}}});export{Y as default};
