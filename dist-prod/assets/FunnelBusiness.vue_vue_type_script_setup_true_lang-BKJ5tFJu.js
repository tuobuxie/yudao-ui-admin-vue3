import{D as T}from"./index-DmQdxAiK.js";import{_ as W}from"./DictTag.vue_vue_type_script_lang-DiMRMEpR.js";import{_ as k}from"./Echart.vue_vue_type_script_setup_true_lang-CIKsMbIq.js";import{S as y}from"./funnel-DmJgO7Bl.js";import{ad as z,i as A,j as D,aq as F,f as j,ag as I,ak as N,_ as U,Z as G}from"./form-designer-DHHJWkD5.js";import{l as J,r as m,j as L,e as M,m as O,q as v,I as R,J as a,B as t,G as g,u as l,C as V,A as Y}from"./form-create-_84fGzaM.js";const Z=J({name:"FunnelBusiness",__name:"FunnelBusiness",props:{queryParams:{}},setup(S,{expose:C}){const d=S,p=m(!0),u=m(!1),f=m([]),n=L({title:{text:"\u9500\u552E\u6F0F\u6597"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}"},toolbox:{feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},legend:{data:["\u5BA2\u6237","\u5546\u673A","\u8D62\u5355"]},series:[{name:"\u9500\u552E\u6F0F\u6597",type:"funnel",left:"10%",top:60,bottom:60,width:"80%",min:0,max:100,minSize:"0%",maxSize:"100%",sort:"descending",gap:2,label:{show:!0,position:"inside"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{fontSize:20}},data:[{value:60,name:"\u5BA2\u6237-0\u4E2A"},{value:40,name:"\u5546\u673A-0\u4E2A"},{value:20,name:"\u8D62\u5355-0\u4E2A"}]}]}),b=async s=>{p.value=s,await o()},o=async()=>{u.value=!0;const s=await y.getFunnelSummary(d.queryParams);if(s&&n.series&&n.series[0]&&n.series[0].data){const e=[];p.value?(e.push({value:60,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:40,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:20,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})):(e.push({value:s.customerCount||0,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:s.businessCount||0,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:s.businessWinCount||0,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})),n.series[0].data=e}f.value=await y.getBusinessSummaryByEndStatus(d.queryParams),u.value=!1};return C({loadData:o}),M(()=>{o()}),(s,e)=>{const c=j,w=F,_=k,x=I,B=D,$=A,h=z,i=U,q=W,P=G,E=N;return v(),O(R,null,[a(h,{shadow:"never"},{default:t(()=>[a($,null,{default:t(()=>[a(B,{span:24},{default:t(()=>[a(w,{class:"mb-10px"},{default:t(()=>[a(c,{type:"primary",onClick:e[0]||(e[0]=r=>b(!0))},{default:t(()=>e[2]||(e[2]=[g("\u5BA2\u6237\u89C6\u89D2")])),_:1}),a(c,{type:"primary",onClick:e[1]||(e[1]=r=>b(!1))},{default:t(()=>e[3]||(e[3]=[g("\u52A8\u6001\u89C6\u89D2")])),_:1})]),_:1}),a(x,{loading:l(u),animated:""},{default:t(()=>[a(_,{height:500,options:l(n)},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(h,{class:"mt-16px",shadow:"never"},{default:t(()=>[V((v(),Y(P,{data:l(f)},{default:t(()=>[a(i,{align:"center",label:"\u5E8F\u53F7",type:"index",width:"80"}),a(i,{align:"center",label:"\u9636\u6BB5",prop:"endStatus",width:"200"},{default:t(r=>[a(q,{type:l(T).CRM_BUSINESS_END_STATUS_TYPE,value:r.row.endStatus},null,8,["type","value"])]),_:1}),a(i,{align:"center",label:"\u5546\u673A\u6570","min-width":"200",prop:"businessCount"}),a(i,{align:"center",label:"\u5546\u673A\u603B\u91D1\u989D(\u5143)","min-width":"200",prop:"totalPrice"})]),_:1},8,["data"])),[[E,l(u)]])]),_:1})],64)}}});export{Z as _};
