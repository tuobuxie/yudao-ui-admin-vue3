import{d as G,a as J,e as Q,u as R,h as $,D as H,_ as W}from"./index-DmQdxAiK.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-OyXbUoED.js";import{_ as Y}from"./ContentWrap.vue_vue_type_script_setup_true_lang-OPDE9cVe.js";import{l as ee,r as y,j as ae,e as le,ag as te,m as N,q as r,J as e,B as t,u as o,Z as oe,I as U,$ as ne,A as u,C as w,G as p}from"./form-create-_84fGzaM.js";import{d as se}from"./formatTime-BGPGB_ys.js";import{K as I}from"./index-DEI5mmCP.js";import{c as de}from"./permission-Dj0aJnJY.js";import{C as _}from"./constants-C3gLHYOK.js";import{h as re,aj as ie,k as ue,x as pe,Q as me,f as ce,Z as ge,_ as we,D as fe,ak as ke}from"./form-designer-DHHJWkD5.js";const ye=ee({name:"KnowledgeDocument",__name:"index",setup(_e){const m=G(),{t:A}=J(),D=Q(),f=R(),v=y(!0),K=y([]),S=y(0),n=ae({pageNo:1,pageSize:10,name:void 0,status:void 0,knowledgeId:void 0}),V=y(),c=async()=>{v.value=!0;try{const h=await I.getKnowledgeDocumentPage(n);K.value=h.list,S.value=h.total}finally{v.value=!1}},b=()=>{n.pageNo=1,c()},E=()=>{V.value.resetFields(),b()},T=()=>{f.push({name:"AiKnowledgeDocumentCreate",query:{knowledgeId:n.knowledgeId}})};return le(()=>{if(!D.query.knowledgeId)return m.error("\u77E5\u8BC6\u5E93 ID \u4E0D\u5B58\u5728\uFF0C\u65E0\u6CD5\u67E5\u770B\u6587\u6863\u5217\u8868"),void f.push({name:"AiKnowledge"});n.knowledgeId=D.query.knowledgeId,c()}),(h,a)=>{const B=ue,C=ie,L=me,z=pe,x=W,i=ce,M=re,q=Y,d=we,P=fe,j=ge,F=X,k=te("hasPermi"),O=ke;return r(),N(U,null,[e(q,null,{default:t(()=>[e(M,{class:"-mb-15px",model:o(n),ref_key:"queryFormRef",ref:V,inline:!0,"label-width":"68px"},{default:t(()=>[e(C,{label:"\u6587\u4EF6\u540D\u79F0",prop:"name"},{default:t(()=>[e(B,{modelValue:o(n).name,"onUpdate:modelValue":a[0]||(a[0]=l=>o(n).name=l),placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0",clearable:"",onKeyup:oe(b,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(C,{label:"\u662F\u5426\u542F\u7528",prop:"status"},{default:t(()=>[e(z,{modelValue:o(n).status,"onUpdate:modelValue":a[1]||(a[1]=l=>o(n).status=l),placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u542F\u7528",clearable:"",class:"!w-240px"},{default:t(()=>[(r(!0),N(U,null,ne(o($)(o(H).COMMON_STATUS),l=>(r(),u(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,null,{default:t(()=>[e(i,{onClick:b},{default:t(()=>[e(x,{icon:"ep:search",class:"mr-5px"}),a[4]||(a[4]=p(" \u641C\u7D22"))]),_:1}),e(i,{onClick:E},{default:t(()=>[e(x,{icon:"ep:refresh",class:"mr-5px"}),a[5]||(a[5]=p(" \u91CD\u7F6E"))]),_:1}),w((r(),u(i,{type:"primary",plain:"",onClick:T},{default:t(()=>[e(x,{icon:"ep:plus",class:"mr-5px"}),a[6]||(a[6]=p(" \u65B0\u589E "))]),_:1})),[[k,["ai:knowledge:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(q,null,{default:t(()=>[w((r(),u(j,{data:o(K),stripe:!0,"show-overflow-tooltip":!0},{default:t(()=>[e(d,{label:"\u6587\u6863\u7F16\u53F7",align:"center",prop:"id"}),e(d,{label:"\u6587\u4EF6\u540D\u79F0",align:"center",prop:"name"}),e(d,{label:"\u5B57\u7B26\u6570",align:"center",prop:"contentLength"}),e(d,{label:"Token \u6570",align:"center",prop:"tokens"}),e(d,{label:"\u5206\u7247\u6700\u5927 Token \u6570",align:"center",prop:"segmentMaxTokens"}),e(d,{label:"\u53EC\u56DE\u6B21\u6570",align:"center",prop:"retrievalCount"}),e(d,{label:"\u662F\u5426\u542F\u7528",align:"center",prop:"status"},{default:t(l=>[e(P,{modelValue:l.row.status,"onUpdate:modelValue":g=>l.row.status=g,"active-value":0,"inactive-value":1,onChange:g=>(async s=>{try{const Z=s.status===_.ENABLE?"\u542F\u7528":"\u7981\u7528";await m.confirm('\u786E\u8BA4\u8981"'+Z+'""'+s.name+'"\u6587\u6863\u5417?'),await I.updateKnowledgeDocumentStatus({id:s.id,status:s.status}),m.success(A("common.updateSuccess")),await c()}catch{s.status=s.status===_.ENABLE?_.DISABLE:_.ENABLE}})(l.row),disabled:!o(de)(["ai:knowledge:update"])},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])]),_:1}),e(d,{label:"\u4E0A\u4F20\u65F6\u95F4",align:"center",prop:"createTime",formatter:o(se),width:"180px"},null,8,["formatter"]),e(d,{label:"\u64CD\u4F5C",align:"center","min-width":"120px"},{default:t(l=>[w((r(),u(i,{link:"",type:"primary",onClick:g=>{return s=l.row.id,void f.push({name:"AiKnowledgeDocumentUpdate",query:{id:s,knowledgeId:n.knowledgeId}});var s}},{default:t(()=>a[7]||(a[7]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:update"]]]),w((r(),u(i,{link:"",type:"primary",onClick:g=>{return s=l.row.id,void f.push({name:"AiKnowledgeSegment",query:{documentId:s}});var s}},{default:t(()=>a[8]||(a[8]=[p(" \u5206\u6BB5 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:query"]]]),w((r(),u(i,{link:"",type:"danger",onClick:g=>(async s=>{try{await m.delConfirm(),await I.deleteKnowledgeDocument(s),m.success(A("common.delSuccess")),await c()}catch{}})(l.row.id)},{default:t(()=>a[9]||(a[9]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:delete"]]])]),_:1})]),_:1},8,["data"])),[[O,o(v)]]),e(F,{total:o(S),page:o(n).pageNo,"onUpdate:page":a[2]||(a[2]=l=>o(n).pageNo=l),limit:o(n).pageSize,"onUpdate:limit":a[3]||(a[3]=l=>o(n).pageSize=l),onPagination:c},null,8,["total","page","limit"])]),_:1})],64)}}});export{ye as default};
