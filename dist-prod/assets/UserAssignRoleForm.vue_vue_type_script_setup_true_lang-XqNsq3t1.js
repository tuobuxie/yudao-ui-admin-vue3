import{a as R,d as S}from"./index-DmQdxAiK.js";import{_ as j}from"./Dialog.vue_vue_type_style_index_0_lang-C4PMlRRW.js";import{c as q,d as B}from"./index-CujqeT-i.js";import{g as J}from"./index-EzkaYqZE.js";import{h as z,aj as D,k as G,x as Q,Q as $,ak as E,f as H}from"./form-designer-DHHJWkD5.js";import{l as K,r as n,A as c,q as i,B as u,C as L,u as s,J as o,m as M,I as N,$ as O,G as k,h as P}from"./form-create-_84fGzaM.js";const T=K({name:"SystemUserAssignRoleForm",__name:"UserAssignRoleForm",emits:["success"],setup(W,{expose:V,emit:y}){const{t:b}=R(),I=S(),m=n(!1),r=n(!1),e=n({id:-1,nickname:"",username:"",roleIds:[]}),t=n(),v=n([]);V({open:async d=>{m.value=!0,h(),e.value.id=d.id,e.value.username=d.username,e.value.nickname=d.nickname,r.value=!0;try{e.value.roleIds=await q(d.id)}finally{r.value=!1}v.value=await J()}});const w=y,U=async()=>{if(t&&await t.value.validate()){r.value=!0;try{await B({userId:e.value.id,roleIds:e.value.roleIds}),I.success(b("common.updateSuccess")),m.value=!1,w("success",!0)}finally{r.value=!1}}},h=()=>{var d;e.value={id:-1,nickname:"",username:"",roleIds:[]},(d=t.value)==null||d.resetFields()};return(d,a)=>{const p=G,f=D,x=$,A=Q,g=z,_=H,C=j,F=E;return i(),c(C,{modelValue:s(m),"onUpdate:modelValue":a[4]||(a[4]=l=>P(m)?m.value=l:null),title:"\u5206\u914D\u89D2\u8272"},{footer:u(()=>[o(_,{disabled:s(r),type:"primary",onClick:U},{default:u(()=>a[5]||(a[5]=[k("\u786E \u5B9A")])),_:1},8,["disabled"]),o(_,{onClick:a[3]||(a[3]=l=>m.value=!1)},{default:u(()=>a[6]||(a[6]=[k("\u53D6 \u6D88")])),_:1})]),default:u(()=>[L((i(),c(g,{ref_key:"formRef",ref:t,model:s(e),"label-width":"80px"},{default:u(()=>[o(f,{label:"\u7528\u6237\u540D\u79F0"},{default:u(()=>[o(p,{modelValue:s(e).username,"onUpdate:modelValue":a[0]||(a[0]=l=>s(e).username=l),disabled:!0},null,8,["modelValue"])]),_:1}),o(f,{label:"\u7528\u6237\u6635\u79F0"},{default:u(()=>[o(p,{modelValue:s(e).nickname,"onUpdate:modelValue":a[1]||(a[1]=l=>s(e).nickname=l),disabled:!0},null,8,["modelValue"])]),_:1}),o(f,{label:"\u89D2\u8272"},{default:u(()=>[o(A,{modelValue:s(e).roleIds,"onUpdate:modelValue":a[2]||(a[2]=l=>s(e).roleIds=l),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:u(()=>[(i(!0),M(N,null,O(s(v),l=>(i(),c(x,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[F,s(r)]])]),_:1},8,["modelValue"])}}});export{T as _};
