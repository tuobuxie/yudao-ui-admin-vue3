import{_ as d,D as E,a$ as Z,a as W,d as X,h as Y,b0 as D}from"./index-D_TWD7wt.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-4_WNC8um.js";import{_ as ae}from"./index-CBtRt3JL.js";import{l as te,J as a,r as o,I as C,j as le,e as se,ag as ne,m as O,q as y,B as s,u as l,Z as oe,$ as ie,A,C as ue,G as i,h as re}from"./form-create-_84fGzaM.js";import{h as de}from"./tree-COGD3qag.js";import{b as me,d as ce,u as pe}from"./index-CIOgA79N.js";import{_ as ye}from"./MenuForm.vue_vue_type_script_setup_true_lang-TPiXY9HW.js";import{_ as fe}from"./DictTag.vue_vue_type_script_lang-BD_Qe0UA.js";import{c as f}from"./permission-DVPfzAr0.js";import{C as M}from"./constants-C3gLHYOK.js";import{bb as R,D as he,f as u,h as ke,aj as ve,k as we,x as _e,Q as xe,b8 as be,b9 as Ce}from"./form-designer-DHHJWkD5.js";import"./Dialog.vue_vue_type_style_index_0_lang-CJT4CHEp.js";import"./Tooltip.vue_vue_type_script_setup_true_lang-CNsUkQo1.js";const Re=te({name:"SystemMenu",__name:"index",setup(Se){const S=[{key:"name",title:"\u83DC\u5355\u540D\u79F0",dataKey:"name",width:250,fixed:R.LEFT},{key:"icon",title:"\u56FE\u6807",dataKey:"icon",width:100,align:"center",cellRenderer:({cellData:t})=>a(d,{icon:t},null)},{key:"sort",title:"\u6392\u5E8F",dataKey:"sort",width:60},{key:"permission",title:"\u6743\u9650\u6807\u8BC6",dataKey:"permission",width:300},{key:"component",title:"\u7EC4\u4EF6\u8DEF\u5F84",dataKey:"component",width:500},{key:"componentName",title:"\u7EC4\u4EF6\u540D\u79F0",dataKey:"componentName",width:200},{key:"status",title:"\u72B6\u6001",dataKey:"status",width:60,fixed:R.RIGHT,cellRenderer:({rowData:t})=>f(["system:menu:update"])?a(he,{modelValue:t.status,"onUpdate:modelValue":e=>t.status=e,"active-value":M.ENABLE,"inactive-value":M.DISABLE,loading:x[t.id],class:"ml-4px",onChange:e=>G(t,e)},null):a(fe,{type:E.COMMON_STATUS,value:t.status},null)},{key:"operations",title:"\u64CD\u4F5C",align:"center",width:160,fixed:R.RIGHT,cellRenderer:({rowData:t})=>{const e=[];return f(["system:menu:update"])&&e.push(a(u,{key:"edit",link:!0,type:"primary",onClick:()=>_("update",t.id)},{default:()=>[i("\u4FEE\u6539")]})),f(["system:menu:create"])&&e.push(a(u,{key:"create",link:!0,type:"primary",onClick:()=>_("create",void 0,t.id)},{default:()=>[i("\u65B0\u589E")]})),f(["system:menu:delete"])&&e.push(a(u,{key:"delete",link:!0,type:"danger",onClick:()=>F(t.id)},{default:()=>[i("\u5220\u9664")]})),e.length===0?null:a(C,null,[e])}}],{wsCache:K}=Z(),{t:N}=W(),h=X(),g=o(!0),k=o([]),r=le({name:void 0,status:void 0}),T=o(),v=o(!1);o(!0);const m=o([]),c=async()=>{g.value=!0;try{const t=await me(r);k.value=de(t)}finally{g.value=!1}},w=()=>{c()},I=()=>{T.value.resetFields(),w()},U=o(),_=(t,e,p)=>{U.value.open(t,e,p)},L=()=>{v.value?m.value=[]:m.value=k.value.map(t=>t.id),v.value=!v.value},B=async()=>{try{await h.confirm("\u5373\u5C06\u66F4\u65B0\u7F13\u5B58\u5237\u65B0\u6D4F\u89C8\u5668\uFF01","\u5237\u65B0\u83DC\u5355\u7F13\u5B58"),K.delete(D.USER),K.delete(D.ROLE_ROUTERS),location.reload()}catch{}},F=async t=>{try{await h.delConfirm(),await ce(t),h.success(N("common.delSuccess")),await c()}catch{}},x=o({}),G=async(t,e)=>{x.value[t.id]=!0;try{t.status=e,await pe(t)}finally{x.value[t.id]=!1}};return se(()=>{c()}),(t,e)=>{const p=ae,j=we,b=ve,q=xe,H=_e,$=ke,V=ee,z=Ce,J=be,P=ne("hasPermi");return y(),O(C,null,[a(p,{title:"\u529F\u80FD\u6743\u9650",url:"https://doc.iocoder.cn/resource-permission"}),a(p,{title:"\u83DC\u5355\u8DEF\u7531",url:"https://doc.iocoder.cn/vue3/route/"}),a(V,null,{default:s(()=>[a($,{ref_key:"queryFormRef",ref:T,inline:!0,model:l(r),class:"-mb-15px","label-width":"68px"},{default:s(()=>[a(b,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:s(()=>[a(j,{modelValue:l(r).name,"onUpdate:modelValue":e[0]||(e[0]=n=>l(r).name=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",onKeyup:oe(w,["enter"])},null,8,["modelValue"])]),_:1}),a(b,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[a(H,{modelValue:l(r).status,"onUpdate:modelValue":e[1]||(e[1]=n=>l(r).status=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355\u72B6\u6001"},{default:s(()=>[(y(!0),O(C,null,ie(l(Y)(l(E).COMMON_STATUS),n=>(y(),A(q,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(b,null,{default:s(()=>[a(l(u),{onClick:w},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=i(" \u641C\u7D22 "))]),_:1}),a(l(u),{onClick:I},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=i(" \u91CD\u7F6E "))]),_:1}),ue((y(),A(l(u),{plain:"",type:"primary",onClick:e[2]||(e[2]=n=>_("create"))},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=i(" \u65B0\u589E "))]),_:1})),[[P,["system:menu:create"]]]),a(l(u),{plain:"",type:"danger",onClick:L},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:sort"}),e[7]||(e[7]=i(" \u5C55\u5F00/\u6298\u53E0 "))]),_:1}),a(l(u),{plain:"",onClick:B},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:refresh"}),e[8]||(e[8]=i(" \u5237\u65B0\u83DC\u5355\u7F13\u5B58 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(V,null,{default:s(()=>[a(J,null,{default:s(({width:n})=>[a(z,{"expanded-row-keys":l(m),"onUpdate:expandedRowKeys":e[3]||(e[3]=Q=>re(m)?m.value=Q:null),columns:S,data:l(k),"expand-column-key":S[0].key,height:1e3,width:n,fixed:"","row-key":"id"},null,8,["expanded-row-keys","data","expand-column-key","width"])]),_:1})]),_:1}),a(ye,{ref_key:"formRef",ref:U,onSuccess:c},null,512)],64)}}});export{Re as default};
