import{d as B,_ as j}from"./index-D_TWD7wt.js";import{_ as G}from"./Dialog.vue_vue_type_style_index_0_lang-CJT4CHEp.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-ZV0RCuCp.js";import{g as K}from"./couponTemplate-DdJ3N9rf.js";import{s as M}from"./coupon-DVtZqG2h.js";import{d as R,u as Z,v as E,r as H}from"./formatter-B5kt-F-a.js";import{h as L}from"./constants-C3gLHYOK.js";import{h as O,aj as Q,k as D,f as W,Z as X,_ as Y,ak as $}from"./form-designer-DHHJWkD5.js";import{l as aa,r as i,ag as ea,A as g,q as h,B as r,J as l,C as V,x as la,u as a,G as y,h as ta}from"./form-create-_84fGzaM.js";const oa=aa({name:"PromotionCouponSendForm",__name:"CouponSendForm",setup(ra,{expose:N}){const S=B(),_=i(0),v=i([]),u=i(!1),p=i(!1),m=i(!1),t=i({pageNo:1,pageSize:10,name:null,canTakeTypes:[L.ADMIN.type]}),d=i();let w=[];N({open:n=>{w=n,x(),m.value=!0}});const b=async()=>{u.value=!0;try{const n=await K(t.value);v.value=n.list,_.value=n.total}finally{u.value=!1}},c=()=>{t.value.pageNo=1,b()},x=()=>{var n;(n=d==null?void 0:d.value)==null||n.resetFields(),c()};return(n,e)=>{const T=D,k=Q,C=j,f=W,F=O,s=Y,P=X,U=J,z=G,I=ea("hasPermi"),q=$;return h(),g(z,{modelValue:a(m),"onUpdate:modelValue":e[3]||(e[3]=o=>ta(m)?m.value=o:null),appendToBody:!0,title:"\u53D1\u9001\u4F18\u60E0\u5238",width:"70%"},{default:r(()=>[l(F,{ref_key:"queryFormRef",ref:d,inline:!0,model:a(t),class:"-mb-15px","label-width":"82px"},{default:r(()=>[l(k,{label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name"},{default:r(()=>[l(T,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).name=o),class:"!w-240px",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u52B5\u540D",clearable:"",onKeyup:c},null,8,["modelValue"])]),_:1}),l(k,null,{default:r(()=>[l(f,{onClick:c},{default:r(()=>[l(C,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=y(" \u641C\u7D22 "))]),_:1}),l(f,{onClick:x},{default:r(()=>[l(C,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=y(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"]),V((h(),g(P,{data:a(v),"show-overflow-tooltip":""},{default:r(()=>[l(s,{align:"center",label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name","min-width":"60"}),l(s,{label:"\u4F18\u60E0\u91D1\u989D / \u6298\u6263",align:"center",prop:"discount",formatter:a(R),"min-width":"60"},null,8,["formatter"]),l(s,{align:"center",label:"\u6700\u4F4E\u6D88\u8D39",prop:"usePrice","min-width":"60",formatter:a(Z)},null,8,["formatter"]),l(s,{align:"center",label:"\u6709\u6548\u671F\u9650",prop:"validityType","min-width":"140",formatter:a(E)},null,8,["formatter"]),l(s,{align:"center",label:"\u5269\u4F59\u6570\u91CF","min-width":"60",formatter:a(H)},null,8,["formatter"]),l(s,{label:"\u64CD\u4F5C",align:"center","min-width":"60px",fixed:"right"},{default:r(o=>[V((h(),g(f,{link:"",type:"primary",disabled:a(p),loading:a(p),onClick:na=>(async A=>{try{p.value=!0,await M({templateId:A,userIds:w}),S.success("\u53D1\u9001\u6210\u529F"),m.value=!1}finally{p.value=!1}})(o.row.id)},{default:r(()=>e[6]||(e[6]=[y(" \u53D1\u9001 ")])),_:2},1032,["disabled","loading","onClick"])),[[I,["promotion:coupon:send"]]])]),_:1})]),_:1},8,["data"])),[[q,a(u)]]),l(U,{limit:a(t).pageSize,"onUpdate:limit":e[1]||(e[1]=o=>a(t).pageSize=o),page:a(t).pageNo,"onUpdate:page":e[2]||(e[2]=o=>a(t).pageNo=o),total:a(_),onPagination:b},null,8,["limit","page","total"]),e[7]||(e[7]=la("div",{class:"clear-both"},null,-1))]),_:1},8,["modelValue"])}}});export{oa as _};
