import{X as b,h as k,D as A}from"./index-DzK2S43K.js";import{f as w,e as M,g as T,c as F}from"./formatTime-BGPGB_ys.js";import{aU as Y,aj as j,F as U,x as q,Q as H,ad as I}from"./form-designer-DHHJWkD5.js";import{Y as R,ad as z,ag as G,a7 as J,a2 as N,a4 as O,az as Q,w as W,aA as S}from"./echarts-BmJPRACc.js";import{l as X,r as y,j as $,c as K,e as P,A as D,q as s,B as n,m,u as a,J as r,x as g,I as Z,$ as ee,n as ae}from"./form-create-_84fGzaM.js";const E={getStatisticsSummary:async()=>await b.get({url:"/iot/statistics/get-summary"}),getDeviceMessageSummaryByDate:async f=>await b.get({url:"/iot/statistics/get-device-message-summary-by-date",params:f})},te={class:"flex items-center justify-between"},le={class:"flex flex-wrap items-center gap-4"},se={key:0,class:"h-[300px] flex justify-center items-center"},re={key:1,class:"h-[300px] flex justify-center items-center"},oe=X({name:"MessageTrendCard",__name:"MessageTrendCard",setup(f){const u=y(),c=y(!1),t=y([]),o=$({interval:1,times:[w(M(new Date(new Date().getTime()-6048e5))),w(T(new Date(new Date().getTime()-864e5)))]}),d=K(()=>t.value&&t.value.length>0),p=()=>{v()},v=async()=>{c.value=!0;try{t.value=await E.getDeviceMessageSummaryByDate(o),await ae(),B()}catch{t.value=[]}finally{c.value=!1}},B=()=>{if(d.value&&u.value){R([z,G,J,N,O,Q]);try{const i=W(u.value);return i.setOption({tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#E5E7EB",textStyle:{color:"#374151"}},legend:{data:["\u4E0A\u884C\u6D88\u606F\u91CF","\u4E0B\u884C\u6D88\u606F\u91CF"],textStyle:{color:"#374151",fontWeight:500}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t.value.map(e=>e.time),axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"},splitLine:{lineStyle:{color:"#F3F4F6"}}},series:[{name:"\u4E0A\u884C\u6D88\u606F\u91CF",type:"line",smooth:!0,data:t.value.map(e=>e.upstreamCount),itemStyle:{color:"#3B82F6"},lineStyle:{width:2},areaStyle:{color:new S(0,0,0,1,[{offset:0,color:"rgba(59, 130, 246, 0.2)"},{offset:1,color:"rgba(59, 130, 246, 0)"}])}},{name:"\u4E0B\u884C\u6D88\u606F\u91CF",type:"line",smooth:!0,data:t.value.map(e=>e.downstreamCount),itemStyle:{color:"#10B981"},lineStyle:{width:2},areaStyle:{color:new S(0,0,0,1,[{offset:0,color:"rgba(16, 185, 129, 0.2)"},{offset:1,color:"rgba(16, 185, 129, 0)"}])}}]}),i}catch{return null}}};return P(()=>{v()}),(i,e)=>{const C=U,x=j,_=H,L=q,h=Y,V=I;return s(),D(V,{class:"chart-card",shadow:"never",loading:a(c)},{header:n(()=>[g("div",te,[e[2]||(e[2]=g("span",{class:"text-base font-medium text-gray-600"},"\u6D88\u606F\u91CF\u7EDF\u8BA1",-1)),g("div",le,[r(x,{label:"\u65F6\u95F4\u8303\u56F4",class:"!mb-0"},{default:n(()=>[r(C,{modelValue:a(o).times,"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).times=l),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],shortcuts:a(F),class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:p},null,8,["modelValue","default-time","shortcuts"])]),_:1}),r(x,{label:"\u65F6\u95F4\u95F4\u9694",class:"!mb-0"},{default:n(()=>[r(L,{modelValue:a(o).interval,"onUpdate:modelValue":e[1]||(e[1]=l=>a(o).interval=l),class:"!w-120px",placeholder:"\u95F4\u9694\u7C7B\u578B",onChange:p},{default:n(()=>[(s(!0),m(Z,null,ee(a(k)(a(A).DATE_INTERVAL),l=>(s(),D(_,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])])]),default:n(()=>[a(c)&&!a(d)?(s(),m("div",se,[r(h,{description:"\u52A0\u8F7D\u4E2D..."})])):a(d)?(s(),m("div",{key:2,ref_key:"messageChartRef",ref:u,class:"h-[300px]"},null,512)):(s(),m("div",re,[r(h,{description:"\u6682\u65E0\u6570\u636E"})]))]),_:1},8,["loading"])}}});export{E as S,oe as _};
