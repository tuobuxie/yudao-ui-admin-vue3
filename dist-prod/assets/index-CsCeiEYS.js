import{d as J,a as K,h as Q,D as P,_ as E,H as L}from"./index-D_TWD7wt.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-ZV0RCuCp.js";import{_ as X}from"./DictTag.vue_vue_type_script_lang-BD_Qe0UA.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-4_WNC8um.js";import{_ as ae}from"./index-CBtRt3JL.js";import{l as te,r as d,j as le,e as oe,ag as ie,m as V,q as s,J as e,B as l,u as o,Z as re,I as D,$ as se,A as c,C as f,G as p,H as C}from"./form-create-_84fGzaM.js";import{f as A,d as pe}from"./formatTime-BGPGB_ys.js";import{a as ne,b as me,d as ue}from"./combinationActivity-VlrAc9vE.js";import{_ as ce}from"./CombinationActivityForm.vue_vue_type_script_setup_true_lang-BVLOn5Ro.js";import{f as de}from"./formatter-DFWU-F47.js";import{h as fe,aj as we,k as _e,x as be,Q as he,f as ye,Z as ge,_ as ke,al as ve,ak as Ce}from"./form-designer-DHHJWkD5.js";import"./Dialog.vue_vue_type_style_index_0_lang-CJT4CHEp.js";import"./Form-Dwx7HbU_.js";import"./InputPassword-B9cnyI4D.js";import"./formRules-DgRLzYxc.js";import"./useCrudSchemas-BIg7AAIF.js";import"./tree-COGD3qag.js";import"./SpuSelect.vue_vue_type_script_setup_true_lang-DY-D0J9w.js";import"./index-D9DKyOnS.js";import"./SkuList.vue_vue_type_style_index_0_lang-C4BhLemM.js";import"./category-BhERuDqD.js";import"./spu-gjdwZNJW.js";import"./SpuAndSkuList.vue_vue_type_script_setup_true_lang-CvWP2-Q6.js";const xe=te({name:"PromotionBargainActivity",__name:"index",setup(Se){const w=J(),{t:O}=K(),b=d(!0),x=d(0),S=d([]),r=le({pageNo:1,pageSize:10,name:null,status:null}),M=d(),m=async()=>{b.value=!0;try{const n=await ne(r);S.value=n.list,x.value=n.total}finally{b.value=!1}},h=()=>{r.pageNo=1,m()},z=()=>{M.value.resetFields(),h()},N=d(),U=(n,t)=>{N.value.open(n,t)},j=n=>{const t=Math.min(...n.map(y=>y.combinationPrice));return`\uFFE5${L(t)}`};return oe(async()=>{await m()}),(n,t)=>{const y=ae,q=_e,g=we,B=he,F=be,k=E,u=ye,H=fe,Y=ee,i=ke,I=ve,R=X,Z=ge,$=W,_=ie("hasPermi"),G=Ce;return s(),V(D,null,[e(y,{title:"\u3010\u8425\u9500\u3011\u62FC\u56E2\u6D3B\u52A8",url:"https://doc.iocoder.cn/mall/promotion-combination/"}),e(Y,null,{default:l(()=>[e(H,{ref_key:"queryFormRef",ref:M,inline:!0,model:o(r),class:"-mb-15px","label-width":"68px"},{default:l(()=>[e(g,{label:"\u6D3B\u52A8\u540D\u79F0",prop:"name"},{default:l(()=>[e(q,{modelValue:o(r).name,"onUpdate:modelValue":t[0]||(t[0]=a=>o(r).name=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0",onKeyup:re(h,["enter"])},null,8,["modelValue"])]),_:1}),e(g,{label:"\u6D3B\u52A8\u72B6\u6001",prop:"status"},{default:l(()=>[e(F,{modelValue:o(r).status,"onUpdate:modelValue":t[1]||(t[1]=a=>o(r).status=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6D3B\u52A8\u72B6\u6001"},{default:l(()=>[(s(!0),V(D,null,se(o(Q)(o(P).COMMON_STATUS),a=>(s(),c(B,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(g,null,{default:l(()=>[e(u,{onClick:h},{default:l(()=>[e(k,{class:"mr-5px",icon:"ep:search"}),t[5]||(t[5]=p(" \u641C\u7D22 "))]),_:1}),e(u,{onClick:z},{default:l(()=>[e(k,{class:"mr-5px",icon:"ep:refresh"}),t[6]||(t[6]=p(" \u91CD\u7F6E "))]),_:1}),f((s(),c(u,{plain:"",type:"primary",onClick:t[2]||(t[2]=a=>U("create"))},{default:l(()=>[e(k,{class:"mr-5px",icon:"ep:plus"}),t[7]||(t[7]=p(" \u65B0\u589E "))]),_:1})),[[_,["promotion:combination-activity:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(Y,null,{default:l(()=>[f((s(),c(Z,{data:o(S),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[e(i,{label:"\u6D3B\u52A8\u7F16\u53F7","min-width":"80",prop:"id"}),e(i,{label:"\u6D3B\u52A8\u540D\u79F0","min-width":"140",prop:"name"}),e(i,{label:"\u6D3B\u52A8\u65F6\u95F4","min-width":"210"},{default:l(a=>[p(C(o(A)(a.row.startTime,"YYYY-MM-DD"))+" ~ "+C(o(A)(a.row.endTime,"YYYY-MM-DD")),1)]),_:1}),e(i,{label:"\u5546\u54C1\u56FE\u7247","min-width":"80",prop:"spuName"},{default:l(a=>[e(I,{"preview-src-list":[a.row.picUrl],src:a.row.picUrl,class:"h-40px w-40px","preview-teleported":""},null,8,["preview-src-list","src"])]),_:1}),e(i,{label:"\u5546\u54C1\u6807\u9898","min-width":"300",prop:"spuName"}),e(i,{formatter:o(de),label:"\u539F\u4EF7","min-width":"100",prop:"marketPrice"},null,8,["formatter"]),e(i,{label:"\u62FC\u56E2\u4EF7","min-width":"100",prop:"seckillPrice"},{default:l(a=>[p(C(j(a.row.products)),1)]),_:1}),e(i,{label:"\u5F00\u56E2\u7EC4\u6570","min-width":"100",prop:"groupCount"}),e(i,{label:"\u6210\u56E2\u7EC4\u6570","min-width":"100",prop:"groupSuccessCount"}),e(i,{label:"\u8D2D\u4E70\u6B21\u6570","min-width":"100",prop:"recordCount"}),e(i,{align:"center",label:"\u6D3B\u52A8\u72B6\u6001","min-width":"100",prop:"status"},{default:l(a=>[e(R,{type:o(P).COMMON_STATUS,value:a.row.status},null,8,["type","value"])]),_:1}),e(i,{formatter:o(pe),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),e(i,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"150px"},{default:l(a=>[f((s(),c(u,{link:"",type:"primary",onClick:T=>U("update",a.row.id)},{default:l(()=>t[8]||(t[8]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["promotion:combination-activity:update"]]]),a.row.status===0?f((s(),c(u,{key:0,link:"",type:"danger",onClick:T=>(async v=>{try{await w.confirm("\u786E\u8BA4\u5173\u95ED\u8BE5\u62FC\u56E2\u6D3B\u52A8\u5417\uFF1F"),await me(v),w.success("\u5173\u95ED\u6210\u529F"),await m()}catch{}})(a.row.id)},{default:l(()=>t[9]||(t[9]=[p(" \u5173\u95ED ")])),_:2},1032,["onClick"])),[[_,["promotion:combination-activity:close"]]]):f((s(),c(u,{key:1,link:"",type:"danger",onClick:T=>(async v=>{try{await w.delConfirm(),await ue(v),w.success(O("common.delSuccess")),await m()}catch{}})(a.row.id)},{default:l(()=>t[10]||(t[10]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["promotion:combination-activity:delete"]]])]),_:1})]),_:1},8,["data"])),[[G,o(b)]]),e($,{limit:o(r).pageSize,"onUpdate:limit":t[3]||(t[3]=a=>o(r).pageSize=a),page:o(r).pageNo,"onUpdate:page":t[4]||(t[4]=a=>o(r).pageNo=a),total:o(x),onPagination:m},null,8,["limit","page","total"])]),_:1}),e(ce,{ref_key:"formRef",ref:N,onSuccess:m},null,512)],64)}}});export{xe as default};
